{"version":3,"file":"admin.min.js","mappings":"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","sources":["webpack://admin/../../../js/main.js","webpack://admin/./admin.js","webpack://admin/../../../js/imports.js","webpack://admin/../../../js/form_submit_functions.js"],"sourcesContent":["console.log(\"Main.js loaded\");\r\n\r\nimport {displayMessage, showLoader, isMobileDevice, } from './imports.js';\r\nexport  {displayMessage, showLoader, isMobileDevice};\r\n\r\nexport function changeUrl(target, secondTab=''){\r\n\tlet newParam\t= target.dataset.param_val;\r\n\tlet hash\t\t= target.dataset.hash;\r\n\tconst url \t\t= new URL(window.location);\r\n\r\n\t//Change the url params\r\n\tif(target.closest('.tabcontent') == null || target.parentNode.classList.contains('modal-content')){\r\n\t\t//Add query_arg if it is a main tab\r\n\t\turl.searchParams.set('main_tab', newParam);\r\n\t\turl.searchParams.delete('second_tab');\r\n\t}else{\r\n\t\turl.searchParams.set('second_tab', newParam);\r\n\t}\r\n\r\n\tif(secondTab != ''){\r\n\t\turl.searchParams.set('second_tab', secondTab);\r\n\t}\r\n\t\r\n\twindow.history.pushState({}, '', url);\r\n\r\n\tif(hash != null){\r\n\t\twindow.location.hash\t= hash;\r\n\t}else{\r\n\t\twindow.location.hash\t= '';\r\n\t}\r\n\r\n\t// switch tab when clicking on a change url link\r\n\tif(target.tagName == 'A'){\r\n\t\tswitchTab();\r\n\t}\r\n}\r\n\r\nfunction switchTab(event=null){\r\n\tlet params = new Proxy(new URLSearchParams(window.location.search), {\r\n\t\tget: (searchParams, prop) => searchParams.get(prop),\r\n\t});\r\n\t\r\n\tlet mainTab \t= params.main_tab;\r\n\tlet lastTab\t\t= '';\r\n\r\n\tif(mainTab != null){\r\n\t\t//find the tab and display it\r\n\t\tdocument.querySelectorAll(`[data-param_val=\"${mainTab}\"]:not(.active)`).forEach(tabbutton=>{\r\n\t\t\t//only process non-modal tabs\r\n\t\t\tif(tabbutton.closest('.modal') == null){\r\n\t\t\t\tlet result\t= displayTab(tabbutton);\r\n\t\t\t\tif(result){\r\n\t\t\t\t\tlastTab\t= result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tlet secondTab = params.second_tab;\r\n\tif(secondTab != null){\r\n\t\t//find the tab and display it\r\n\t\tdocument.querySelectorAll(`[data-param_val=\"${secondTab}\"]:not(.active)`).forEach(tabbutton=>{\r\n\t\t\tdisplayTab(tabbutton);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport function displayTab(tabButton){\r\n\r\n\t//remove all existing highlights\r\n\tdocument.querySelectorAll('.highlight').forEach(el=>el.classList.remove('highlight'));\r\n\r\n\tlet tab;\r\n\t// Get content area\r\n\tif(tabButton.dataset.target == undefined){\r\n\t\ttab = document.querySelector('#'+tabButton.dataset.param_val);\r\n\t}else{\r\n\t\ttab = tabButton.closest('div:not(.tablink-wrapper)').querySelector('#'+tabButton.dataset.target);\r\n\t}\r\n\t\r\n\tif(tab != null){\r\n\t\ttab.classList.remove('hidden');\r\n\r\n\t\tif(tabButton.tagName != 'A'){\r\n\t\t\t//Mark the other tabbuttons as inactive\r\n\t\t\ttabButton.parentNode.querySelectorAll(`:scope > .active:not(#${tabButton.id})`).forEach(child=>{\r\n\t\t\t\t//Make inactive\r\n\t\t\t\tchild.classList.remove(\"active\");\r\n\t\t\t\t\t\r\n\t\t\t\t//Hide the tab\r\n\t\t\t\tvar childTab\t= child.closest('div:not(.tablink-wrapper)').querySelector('#'+child.dataset.target);\r\n\t\t\t\tif(childTab == null){\r\n\t\t\t\t\tconsole.error('Tab to hide not found:');\r\n\t\t\t\t\tconsole.error(child.closest('div:not(.tablink-wrapper)'));\r\n\t\t\t\t\tconsole.error('#'+child.dataset.target);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tchildTab.classList.add('hidden');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t//Mark the tabbutton as active\r\n\t\t\ttabButton.classList.add(\"active\");\r\n\t\t}\r\n\r\n\t\t//scroll to field\r\n\t\tif (window.location.hash) {\r\n\t\t\tvar hash \t\t= window.location.hash.replace('#', '');\r\n\r\n\t\t\tvar hashField\t= tab.querySelector(`[name^=\"${hash}\"]`);\r\n\t\t\r\n\t\t\tif(hashField != null){\r\n\t\t\t\thashField.scrollIntoView({block: \"center\"});\r\n\r\n\t\t\t\tvar el\t\t\t= hashField.closest('.inputwrapper');\r\n\t\t\t\tif(el != null){\r\n\t\t\t\t\thashField.closest('.inputwrapper').classList.add('highlight');\r\n\t\t\t\t}\r\n\t\t\t\thashField.classList.add('highlight');\r\n\t\t\t\thashField.focus();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// position any tables on this tab, as they can only be positioned when visible\r\n\t\tif(typeof(SimTableFunctions) != 'undefined'){\r\n\t\t\tSimTableFunctions.positionTable();\r\n\t\t}\r\n\r\n\t\treturn tab;\r\n\t}else{\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport function getRoute(target,lat,lon){\r\n\t//Leave the origin empty on a mobile device to use the current location\r\n\tif(isMobileDevice()){\r\n\t\tvar origin = '';\r\n\t}else{\r\n\t\tvar origin = '&origin='+sim.address;\r\n\t}\r\n\tvar url = 'https://www.google.com/maps/dir/?api=1&destination='+lat+','+lon+origin;\r\n\tvar win = window.open(url, '_blank');\r\n\twin.focus();\r\n}\r\n\r\nfunction bodyScrolling(type){\r\n\t//don't do anything on homepage\r\n\t//if(document.querySelector('body').classList.contains('home')) return;\r\n\t\r\n\tif(type == 'disable'){\r\n\t\t//disable scrolling of the body\r\n\t\tdocument.querySelector(\"body\").style.overflow = 'hidden';\r\n \t\tdocument.body.style.top\t\t\t= `0px`;\r\n\r\n\t\t//scroll to top\r\n\t\twindow.scrollTo(0, 0);\r\n\r\n \t\tvar menu = document.querySelector(\"#masthead\");\r\n\t\tmenu.style.overflowY\t= 'scroll';\r\n\t\tmenu.style.top\t\t\t= '0px';\r\n\t\tmenu.style.left\t\t\t= '0';\r\n\t\tmenu.style.right\t\t= '0';\r\n\t\tmenu.style.bottom\t\t= '0';\r\n\t\tmenu.style.position\t\t= 'absolute'; \r\n\r\n\t}else{\r\n\t\t//enable scrolling of the body\r\n\t\tdocument.querySelector(\"body\").style.overflow = '';\r\n\t\tdocument.body.style.top \t\t= '';\r\n\r\n\t\tvar menu = document.querySelector(\"#masthead\");\r\n\t\tmenu.style.overflowY\t= '';\r\n\t\tmenu.style.top\t\t\t= '';\r\n\t\tmenu.style.left\t\t\t= '';\r\n\t\tmenu.style.right\t\t= '';\r\n\t\tmenu.style.bottom\t\t= '';\r\n\t\tmenu.style.position\t\t= '';\r\n\t}\r\n}\r\n\r\nexport function showModal(modal){\r\n\tif(typeof(modal) == 'string'){\r\n\t\tmodal = document.getElementById(modal + \"_modal\");\r\n\t}\r\n\t\r\n\tif(modal != null){\r\n\t\t// Prevent main page scrolling\r\n\t\tdocument.body.style.top\t\t\t= `-${window.scrollY}px`;\r\n\t\tdocument.body.style.position \t= 'fixed';\r\n\t\tlet prim\t\t\t\t\t\t= document.getElementById('primary');\r\n\t\tif(prim != null){\r\n\t\t\tprim.style.zIndex\t\t\t= 99999;\r\n\t\t}\r\n\r\n\t\tmodal.classList.remove('hidden');\r\n\r\n\t\tmodal.style.display\t= 'block';\r\n\t}\t\r\n}\r\n\r\nexport function hideModals(){\r\n\tlet modals\t= document.querySelectorAll('.modal:not(.hidden)');\r\n\tif(modals.length != 0){\r\n\t\tmodals.forEach(modal=>{\r\n\t\t\tmodal.classList.add('hidden');\r\n\t\t\tmodal.style.removeProperty('display');\r\n\t\t\t\r\n\t\t\tconst event = new Event('modalclosed');\r\n\t\t\tmodal.dispatchEvent(event);\r\n\t\t});\r\n\r\n\t\t// Turn main page scrolling on again\r\n\t\tconst scrollY\t\t\t\t\t= document.body.style.top;\r\n\t\tdocument.body.style.position \t= '';\r\n\t\tdocument.body.style.top \t\t= '';\r\n\t\twindow.scrollTo(0, parseInt(scrollY || '0') * -1);\r\n\t\tlet prim\t\t\t\t\t\t= document.getElementById('primary');\r\n\t\tif(prim != null){\r\n\t\t\tprim.style.zIndex\t\t\t= 1;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//check internet\r\nasync function hasInternet(){\r\n\tif(location.href.includes('localhost')){\r\n\t\twindow['online'] = true;\r\n\t\treturn window['online'];\r\n\t}\r\n\r\n\tawait fetch(location.href).then((result) => {\r\n\t\twindow['online'] = true;\r\n\t}).catch(e => {\r\n\t\twindow['online'] = false;\r\n\t});\r\n\r\n\treturn window['online'];\r\n}\r\n\r\nexport async function waitForInternet(){\r\n\tvar internet\t= await hasInternet();\r\n\tif(!internet){\r\n\t\tdisplayMessage('You have no internet connection, waiting till internet is back...', 'warning', true, true, 5000);\r\n\r\n\t\twhile(!internet){\r\n\t\t\tif(window['online']){\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tinternet\t= await hasInternet();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction positionSubSubMenus(){\r\n\tconst vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);\r\n\r\n\tdocument.querySelectorAll('#primary-menu .sub-menu .sub-menu').forEach(el=>{\r\n\t\tel.style.left\t\t= '100%';\r\n\t\tel.parentNode.closest('ul').style.left\t= '100%';\r\n\r\n\t\t// Get parent right coordinate\r\n\t\tlet startPos\t= el.parentNode.getBoundingClientRect()['right'];\r\n\t\t\r\n\t\t// el with\r\n\t\tlet width\t= el.getBoundingClientRect()['width'];\r\n\r\n\t\t// move to left if not fitting on screen\r\n\t\tif(startPos + width > vw){\r\n\t\t\tel.style.right\t= '100%';\r\n\t\t\tel.style.left\t= 'unset';\r\n\t\t}else{\r\n\t\t\tel.style.removeProperty('left');\r\n\t\t}\r\n\r\n\t\t// Reset left\r\n\t\tel.parentNode.closest('ul').style.removeProperty('left');\r\n\t});\r\n}\r\n\r\n//Load after page load\r\ndocument.addEventListener(\"DOMContentLoaded\",function() {\r\n\t// remove any empty widgets\r\n\tdocument.querySelectorAll('.widget').forEach(w=>{\r\n\t\tif(w.innerHTML == ''){\r\n\t\t\tw.remove();\r\n\t\t}\r\n\t});\r\n\r\n\t//loop over all the tab buttons\r\n\tdocument.querySelectorAll('.tablink').forEach(function(tabButton){\r\n\t\t//Add the dataset if it does not exist yet.\r\n\t\tif(tabButton.dataset.param_val == undefined){\r\n\t\t\ttabButton.dataset.param_val = tabButton.textContent.replace(' ','_').toLowerCase();\r\n\t\t}\r\n\t})\r\n\r\n\t//check for tab actions\r\n\tswitchTab();\r\n\r\n\t//add niceselects\r\n\tdocument.querySelectorAll('select:not(.nonice,.swal2-select)').forEach(function(select){\r\n\t\tif(select._niceselect  == undefined){\r\n\t\t\tselect._niceselect = NiceSelect.bind(select, {searchable: true});\r\n\t\t}\r\n\t});\r\n\r\n\t// hide mobile hidden\r\n\tif(isMobileDevice()){\r\n\t\tdocument.querySelectorAll('.hide-on-mobile:not(.hidden)').forEach(el=>el.classList.add('hidden'));\r\n\t}else{\r\n\t\tdocument.querySelectorAll('.hide-on-desktop:not(.hidden)').forEach(el=>el.classList.add('hidden'));\r\n\r\n\t\tpositionSubSubMenus();\r\n\t}\r\n\r\n\t// Check for messages\r\n\tlet params = new Proxy(new URLSearchParams(window.location.search), {\r\n\t\tget: (searchParams, prop) => searchParams.get(prop),\r\n\t});\r\n\r\n\tif(params.message != null){\r\n\t\tlet type = 'success';\r\n\r\n\t\tif(params.type != null){\r\n\t\t\ttype\t= params.type;\r\n\t\t}\r\n\t\tdisplayMessage(params.message, type);\r\n\t}\r\n});\r\n\r\n\r\n//Hide or show the clicked tab\r\nwindow.addEventListener(\"mousedown\", function(event) {\t\r\n\tvar target = event.target;\r\n\t\r\n\t//we clicked the menu\r\n\tif(target.closest('.menu-toggle') != null){\r\n\t\tevent.preventDefault();\r\n\t\tif(target.closest('.menu-toggle').getAttribute(\"aria-expanded\") == \"true\"){\r\n\t\t\tbodyScrolling('enable');\r\n\t\t}else{\r\n\t\t\tbodyScrolling('disable');\r\n\t\t}\r\n\t}\r\n\r\n\t//if clicked outside the menu, then close the menu\r\n\tif(\r\n\t\tdocument.querySelector('.menu-toggle') != null &&\r\n\t\tdocument.querySelector('.menu-toggle').getAttribute(\"aria-expanded\")==\"true\" &&\r\n\t\ttarget.closest('#site-navigation') == null && \r\n\t\ttarget.closest('#mobile-menu-control-wrapper') == null\r\n\t){\r\n\t\tdocument.querySelector('#mobile-menu-control-wrapper').classList.remove(\"toggled\");\r\n\t\tdocument.querySelector('.menu-toggle').setAttribute(\"aria-expanded\", 'false');\r\n\t\tdocument.querySelector('#site-navigation').classList.remove(\"toggled\");\r\n\t\tbodyScrolling('enable');\r\n\t}\r\n\r\n\t//Process the click on tab button\r\n\tif(target.matches(\".tablink\")){\r\n\t\tevent.preventDefault();\r\n\t\t//change the url in browser\r\n\t\tchangeUrl(target);\r\n\r\n\t\t//show the tab\r\n\t\tdisplayTab(target);\r\n\t}\t\r\n\r\n\t//close modal if clicked outside of modal\r\n\tlet modal\t= document.querySelector('.modal:not(.hidden)');\r\n\tif(modal != undefined){\r\n\t\tlet scrollBarWidth\t= window.innerWidth - modal.clientWidth;\r\n\t\tif(\r\n\t\t\ttarget.matches(\".modal .close\") || \t\t\t\t\t// close button clicked\r\n\t\t\t(\r\n\t\t\t\t(\r\n\t\t\t\t\tscrollBarWidth > 0\t&&\t\t\t\t\t\t// there is a scrollbar\r\n\t\t\t\t\tevent.clientX < modal.clientWidth\t\t\t// but we did not click on it\r\n\t\t\t\t)\t||\r\n\t\t\t\tscrollBarWidth\t=== 0\t\t\t\t\t\t\t// there is no scrollbar\r\n\t\t\t)\t&&\r\n\t\t\t(\r\n\t\t\t\ttarget.closest('.modal-content') == null && \t// not clicked inside the modal\r\n\t\t\t\ttarget.closest('.swal2-container') == null &&\t// not clicked on swal message container\r\n\t\t\t\ttarget.tagName == 'DIV'\t\t\t\t\t\t\t// the target is a div\r\n\t\t\t)\r\n\t\t){\r\n\t\t\t//console.log(event.clientX);\r\n\t\t\t//console.log(window.outerWidth);\r\n\t\t\thideModals();\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n// disable scrolling on number fields\r\ndocument.addEventListener(\"wheel\", function(event){\r\n    if(document.activeElement.type === \"number\"){\r\n        document.activeElement.blur();\r\n    }\r\n});","import {changeUrl, displayTab, showModal} from './../../../../includes/js/main.js'\r\nimport {fetchRestApi} from  './../../../../includes/js/form_submit_functions.js'\r\n\r\nconsole.log('admin.js loaded');\r\n\r\nfunction switchSlider(event){\r\n    if(event.target.checked){\r\n        document.querySelectorAll('.options, .tablink-wrapper').forEach(el=>el.style.display    = 'block');\r\n    }else{\r\n        document.querySelectorAll('.options, .tablink-wrapper').forEach(el=>el.style.display    = 'none');\r\n    }\r\n}\r\n\r\n//Load after page load\r\ndocument.addEventListener(\"DOMContentLoaded\", function() {\r\n\tdocument.querySelectorAll('[name=\"enable\"]').forEach(el=>el.addEventListener('change', switchSlider));\r\n\r\n\t//add niceselects\r\n\tdocument.querySelectorAll('select:not(.nonice,.swal2-select)').forEach(function(select){\r\n        if(select._niceselect  == undefined){\r\n\t\t    select._niceselect = NiceSelect.bind(select,{searchable: true});\r\n        }\r\n\t});\r\n});\r\n\r\nwindow.addEventListener(\"click\", async event => {\r\n\tlet target = event.target;\r\n    if(target.classList.contains('placeholderselect') || target.classList.contains('placeholders')){\r\n        event.preventDefault();\r\n\r\n        let value = '';\r\n        if(target.classList.contains('placeholders')){\r\n            value = target.textContent;\r\n        }else if(target.value != ''){\r\n            value = target.value;\r\n            target.selectedIndex = '0';\r\n        }\r\n        \r\n        if(value != ''){\r\n            let options = {\r\n                icon: 'success',\r\n                title: 'Copied '+value,\r\n                showConfirmButton: false,\r\n                timer: 1500\r\n            };\r\n\r\n            if(document.fullscreenElement != null){\r\n                options['target']\t= document.fullscreenElement;\r\n            }\r\n\r\n            Swal.fire(options);\r\n            navigator.clipboard.writeText(value);\r\n        }\r\n    }\r\n\r\n    if(target.matches(\".tablink\")){\r\n\t\tevent.preventDefault();\r\n\t\t//change the url in browser\r\n\t\tchangeUrl(target);\r\n\r\n\t\t//show the tab\r\n\t\tdisplayTab(target);\r\n\t}else if(target.matches(`.sim.release`)){\r\n        showModal('release');\r\n\r\n        let formData    = new FormData();\r\n        formData.append('module_name', target.dataset.name);\r\n        \r\n        let response    = await fetchRestApi('get-changelog', formData);\r\n\r\n        document.querySelector('#release_modal .loadergif_wrapper').classList.add('hidden');\r\n\r\n        document.querySelector('#release_modal .content').innerHTML   = response;\r\n        document.querySelector('#release_modal .content').classList.remove('hidden');\r\n    }\r\n});\r\n\r\ndocument.querySelector('#release_modal').addEventListener('modalclosed', ev=>{\r\n    ev.target.querySelector('.loadergif_wrapper').classList.remove('hidden');\r\n    ev.target.querySelector('.content').classList.add('hidden');\r\n});","export let scripts;\r\n\r\nexport let afterScriptsLoaded\t= function (attachTo){\r\n    if(typeof(tinymce) != 'undefined'){\r\n        tinymce.remove();\r\n\r\n        // Activate tinyMce's again\r\n        document.querySelectorAll('.entry-content .wp-editor-area').forEach(el =>{\r\n            window.tinyMCE.execCommand('mceAddEditor', false, el.id);\r\n        });\r\n    }    \r\n\r\n    // invoke dom content loaded events\r\n    window.document.dispatchEvent(new Event(\"DOMContentLoaded\", {\r\n        bubbles: true,\r\n        cancelable: true\r\n    }));\r\n\r\n    // Somehow the visual/text switch does not work, manually fix it\r\n    document.querySelectorAll('.wp-switch-editor').forEach(el=>el.addEventListener('click', ev=>{\r\n        let area    = el.closest('.wp-editor-wrap').querySelector('.wp-editor-area');\r\n        let panel   =  el.closest('.wp-editor-wrap').querySelector('.mce-panel');\r\n        area.style.visibility='unset';\r\n        if(ev.target.matches('.switch-tmce')){\r\n           panel.style.display='block';\r\n            area.style.display='none';\r\n        }else{\r\n            panel.style.display='none';\r\n            area.style.display='block';\r\n        }\r\n    }));\r\n\r\n    //add niceselects\r\n\tdocument.querySelectorAll('select:not(.nonice,.swal2-select)').forEach(function(select){\r\n        if(select._niceselect == undefined){\r\n\t\t    select._niceselect = NiceSelect.bind(select,{searchable: true});\r\n        }\r\n\t});\r\n\r\n    const ev = new Event('scriptsloaded');\r\n\tattachTo.dispatchEvent(ev);\r\n}\r\n\r\nexport let addStyles    = function (response, attachTo){\r\n    let temp = document.createElement('div');\r\n\r\n    if(response.js){\r\n        temp.innerHTML =  response.js;\r\n        scripts\t= [...temp.children];\r\n        addScripts(attachTo);\r\n    }\r\n\r\n    if(response.css){\r\n        temp.innerHTML = response.css;\r\n        [...temp.children].forEach(el => {\r\n            document.head.appendChild(el);\r\n        });\r\n    }\r\n}\r\n\r\nexport let addScripts\t= function (attachTo) {\r\n    if(attachTo == undefined){\r\n        return;\r\n    }\r\n\r\n    if(scripts.length == 0){\r\n        afterScriptsLoaded(attachTo);\r\n    }\r\n    let el\t= scripts.shift();\r\n\r\n    if(el == undefined){\r\n        afterScriptsLoaded(attachTo);\r\n        return;\r\n    }\r\n\r\n    // only add if needed\r\n    if(el.tagName == 'SCRIPT' && document.getElementById(el.id) == null){\r\n        var s = document.createElement('script');\r\n\r\n        if(el.type == ''){\r\n            s.type\t= 'text/javascript'; \r\n        }else{\r\n            s.type\t= el.type;\r\n        }\r\n\r\n        if(el.src != ''){\r\n            s.src \t= el.src;\r\n        }else{\r\n            s.innerHTML\t= el.innerHTML;\r\n        }\r\n        \r\n        s.id\t= el.id;\r\n        \r\n        try{\r\n            document.head.appendChild(s);\r\n        }catch (error) {\r\n            console.error(error);\r\n        }\r\n\r\n        if(scripts.length > 0){\r\n            if(el.src != ''){\r\n                s.addEventListener('load', addScripts.bind( null, attachTo ) );\r\n            }else{\r\n                addScripts(attachTo);\r\n            }\r\n        }else{\r\n            if(el.src != ''){\r\n                s.addEventListener('load', afterScriptsLoaded.bind( null, attachTo));\r\n            }else{\r\n                afterScriptsLoaded(attachTo);\r\n            }\t\t\t\r\n        }\r\n    }else if(scripts.length > 0){\r\n        // get next script\r\n        addScripts(attachTo);\r\n    }else{\r\n        afterScriptsLoaded(attachTo);\r\n    }\r\n}\r\n\r\nexport function displayMessage(message, icon, autoclose=false, no_ok=false, timer=1500){\r\n\tif(message == undefined){\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tif(typeof(Swal) != 'undefined'){\r\n\t\tvar options = {\r\n\t\t\ticon: icon,\r\n\t\t\ttitle: message.trim(),\r\n\t\t\tconfirmButtonColor: \"#bd2919\",\r\n\t\t\tcancelButtonColor: 'Crimson'\r\n\t\t};\r\n\r\n\t\tif(no_ok){\r\n\t\t\toptions['showConfirmButton'] = false;\r\n\t\t}\r\n\t\t\r\n\t\tif(typeof(callback) == 'function'){\r\n\t\t\toptions['didClose'] = () => callback();\r\n\t\t}\r\n\t\t\r\n\t\tif(autoclose){\r\n\t\t\toptions['timer'] = timer;\r\n\t\t}\r\n\r\n        if(document.fullscreenElement != null){\r\n\t\t\toptions['target']\t= document.fullscreenElement;\r\n\t\t}\r\n\t\t\r\n\t\treturn Swal.fire(options);\r\n\t}else{\r\n\t\treturn alert(message.trim());\r\n\t}\r\n}\r\n\r\nexport function showLoader(element, replace=true, message=''){\r\n\tif(element == null){\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tlet wrapper\t= document.createElement(\"DIV\");\r\n\twrapper.setAttribute('class','loaderwrapper');\r\n\tif(message != ''){\r\n\t\twrapper.innerHTML\t= message;\r\n\t}\r\n\r\n\tlet loader\t= document.createElement(\"IMG\");\r\n\tloader.setAttribute('class','loadergif');\r\n\tloader.setAttribute(\"src\", sim.loadingGif);\r\n\tloader.style[\"height\"]= \"30px\";\r\n\r\n\twrapper.insertAdjacentElement('beforeEnd', loader);\r\n\tif(replace){\r\n\t\telement.parentNode.replaceChild(wrapper, element);\r\n\t}else{\r\n        let el  = element.nextElementSibling;\r\n        if(el == null){\r\n            element.parentNode.insertAdjacentElement('beforeEnd', wrapper);\r\n        }else{\r\n            element.parentNode.insertBefore(wrapper, el);\r\n        }\r\n\t}\r\n\r\n\treturn wrapper;\r\n}\r\n\r\n//Check if on mobile\r\nexport function isMobileDevice() {\r\n    let check = false;\r\n    (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);\r\n    return check;\r\n}\r\n","export function formReset(form){\r\n\t//reset form to the default\r\n\tform.reset();\r\n\r\n\t//hide loaders\r\n\tform.querySelectorAll('.loadergif').forEach(el=>el.classList.add('hidden'));\r\n\r\n\t//hide button again if needed\r\n\tform.querySelectorAll('.multistepcontrols .form_submit').forEach(el=>el.classList.add('hidden'));\r\n\t\r\n\t//fix required fields\r\n\tform.querySelectorAll('[required]').forEach(el=>{el.required = false;});\r\n\t\r\n\t//empty any fileuploads\r\n\tform.querySelectorAll('.file_upload').forEach(el=>el.value='');\r\n\r\n\t//show hidden file uploads\r\n\tform.querySelectorAll('.upload_div.hidden').forEach(el=>el.classList.remove('hidden'));\r\n\t\r\n\t//Reset nice selects\r\n\tform.querySelectorAll('select').forEach(el=>el._niceselect.update());\r\n\t\r\n\t//remove doc previews\r\n\tdocument.querySelectorAll('.documentpreview .document').forEach(el=>el.remove());\r\n\t\r\n\tif(form.querySelector('.formstep') != null){\r\n\t\t//mark all circles as not active anymore\r\n\t\tform.querySelectorAll('.multistepcontrols .step.finish').forEach(el=>el.classList.remove('finish'));\r\n\t\r\n\t\t//go back to the first part of the form in case of multistep\r\n\t\tFormFunctions.showTab(0,form);\r\n\t}\r\n}\r\n\r\nexport async function submitForm(target, url){\r\n\tlet form\t\t= target.closest('form');\r\n\tlet validity \t= true;\r\n\t\r\n\t//get all hidden required inputs and unrequire them\r\n\tform.querySelectorAll('.hidden [required], select[required], .nice-select-search[required], .stephidden [required]').forEach(el=>{el.required = false});\r\n\r\n\t// enable disabled fields so it gets included and warnings are shown\r\n\tform.querySelectorAll('[disabled][required]').forEach( el=>{\r\n\t\tel.disabled\t= false;\r\n\t\tel.classList.add('was-disabled'); \r\n\t});\r\n\r\n\tvalidity\t= form.reportValidity();\r\n\r\n\t//only continue if valid\r\n\tif(validity){\r\n\t\t//Display loader\r\n\t\ttarget.closest('.submit_wrapper').querySelectorAll('.loadergif').forEach(loader=>loader.classList.remove('hidden'));\r\n\t\t\r\n\t\t//save any tinymce forms\r\n\t\tif (typeof tinymce !== 'undefined') {\r\n\t\t\ttinymce.get().forEach((tn)=>{\r\n\t\t\t\t// only save when the visual tab is active\r\n\t\t\t\tif(!tn.hidden){\r\n\t\t\t\t\ttn.save()\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tlet formData = new FormData(form);\r\n\r\n\t\t// disable fields again\r\n\t\tform.querySelectorAll('.was-disabled').forEach( el=>{\r\n\t\t\tel.disabled\t= true;\r\n\t\t\tel.classList.remove('was-disabled'); \r\n\t\t});\r\n\r\n\t\tif(form.dataset.addempty == 'true'){\r\n\t\t\t//also append at least one off all checkboxes\r\n\t\t\tform.querySelectorAll('input[type=\"checkbox\"]:not(:checked)').forEach(checkbox=>{\r\n\t\t\t\t//if no checkbox with this name exist yet\r\n\t\t\t\tif(!formData.has(checkbox.name)){\r\n\t\t\t\t\tformData.append(checkbox.name,'');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// also add get params\r\n\t\ttry{\r\n\t\t\tlocation['search'].split('?')[1].split('&').forEach(param=>{\r\n\t\t\t\tlet split\t= param.split('=');\r\n\t\t\t\tif(split[0] != 'formbuilder' && split[0] != 'main_tab' && split[0] != 'second_tab'){\r\n\t\t\t\t\tformData.append(split[0], split[1]);\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t}catch{\r\n\t\t\t//pass\r\n\t\t}\r\n\r\n\t\t// store values of multi-selects\r\n\t\tdocument.querySelectorAll('select[multiple]').forEach(el => {\r\n\t\t\tformData.set(el.name, Array.from(el.selectedOptions,e=>e.value));\r\n\t\t});\r\n\r\n\t\tlet response = await fetchRestApi(url, formData);\r\n\r\n\t\tform.querySelectorAll('.submit_wrapper .loadergif').forEach(loader => loader.classList.add('hidden'));\r\n\r\n\t\tif(form.dataset.reset != 'true'){\r\n\t\t\tmarkComplete();\r\n\t\t}\r\n\r\n\t\treturn response;\r\n\t}else{\r\n\t\tform.querySelectorAll(':invalid').forEach(el=>{\r\n\t\t\tif(el.validationMessage != undefined){\r\n\t\t\t\tMain.displayMessage(`${el.name} has an error:\\n${el.validationMessage}`, 'error').then((value)=>{\r\n\t\t\t\t\tform.querySelectorAll('.formstep:not(.stephidden)').forEach(formstep=>formstep.classList.add('stephidden'));\r\n\r\n\t\t\t\t\tel.closest('.stephidden').classList.remove('stephidden');\r\n\r\n\t\t\t\t\tel.focus();\r\n\r\n\t\t\t\t\tel.scrollIntoView();\r\n\r\n\t\t\t\t\tel.focus();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Set the default values to the current values so to not trigger a page leave warning\r\n */\r\nexport function markComplete(){\r\n\r\n\t// pending\r\n\tdocument.querySelectorAll('[data-pending]').forEach(el=>{\r\n\t\tel.removeAttribute('data-pending');\r\n\t});\r\n\r\n\t// check all inputs\r\n\tdocument.querySelectorAll('form input:not([type=radio], [type=checkbox]), form textarea').forEach(el=>{\r\n\t\tel.defaultValue = el.value\r\n\t});\r\n\r\n\t// check all checkboxes and radio\r\n\tdocument.querySelectorAll('form input[type=radio], form input[type=checkbox]').forEach(el=>{\r\n\t\tif(el.checked){\r\n\t\t\tel.defaultChecked = true; \r\n\t\t}\r\n\t});\r\n\r\n\t// check all dropdowns\r\n\tdocument.querySelectorAll('form select').forEach(el=>{\r\n\t\tif(el.selectedIndex != -1 && el.options[el.selectedIndex] != undefined){\r\n\t\t\tel.options[el.selectedIndex].defaultSelected\t= true;\r\n\t\t}\r\n\t});\r\n}\r\n\r\nexport async function fetchRestApi(url, formData='', showErrors=true){\r\n\tif(formData == ''){\r\n\t\tformData\t= new FormData();\r\n\t}\r\n\t\r\n\tformData.append('_wpnonce', sim.restNonce);\r\n\tlet result;\r\n\ttry{\r\n\t\tresult = await fetch(\r\n\t\t\t`${sim.baseUrl}/wp-json${sim.restApiPrefix}/${url}`,\r\n\t\t\t{\r\n\t\t\t\tmethod: 'POST',\r\n\t\t\t\tcredentials: 'same-origin',\r\n\t\t\t\tbody: formData\r\n\t\t\t}\r\n\t\t);\r\n\t}catch(error){\r\n\t\tconsole.error(error);\r\n\t}\r\n\t\r\n\tlet response\t= await result.text();\r\n\ttry{\r\n\t\tlet json\t\t= JSON.parse(response);\r\n\r\n\t\tif(result.ok){\r\n\t\t\treturn json;\r\n\t\t}else if(json.code == 'rest_cookie_invalid_nonce'){\r\n\t\t\tMain.displayMessage('Please refresh the page and try again!', 'error');\r\n\t\t\treturn false;\r\n\t\t}else{\r\n\t\t\tconsole.error(json);\r\n\t\t\tif(json.data == null){\r\n\t\t\t\tMain.displayMessage(json.message);\r\n\t\t\t}else{\r\n\t\t\t\tMain.displayMessage(json.message+\"\\n\"+JSON.stringify(json.data), 'error');\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}catch(error){\r\n\t\tconsole.error(error);\r\n\t\tconsole.error(result);\r\n\t\tconsole.error(response);\r\n\r\n\t\tif(result.ok){\r\n\t\t\tif(showErrors){\r\n\t\t\t\tMain.displayMessage(`Problem parsing the json, refresh the page or try again.`, 'error');\r\n\t\t\t}\r\n\t\t\tconsole.error(`${sim.baseUrl}/wp-json${sim.restApiPrefix}/${url}` );\r\n\t\t\tconsole.error(response);\r\n\t\t}else{\r\n\t\t\tlet modal\t= `<div id='response-details' class=\"modal hidden\" style='z-index:9999999999;'>`;\r\n\t\t\t\tmodal\t+= `<div class=\"modal-content\" style='max-width: min(1000px,100%);'>`\r\n\t\t\t\t\tmodal\t+= `<span class=\"close\">&times;</span>`;\r\n\t\t\t\t\tmodal\t+= response;\r\n\t\t\t\tmodal\t+= `</div>`;\r\n\t\t\tmodal\t+= `</div>`;\r\n\r\n\t\t\tdocument.querySelector('body').insertAdjacentHTML('afterBegin', modal);\r\n\t\t\tMain.displayMessage(`Error loading url ${sim.baseUrl}/wp-json${sim.restApiPrefix}/${url}<br><button class='button small' id='error-details' onclick='(function(){ document.getElementById(\"response-details\").classList.remove(\"hidden\"); })();'>Details</button><br><div class='hidden response-message'>${response}</div>`, 'error');\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n}"],"names":["changeUrl","target","secondTab","newParam","dataset","param_val","hash","url","URL","window","location","closest","parentNode","classList","contains","searchParams","set","delete","history","pushState","tagName","switchTab","event","params","Proxy","URLSearchParams","search","get","prop","mainTab","main_tab","lastTab","document","querySelectorAll","forEach","tabbutton","result","displayTab","second_tab","tabButton","tab","el","remove","undefined","querySelector","id","child","childTab","console","error","add","replace","hashField","scrollIntoView","block","focus","SimTableFunctions","positionTable","bodyScrolling","type","menu","style","overflow","body","top","scrollTo","overflowY","left","right","bottom","position","switchSlider","checked","display","log","addEventListener","w","innerHTML","textContent","toLowerCase","select","_niceselect","NiceSelect","bind","searchable","check","a","navigator","userAgent","vendor","opera","test","substr","vw","Math","max","documentElement","clientWidth","innerWidth","getBoundingClientRect","removeProperty","positionSubSubMenus","message","icon","autoclose","no_ok","timer","options","title","trim","confirmButtonColor","cancelButtonColor","callback","fullscreenElement","Swal","fire","alert","preventDefault","getAttribute","setAttribute","matches","modal","scrollBarWidth","clientX","modals","length","Event","dispatchEvent","scrollY","parseInt","prim","getElementById","zIndex","hideModals","activeElement","blur","async","value","selectedIndex","showConfirmButton","clipboard","writeText","showModal","formData","FormData","append","name","response","showErrors","sim","restNonce","fetch","baseUrl","restApiPrefix","method","credentials","text","json","JSON","parse","ok","code","Main","displayMessage","data","stringify","insertAdjacentHTML","fetchRestApi","ev"],"sourceRoot":""}