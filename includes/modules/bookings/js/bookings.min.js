(()=>{function e(e,t=!1){t||(e.querySelector(".booking-startdate").value="",e.querySelector(".calendar.day.startdate").classList.remove("startdate"),e.querySelectorAll(".available.selected").forEach((e=>e.classList.remove("selected"))),e.querySelector(".booking-date-label-wrapper.enddate").classList.add("disabled")),e.querySelector(".booking-enddate").value="",e.querySelector(".calendar.day.enddate").classList.remove("enddate"),e.querySelectorAll(".inbetween").forEach((e=>e.classList.remove("inbetween")))}function t(t){let a=t.closest("form").querySelector('[name="booking-startdate"]'),o=t.closest("form").querySelector('[name="booking-enddate"]');a.value=modal.querySelector(".booking-startdate").dataset.isodate,o.value=modal.querySelector(".booking-enddate").dataset.isodate,a.closest(".selected-booking-dates").classList.remove("hidden"),modal.classList.add("hidden"),t.closest("form").querySelector(".change-booking-date").textContent="Change",e(modal)}document.addEventListener("DOMContentLoaded",(()=>{console.log("Bookings.js loaded"),document.querySelectorAll(".booking-subject-selector").forEach((e=>e.addEventListener("change",(e=>{document.querySelector(`[name="${e.target.value}-modal"]`).classList.remove("hidden")})))),document.querySelectorAll(".admin-booking-subject-selector").forEach((e=>e.addEventListener("change",(e=>{document.querySelector(`.bookings-wrap[data-subject="${e.target.value}"]`).classList.toggle("hidden")})))),document.querySelectorAll(".tables-wrapper").forEach((e=>{offset=e.getBoundingClientRect().x,e.style.marginLeft=`-${offset}px`}))})),document.addEventListener("click",(a=>{let o=a.target,l=o.closest(".modal");null!=o.closest("dt")&&(o=o.closest("dt")),o.matches(".action.reset")&&e(l),o.matches(".prevnext")&&async function(e){let t=e.closest(".bookings-wrap"),a=t.querySelector(`.month-container[data-month="${e.dataset.month}"][data-year="${e.dataset.year}"]`);if(null!=e.closest(".prev")?t.querySelectorAll(".calendar.table .month-container:not(.hidden)")[1].classList.add("hidden"):t.querySelectorAll(".calendar.table .month-container:not(.hidden)")[0].classList.add("hidden"),null==a){let a=new FormData;a.append("month",e.dataset.month),a.append("year",e.dataset.year),a.append("subject",e.closest(".bookings-wrap").dataset.subject);let o=document.createElement("DIV");o.setAttribute("class","loaderwrapper");let l=document.createElement("IMG");l.setAttribute("src",sim.loadingGif),o.insertAdjacentElement("beforeEnd",l),t.querySelector(".calendar.table .month-container:not(.hidden)").parentNode.insertAdjacentElement("beforeEnd",o);let d=await FormSubmit.fetchRestApi("bookings/get_next_month",a);d&&(l.outerHTML=d.month,t.querySelector(".navigators .navigator:not(.hidden)").classList.add("hidden"),t.querySelector(".navigators").insertAdjacentHTML("beforeEnd",d.navigator))}else t.querySelector(".navigators .navigator:not(.hidden)").classList.add("hidden"),t.querySelector(`.navigator[data-month="${e.dataset.month}"][data-year="${e.dataset.year}"]`).classList.remove("hidden"),a.classList.remove("hidden")}(o),o.matches(".change-booking-date")&&function(e){let t="",a=document.querySelector(".booking-subject-selector");t=null==a?".booking.modal":`[name="${a.value}-modal"]`,document.querySelector(t).classList.remove("hidden")}(),o.matches(".action.confirm")&&t(o),o.matches(".bookings-wrap .available:not(.selected)")&&function(t){let a=t.closest(".modal");if(null!=a.querySelector(".calendar.day.startdate")&&null!=a.querySelector(".calendar.day.enddate")){let o=!1;t.matches(".inbetween")&&(o=!0),e(a,o)}if(null==a.querySelector(".calendar.day.startdate")){a.querySelector(".booking-startdate").value=t.dataset.date,a.querySelector(".booking-startdate").dataset.isodate=t.dataset.isodate,t.classList.add("startdate"),a.querySelectorAll(".booking-date-label-wrapper.disabled").forEach((e=>e.classList.remove("disabled")));let e=t.closest(".calendar.table").querySelectorAll("dt.calendar.day:not(.head, .unavailable)"),o=!1;for(i=0;i<e.length;++i)e[i]==t?o=!0:o&&e[i].matches(".selected")&&(o=!1),o||e[i].classList.add("selected")}else{a.querySelector(".booking-enddate").value=t.dataset.date,a.querySelector(".booking-enddate").dataset.isodate=t.dataset.isodate,t.classList.add("enddate"),t.closest(".calendar.table").querySelectorAll(".available.selected").forEach((e=>e.classList.remove("selected")));let e=t.closest(".calendar.table").querySelectorAll("dt.calendar.day:not(.head)"),o=!0;for(i=0;i<e.length&&e[i]!=t;++i)o||e[i].classList.add("inbetween"),e[i].matches(".startdate")&&(o=!1);a.querySelectorAll(".actions .action.disabled").forEach((e=>e.classList.remove("disabled")))}}(o),o.matches(".form.table-wrapper .selected")&&o.closest(".bookings-wrap").querySelector(`.booking-detail-wrapper[data-bookingid="${o.dataset.bookingid}"]`).classList.remove("hidden"),o.matches(".booking-detail .edit")&&console.log(o)}))})();
//# sourceMappingURL=bookings.min.js.map