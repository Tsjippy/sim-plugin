{"version":3,"file":"bookings.min.js","mappings":"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","sources":["webpack://bookings/./bookings.js"],"sourcesContent":["function reset(modal, onlyEnd=false){\r\n    if(!onlyEnd){\r\n        modal.querySelector('.booking-startdate').value     = '';\r\n        modal.querySelector('.calendar.day.startdate').classList.remove('startdate');\r\n        modal.querySelectorAll('.available.unavailable').forEach(dt=>dt.classList.remove('unavailable'));\r\n\r\n        modal.querySelector('.booking-date-label-wrapper.enddate').classList.add('disabled')\r\n    }\r\n    modal.querySelector('.booking-enddate').value       = '';\r\n    \r\n    modal.querySelector('.calendar.day.enddate').classList.remove('enddate');\r\n\r\n    modal.querySelectorAll('.inbetween').forEach(dt=>dt.classList.remove('inbetween'));    \r\n\r\n    modal.querySelectorAll('.room-selector').forEach(el=>el.checked=false);    \r\n\r\n    if(modal.querySelectorAll('.room-selector').length>1){\r\n        modal.querySelectorAll('.roomwrapper:not(.hidden)').forEach(el=>el.classList.add('hidden'));\r\n    }\r\n}\r\n\r\nasync function getMonth(target){\r\n    let wrapper         = target.closest('.bookings-wrap');\r\n    let monthContainers = wrapper.querySelectorAll(`.month-container[data-month=\"${target.dataset.month}\"][data-year=\"${target.dataset.year}\"]`);\r\n    let type;\r\n\r\n    // we clicked the previous button\r\n    if(target.closest('.prev') != null){\r\n        type    = 'prev';\r\n        // hide every second calendar, so that we can show a new calendar to the left\r\n        wrapper.querySelectorAll('.calendar.table .month-container:not(.hidden)').forEach(\r\n            (el, index) => {\r\n                if(index % 2 != 0){ // uneven index\r\n                    el.classList.add('hidden');\r\n                }\r\n            }\r\n        );\r\n    }else{\r\n        type    = 'next';\r\n\r\n        // hide every first calendar, so that we can show a new calendar to the right\r\n        wrapper.querySelectorAll('.calendar.table .month-container:not(.hidden)').forEach(\r\n            (el, index) => {\r\n                if(index % 2 == 0){ // even index\r\n                    el.classList.add('hidden');\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    // month does not exist yet, request the data\r\n    if(monthContainers.length == 0){\r\n        let formData    = new FormData();\r\n        formData.append('month', target.dataset.month);\r\n        formData.append('year', target.dataset.year);\r\n        formData.append('subject', wrapper.dataset.subject);\r\n        formData.append('formid', wrapper.dataset.formid);\r\n        formData.append('type', type);\r\n        if(wrapper.dataset.elid != undefined){\r\n            formData.append('elid', wrapper.dataset.elid);\r\n        }\r\n        if(wrapper.dataset.shortcodeid != undefined){\r\n            formData.append('shortcodeid', wrapper.dataset.shortcodeid);\r\n        }\r\n\r\n        let loaderWrapper\t= document.createElement(\"DIV\");\r\n        loaderWrapper.setAttribute('class','loaderwrapper');\r\n\r\n        let loader\t= document.createElement(\"IMG\");\r\n        loader.setAttribute(\"src\", sim.loadingGif);\r\n\r\n        loaderWrapper.insertAdjacentElement('beforeEnd', loader);\r\n\r\n        let position    = '';\r\n        if(type == 'prev'){\r\n            // insert the loader at the left\r\n            position    = 'afterBegin';\r\n        }else{\r\n            position    = 'beforeEnd';\r\n        }\r\n        wrapper.querySelectorAll('.calendar.table .roomwrapper>div').forEach(div=>{\r\n            let clone   = loaderWrapper.cloneNode(true);\r\n            div.insertAdjacentElement(position, clone);\r\n        });\r\n            \r\n        let response = await FormSubmit.fetchRestApi('bookings/get_next_month', formData);\r\n\r\n        if(response){\r\n            // add the new months to each room\r\n            wrapper.querySelectorAll('.roomwrapper').forEach((el, index)=>{\r\n                el.querySelector('.loaderwrapper').outerHTML        = response.months[index];\r\n            });\r\n\r\n            // hide current navigator and add new one\r\n            wrapper.querySelector('.navigators .navigator:not(.hidden)').classList.add('hidden');\r\n            wrapper.querySelector('.navigators').insertAdjacentHTML('beforeEnd', response.navigator);\r\n            wrapper.querySelector('.booking.details-wrapper').insertAdjacentHTML('beforeEnd', response.details);\r\n        }\r\n    }else{\r\n        console.log(monthContainers);\r\n        // hide the current navigator\r\n        wrapper.querySelector('.navigators .navigator:not(.hidden)').classList.add('hidden');\r\n\r\n        // show the new one\r\n        console.log(wrapper);\r\n        console.log(target);\r\n        wrapper.querySelector(`.navigator[data-month=\"${target.dataset.month}\"][data-year=\"${target.dataset.year}\"]`).classList.remove('hidden');\r\n        \r\n        // Show the month calendar\r\n        monthContainers.forEach(el=>el.classList.remove('hidden'));\r\n    }\r\n}\r\n\r\nasync function approve(target){    \r\n    let formData    = new FormData();\r\n    formData.append('id', target.dataset.id);\r\n\r\n    let row         = target.closest('tr');\r\n\r\n    Main.showLoader(target.closest('td'));\r\n        \r\n    let response = await FormSubmit.fetchRestApi('bookings/approve', formData);\r\n\r\n    if(response){\r\n\r\n        // Remove table if empty\r\n        if(row.closest('tbody').rows.length == 1){\r\n            row.closest('table').remove()\r\n        }else{\r\n            // remove the row\r\n            row.remove();\r\n        }\r\n\r\n        let subjectWrapper  = document.querySelector(`.bookings-wrap[data-subject='${response.subject}']`);\r\n\r\n        for (let i = 0; i < response.months.length; i++) {\r\n            // Get the calendar\r\n            subjectWrapper.querySelectorAll(`.month-container[data-month='${response.months[i]}'][data-year='${response.years[i]}']`).forEach(el=>el.outerHTML   = response.html);\r\n        }\r\n\r\n        // Add the details\r\n        subjectWrapper.querySelector(`.booking.details-wrapper`).insertAdjacentHTML('beforeEnd', response.details);\r\n        \r\n    }\r\n}\r\n\r\nasync function remove(target){    \r\n    let formData    = new FormData();\r\n    formData.append('id', target.dataset.id);\r\n    let row         = target.closest('tr');\r\n\r\n    Main.showLoader(target.closest('td'));\r\n        \r\n    let response = await FormSubmit.fetchRestApi('bookings/remove', formData);\r\n\r\n    if(response){\r\n        // Remove table if empty\r\n        if(row.closest('tbody').rows.length == 1){\r\n            row.closest('table').remove()\r\n        }else{\r\n            // remove the row\r\n            row.remove();\r\n        }\r\n\r\n        Main.displayMessage(response);\r\n    }\r\n}\r\n\r\nfunction changeBookingData(target){\r\n    let selector;\r\n    let el  = document.querySelector(`.booking-subject-selector:checked`);\r\n    if(el == null){\r\n        selector    = '.booking.modal';\r\n        console.log(selector);\r\n    }else{\r\n        selector    = `[name=\"${el.value}-modal\"]`;\r\n        console.log(selector);\r\n    }\r\n\r\n    Main.showModal(document.querySelector(selector));\r\n}\r\n\r\nfunction storeDates(target){\r\n    let modal   = target.closest('.modal');\r\n\r\n    // remove all previous dates\r\n    target.closest('form').querySelectorAll('.selected-booking-dates .clone_div').forEach((el, index)=>{\r\n        if(index>0){\r\n            el.remove();\r\n        }\r\n    });\r\n\r\n    let parent          = target.closest('form').querySelector('.selected-booking-dates');\r\n    let original        = parent.querySelector('.clone_div');\r\n\r\n    // set values and create clones\r\n    modal.querySelectorAll('.startdate').forEach((el, index)=>{\r\n        let clone\t\t= original;\r\n\r\n        if(index > 0){\r\n            clone\t\t= FormFunctions.cloneNode(original);\r\n        }\r\n    \r\n        let startEl     = clone.querySelector('[name^=\"booking-startdate\"]');\r\n        let endEl       = clone.querySelector('[name^=\"booking-enddate\"]');\r\n        let roomEl      = clone.querySelector('[name^=\"booking-room\"]');\r\n        let room        = el.closest('.roomwrapper').dataset.room;\r\n\r\n        startEl.value   = el.dataset.isodate;\r\n        endEl.value     = modal.querySelectorAll('.day.enddate')[index].dataset.isodate;\r\n\r\n        if(room == undefined){\r\n            roomEl.closest('div').classList.add('hidden');\r\n            roomEl.value    = '';\r\n        }else{\r\n            roomEl.closest('div').classList.remove('hidden');\r\n            roomEl.value    = room;\r\n        }\r\n\r\n        parent.insertAdjacentElement('beforeEnd', clone);\r\n        \r\n        FormFunctions.fixNumbering(parent);\r\n    });\r\n\r\n    parent.classList.remove('hidden');\r\n\r\n    Main.hideModals();\r\n\r\n    target.closest('form').querySelector('.change-booking-date').textContent    = 'Change';\r\n\r\n    target.closest('form').querySelector('.change-booking-date').classList.remove('hidden');\r\n\r\n    reset(modal);\r\n}\r\n\r\nfunction daySelected(target){ \r\n    let modal   = target.closest('.modal');\r\n\r\n    if(modal == null){\r\n        return;\r\n    }\r\n\r\n    let roomWrapper = target.closest('.roomwrapper');\r\n\r\n    // we already have an selection\r\n    if(roomWrapper.querySelector('.calendar.day.startdate') != null && roomWrapper.querySelector('.calendar.day.enddate') != null){\r\n        let onlyEnd = false;\r\n        if(target.matches('.inbetween')){\r\n            onlyEnd = true;\r\n        }\r\n        \r\n        reset(modal, onlyEnd);\r\n    }\r\n\r\n    if(roomWrapper.querySelector('.calendar.day.startdate') == null){\r\n        //roomWrapper.querySelector('.booking-startdate').value             = target.dataset.date;\r\n        //roomWrapper.querySelector('.booking-startdate').dataset.isodate   = target.dataset.isodate;\r\n\r\n        target.classList.add('startdate');\r\n        roomWrapper.querySelectorAll('.booking-date-label-wrapper.disabled').forEach(el=>el.classList.remove('disabled'));\r\n\r\n        // do not allow any date before the startdate to be the enddate\r\n        let dts     = roomWrapper.querySelectorAll('dt.calendar.day:not(.head, .unavailable)');\r\n        let skip    = false;\r\n        for (i = 0; i < dts.length; ++i) {\r\n            // all dates after the booked date are available\r\n            if(dts[i] == target){\r\n                skip = true;\r\n            // until we encounter another booked date\r\n            }else if(skip && dts[i].matches('.booked:not(.available)')){\r\n                skip = false;\r\n            }\r\n\r\n            if(!skip){\r\n                dts[i].classList.add('unavailable');\r\n            }\r\n        }\r\n    }else{\r\n        // store enddate\r\n        modal.querySelector('.booking-enddate').value               = target.dataset.date;\r\n        modal.querySelector('.booking-enddate').dataset.isodate     = target.dataset.isodate;\r\n        target.classList.add('enddate');\r\n\r\n        // make other dates available again\r\n        roomWrapper.querySelectorAll('.available.booked:not(.enddate, .startdate)').forEach(dt=>dt.classList.remove('booked'));\r\n\r\n        // color the dates between start and end\r\n        let dts     = roomWrapper.querySelectorAll('dt.calendar.day:not(.head)');\r\n        let skip    = true;\r\n        for (i = 0; i < dts.length; ++i) {\r\n            \r\n            // until we encounter another booked date\r\n            if(dts[i] == target){\r\n                break;\r\n            }\r\n\r\n            if(!skip){\r\n                dts[i].classList.add('inbetween');\r\n            }\r\n\r\n            // all dates after the booked date are available\r\n            if(dts[i].matches('.startdate')){\r\n                skip = false;\r\n            }\r\n        }\r\n\r\n        modal.querySelectorAll('.actions .action.disabled').forEach(el=>el.classList.remove('disabled'));\r\n    }\r\n}\r\n\r\nfunction roomSelected(target){\r\n\r\n    let modal   = target.closest('.modal');\r\n\r\n    if(modal == null){\r\n        modal = target.closest('.booking.overview'); // when viewing the results\r\n    }\r\n\r\n    if(modal == null){\r\n        return;\r\n    }\r\n\r\n    // show date warning\r\n    modal.querySelectorAll(`.booking-date-wrapper.hidden`).forEach(el=>el.classList.remove('hidden'));\r\n\r\n    // show month navigator\r\n    modal.querySelectorAll(`.navigators.hidden`).forEach(el=>el.classList.remove('hidden'));\r\n\r\n    // Show the selected room\r\n    modal.querySelectorAll(`[data-room=\"${target.value}\"]`).forEach(el=>el.classList.toggle('hidden'));\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    console.log(\"Bookings.js loaded\");\r\n\r\n    // show booking date selector\r\n    document.querySelectorAll(`.booking-subject-selector`).forEach(el=>el.addEventListener(`change`, (ev)=>{\r\n        Main.showModal(document.querySelector(`[name=\"${ev.target.value}-modal\"]`));\r\n    }));\r\n\r\n    // show booking calendar\r\n    document.querySelectorAll(`.admin-booking-subject-selector`).forEach(el=>el.addEventListener(`change`, (ev)=>{\r\n        document.querySelector(`.bookings-wrap[data-subject=\"${ev.target.value}\"]`).classList.toggle('hidden');\r\n    }));\r\n\r\n    document.querySelectorAll(\".tables-wrapper\").forEach(wrapper=>{\r\n        offset\t= wrapper.getBoundingClientRect().x;\r\n        wrapper.style.marginLeft = `-${offset}px`;\r\n    });\r\n\r\n    document.querySelectorAll('.booking-detail tr.actions').forEach(row=>row.addEventListener('submissionArchived', ev => {\r\n        let wrapper     = ev.target.closest('.booking-detail-wrapper');\r\n        let bookingId   = wrapper.dataset.bookingid;\r\n\r\n        // mark dates as available again\r\n        document.querySelectorAll(`.calendar.day.booked[data-bookingid=\"${bookingId}\"]`).forEach(el=>{\r\n            el.classList.remove('booked');\r\n            el.classList.add('available');\r\n        });\r\n\r\n        // remove details\r\n        wrapper.remove();\r\n        \r\n        Main.displayMessage('Succesfully archived');\r\n    }));\r\n});\r\n\r\ndocument.addEventListener('click', (ev) => {\r\n    let target  = ev.target;\r\n    let modal   = target.closest('.modal');\r\n\r\n    if(target.closest('dt') != null){\r\n        target  = target.closest('dt');\r\n    }\r\n\r\n    if(target.matches('.action.reset')){\r\n        reset(modal);\r\n    }\r\n\r\n    if(target.matches('.prevnext')){\r\n        getMonth(target);\r\n    }\r\n\r\n    if(target.matches('.change-booking-date, [name=\"booking-startdate\"], [name=\"booking-enddate\"]')){\r\n        changeBookingData(target);\r\n    }\r\n\r\n    if(target.matches('.action.confirm')){\r\n        storeDates(target);\r\n    }\r\n\r\n    if(target.matches('.bookings-wrap .available:not(.unavailable)')){\r\n        daySelected(target);\r\n    }\r\n\r\n    if(target.matches('.form.table-wrapper .booked')){\r\n        // Hide others\r\n        target.closest('.bookings-wrap').querySelectorAll(`.booking-detail-wrapper:not(.hidden)`).forEach(el=>el.classList.add('hidden'));\r\n        \r\n        // Show the details\r\n        target.closest('.bookings-wrap').querySelectorAll(`.booking-detail-wrapper[data-bookingid=\"${target.dataset.bookingid}\"]`).forEach(el=>{\r\n            el.classList.remove('hidden');\r\n            el.scrollIntoView({block: \"center\"});\r\n        });\r\n    }\r\n\r\n    if(target.matches('.button.approve')){\r\n        approve(target);\r\n    }else if(target.matches('.button.delete')){\r\n        remove(target);\r\n    }else if(target.matches('.room-selector')){\r\n        roomSelected(target);\r\n    }\r\n});"],"names":["reset","modal","onlyEnd","querySelector","value","classList","remove","querySelectorAll","forEach","dt","add","el","checked","length","document","addEventListener","console","log","ev","Main","showModal","target","toggle","wrapper","offset","getBoundingClientRect","x","style","marginLeft","row","closest","bookingId","dataset","bookingid","displayMessage","matches","async","type","monthContainers","month","year","index","formData","FormData","append","subject","formid","undefined","elid","shortcodeid","loaderWrapper","createElement","setAttribute","loader","sim","loadingGif","insertAdjacentElement","position","div","clone","cloneNode","response","FormSubmit","fetchRestApi","outerHTML","months","insertAdjacentHTML","navigator","details","getMonth","selector","changeBookingData","parent","original","FormFunctions","startEl","endEl","roomEl","room","isodate","fixNumbering","hideModals","textContent","storeDates","roomWrapper","dts","skip","i","date","daySelected","scrollIntoView","block","id","showLoader","rows","subjectWrapper","years","html","approve","roomSelected"],"sourceRoot":""}