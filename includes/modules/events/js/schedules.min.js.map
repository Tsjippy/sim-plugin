{"version":3,"file":"schedules.min.js","mappings":"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","sources":["webpack://events/./schedules.js"],"sourcesContent":["/**\n *\n * Submits the new schedule form via rest API and adds the new schedule to the screen.\n *\n * @listens to button click if button has name add_schedule\n *\n * @param {Object} target     The clicked button.\n *\n * @return nothing\n*/ \nasync function addSchedule(target){\n\tvar response = await FormSubmit.submitForm(target, 'events/add_schedule');\n\n\tif(response){\n\t\ttarget.closest('.schedules_wrapper').outerHTML=response.html;\n\t\t\n\t\tMain.displayMessage(response.message);\n\n\t\tadd_selectable();\n\t}\n}\n\nfunction ShowPublishScheduleModal(target){\n\tvar modal\t\t\t= target.closest('.schedules_div').querySelector('.publish_schedule');\n\tmodal.querySelector('[name=\"schedule_id\"]').value = target.dataset[\"schedule_id\"];\n\tif(target.dataset.target != null){\n\t\tmodal.querySelector('[name=\"schedule_target\"]').value = target.dataset.target;\n\t\tmodal.querySelector('[name=\"publish_schedule\"]').click();\n\t\tMain.showLoader(target,true);\n\t}else{\n\t\tmodal.classList.remove('hidden');\n\t}\n}\n\nasync function publishSchedule(target){\n\tvar response\t= await FormSubmit.submitForm(target, 'events/publish_schedule');\n\n\tif(response){\n\t\tdocument.querySelectorAll('.schedule_actions .loadergif').forEach(el=>el.classList.add('hidden'));\n\t\t\n\t\tMain.hideModals();\n\n\t\tMain.displayMessage(response);\n\t}\n}\n\n// Removes an existing schedule\nasync function removeSchedule(target){\n\tvar scheduleId\t\t= target.dataset[\"schedule_id\"];\n\tvar text \t\t\t= \"Are you sure you want to remove this schedule\";\n\tvar formData \t\t= new FormData();\n\tformData.append('schedule_id', scheduleId);\n\n\tvar confirmed\t\t= await checkConfirmation(text);\n\tif(confirmed){\n\t\tvar response\t= await FormSubmit.fetchRestApi('events/remove_schedule', formData);\n\n\t\tif(response){\n\t\t\tMain.displayMessage(response);\n\n\t\t\tdocument.querySelector('.schedules_wrapper .loaderwrapper:not(.hidden)').remove();\n\t\t}\n\t}\n}\n\n//shows the modal to select a user as host\nfunction showAddHostModal(){\n\ttarget.classList.add('active');\n\tvar table\t\t\t\t\t\t\t\t\t\t\t= target.closest('table');\n\tvar cell\t\t\t\t\t\t\t\t\t\t\t= target.closest('td');\n\tvar date\t\t\t\t\t\t\t\t\t\t\t= table.rows[0].cells[cell.cellIndex].dataset.isodate;\n\tvar startTime\t\t\t\t\t\t\t\t\t\t= target.closest('tr').dataset.starttime;\n\tvar modal\t\t\t\t\t\t\t\t\t\t\t= target.closest('.schedules_wrapper').querySelector('[name=\"add_host\"]');\n\tmodal.querySelector('[name=\"schedule_id\"]').value\t= table.dataset[\"id\"];\n\tmodal.querySelector('[name=\"date\"]').value\t\t\t= date;\n\tmodal.querySelector('[name=\"starttime\"]').value\t\t= startTime;\n\tmodal.classList.remove('hidden');\n}\n\n// Add a new host when the host form is submitted\nasync function addHost(target){\n\tvar response \t= await FormSubmit.submitForm(target, 'events/add_host');\n\n\tif(response){\n\t\taddHostHtml(response);\n\t}\n}\n\n// Add current user as host\nasync function addCurrentUserAsHost(target){\n\tvar table\t\t\t= target.closest('table');\n\tvar cell\t\t\t= target.closest('td');\n\tvar scheduleOwner\t= table.dataset.target;\n\tvar dateStr\t\t\t= table.rows[0].cells[cell.cellIndex].dataset.date;\n\t\n\tvar text \t\t\t= `Please confirm you want to be the host for ${scheduleOwner} on ${dateStr}`;\n\tvar confirmed\t\t= await checkConfirmation(text);\n\n\tif(confirmed){\n\t\ttarget.classList.add('active');\n\n\t\tvar formData\t\t= loadHostFormdata(target);\n\n\t\tvar response\t= await FormSubmit.fetchRestApi('events/add_host', formData);\n\n\t\tif(response){\n\t\t\taddHostHtml(response);\n\t\t}\n\t}\n}\n\n// Show the new host in the schedule\nfunction addHostHtml(response){\n\tvar targetCell\t\t\t= document.querySelector('td.active');\n\ttargetCell.classList.remove('active');\n\n\tif(targetCell.rowSpan>1){\n\t\tvar row\t\t= targetCell.closest('tr');\n\t\tvar index\t= targetCell.cellIndex;\n\t\t//Loop over the next cells to add the hidden attribute\n\t\tfor (var i = 1; i < targetCell.rowSpan; i++) {\n\t\t\trow = row.nextElementSibling;\n\t\t\trow.cells[index].classList.add('hidden');\n\t\t}\n\t}\n\n\ttargetCell.outerHTML\t= response.html;\n\n\tMain.hideModals();\n\n\tadd_selectable();\n\n\tMain.displayMessage(response.message);\n}\n\n// Remove a host\nasync function removeHost(target){\n\tvar formData\t\t= loadHostFormdata(target);\n\n\tvar table\t\t\t= target.closest('table');\n\tvar scheduleOwner\t= table.dataset.target;\n\tvar cell\t\t\t= target.closest('td');\n\tvar dateStr\t\t\t= table.rows[0].cells[cell.cellIndex].dataset.date;\n\tvar text;\n\n\tif(target.classList.contains('orientation')){\n\t\ttext \t= `Are you sure you want to remove this orientation session`;\n\t}else if(target.classList.contains('admin')){\n\t\ttext \t= `Please confirm host removal for ${scheduleOwner} on ${dateStr}`;\n\t}else{\n\t\ttext \t= `Please confirm you do not want to be the host for ${scheduleOwner} on ${dateStr} anymore`;\n\t}\n\n\tvar confirmed\t= await checkConfirmation(text);\n\n\tif(confirmed){\n\t\tMain.showLoader(cell.firstChild);\n\n\t\tvar response = await FormSubmit.fetchRestApi('events/remove_host', formData);\n\n\t\t//Remove cell class\n\t\tcell.classList.remove('selected');\n\t\tcell.classList.remove('ui-selected');\n\n\t\t//Set cell text\n\t\tcell.innerHTML\t= 'Available';\n\t\tvar index\t\t= cell.cellIndex;\n\t\tvar row\t\t\t= cell.closest('tr');\n\n\t\t//only remove rowspan if the first cell of a row has no rowspan\n\t\tif(row.cells[0].rowSpan==1){\n\t\t\t//Loop over the next cells to remove the hidden attribute\n\t\t\tfor (var i = 1; i < target.rowSpan; i++) {\n\t\t\t\trow = row.nextElementSibling;\n\t\t\t\trow.cells[index].classList.remove('hidden');\n\t\t\t}\n\n\t\t\t//Reset the rowSpan\n\t\t\ttarget.rowSpan = 1;\n\t\t}\n\n\t\tMain.displayMessage(response);\n\t}\n}\n\nfunction showTimeslotModal(selected){\n\tvar modal \t\t\t= document.querySelector('[name=\"add_session\"]');\n\tvar firstCell\t\t= selected[0].node;\n\tvar lastCell\t\t= selected[selected.length-1].node;\n\n\tfirstCell.classList.add('active');\n\tfirstCell.rowSpan\t= document.querySelectorAll('.ui-selected').length;\n\tvar endTime\t\t\t= lastCell.closest('tr').dataset.endtime;\n\tvar table\t\t\t= firstCell.closest('table');\n\tvar date\t\t\t= table.rows[0].cells[first_cell.cellIndex].dataset.isodate;\n\t\n\t//Fill the modal values\n\tmodal.querySelector('[name=\"schedule_id\"]').value\t\t= table.dataset[\"id\"];\n\tmodal.querySelector('[name=\"date\"]').value\t\t\t\t= date;\n\tmodal.querySelector('[name=\"olddate\"]').value \t\t\t= date;\n\tmodal.querySelector('[name=\"starttime\"]').value\t\t\t= firstCell.closest('tr').dataset.starttime;\n\tmodal.querySelector('[name=\"endtime\"]').value\t\t\t= endTime;\n\tmodal.querySelector('[name=\"add_timeslot\"]').classList.remove('add_schedule_row');\n\tmodal.querySelector('[name=\"add_timeslot\"]').classList.add('update_schedule');\n\t\n\tmodal.classList.remove('hidden');\n}\n\nasync function editTimeSlot(selected){\n\tvar answer = await Swal.fire({\n\t\ttitle: 'What do you want to do?',\n\t\ttext: \"Do you want to edit or remove this timeslot?\",\n\t\tshowDenyButton: true,\n\t\tshowCancelButton: true,\n\t\tconfirmButtonText: 'Edit timeslot',\n\t\tdenyButtonText: 'Remove timeslot',\n\t});\n\t\n\tvar firstCell\t= selected[0].node;\n\n\t//swap and/or\n\tif (answer.isConfirmed) {\n\t\t// Show modal and prefill the default fields\n\t\tshowTimeslotModal(selected);\n\n\t\t// also prefill the other fields\n\t\tvar modal \t\t= document.querySelector('[name=\"add_session\"]');\n\t\tvar endRow\t\t= target.closest('tr').rowIndex + target.rowSpan - 1;\n\t\tvar endTime\t\t= target.closest('table').rows[endRow].dataset.firstCell;\t\t\t\n\t\tmodal.querySelector('[name=\"subject\"]').value\t\t\t= firstCell.querySelector('.subject').textContent;\n\t\tmodal.querySelector('[name=\"endtime\"]').value\t\t\t= endTime;\n\n\t\t//Fill locationfield\n\t\tvar locationtText = first_cell.querySelector('.location').textContent;\n\t\tif(locationtText != 'Add location'){\n\t\t\tmodal.querySelector('[name=\"location\"]').value\t\t\t= locationtText;\n\t\t}\n\t\t\n\t\t//Fill userfield\n\t\tvar userid = firstCell.dataset.host;\n\t\tif(userid != null){\n\t\t\tlet el = modal.querySelector('[name=\"host\"]');\n\t\t\tif(el != null){\n\t\t\t\tel.value\t= userid;\n\t\t\t}\n\t\t\tel.selectedOptions[0].defaultSelected=true;\n\t\t\tel._niceselect.update();\n\t\t\tel.selectedOptions[0].defaultSelected=false;\n\t\t}\n\t\t\n\t\t//change button text\n\t\tmodal.querySelector('[name=\"add_timeslot\"]').textContent\t= 'Update time slot';\n\t//add new rule after this one\n\t}else if (answer.isDenied) {\n\t\tremoveHost(firstCell);\n\t}\n}\n\n// Show the modal to add a recipe keyword\nfunction showRecipeModal(target){\n\ttarget.classList.add('active');\n\n\tvar table\t\t\t= target.closest('table');\n\tvar heading\t\t\t= table.tHead.rows[0];\n\tvar cell\t\t\t= target.closest('td');\n\tvar date\t\t\t= heading.cells[cell.cellIndex].dataset.isodate;\n\tvar startTime\t\t= target.closest('tr').dataset.starttime;\n\n\t//Fill the modal with the values of the clickes schedule\n\tvar recipeModal \t= document.querySelector('[name=\"recipe_keyword_modal\"]');\n\n\tFormSubmit.formReset(recipeModal.querySelector('form'));\n\n\trecipeModal.querySelector('[name=\"schedule_id\"]').value \t= table.dataset[\"id\"];\n\trecipeModal.querySelector('[name=\"date\"]').value \t\t\t= date;\n\trecipeModal.querySelector('[name=\"starttime\"]').value \t\t= startTime;\n\n\tif(target.textContent != 'Enter recipe keyword'){\n\t\trecipeModal.querySelector('[name=\"recipe_keyword\"]').value\t= target.textContent;\n\t\tdocument.querySelector('[name=\"add_recipe_keyword\"]').textContent\t= 'Update recipe keywords';\n\t}\n\t\n\trecipeModal.classList.remove('hidden');\n}\n\n//submit the recipe form\nasync function submitRecipe(target){\n\tvar response = await FormSubmit.submitForm(target, 'events/add_menu');\n\n\tdocument.querySelector('.active').textContent\t= target.closest('form').querySelector('[name=\"recipe_keyword\"]').value;\n\n\tdocument.querySelector('.active').classList.remove('active');\n\n\tMain.hideModals();\n\n\tMain.displayMessage(response);\n}\n\nfunction loadHostFormdata(target){\n\tvar table\t\t\t= target.closest('table');\n\tvar scheduleId\t\t= table.dataset[\"id\"];\n\tvar heading\t\t\t= table.tHead.rows[0];\n\tvar cell\t\t\t= target.closest('td');\n\tvar date\t\t\t= heading.cells[cell.cellIndex].dataset.isodate;\n\tvar startTime\t\t= target.closest('tr').dataset.starttime;\n\n\tvar formData\t\t= new FormData();\n\tformData.append('date',date);\n\tif(cell.dataset.host != null){\n\t\tformData.append('host',cell.dataset.host);\n\t}else{\n\t\tformData.append('host',sim.userId);\n\t}\n\t\n\tformData.append('starttime', startTime);\n\tformData.append('schedule_id', scheduleId);\n\n\treturn formData;\n}\n\nasync function checkConfirmation(text){\n\tvar result = await Swal.fire({\n\t\ttitle: 'Are you sure?',\n\t\ttext: text+\"?\",\n\t\ticon: 'warning',\n\t\tshowCancelButton: true,\n\t\tconfirmButtonColor: \"#bd2919\",\n\t\tcancelButtonColor: '#d33',\n\t\tconfirmButtonText: 'Yes'\n\t});\n\t\n\t\tif (result.isConfirmed) {\n\t\t\tdocument.querySelectorAll('.modal:not(.hidden)').forEach(modal=>modal.classList.add('hidden'));\n\t\t\t//display loading gif\n\t\t\tif(target.classList.contains('remove_schedule')){\n\t\t\t\tMain.showLoader(target.closest('.schedules_div'));\n\t\t\t}else{\n\t\t\t\tMain.showLoader(target.firstChild);\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n}\n\n//hide empty rows on mobile\nfunction hideRows() {\n\t//only run for smaller screens\n\tif (window.innerWidth > 800) return false;\n\t\n\t//Loop over all tables\n\tdocument.querySelectorAll('.sim-table tr').forEach(function(tr){\n\t\tvar emptyRow = true;\n\t\t\n\t\t//DO not hide lunch or dinner rows\n\t\tif(tr.dataset.starttime != 'dinner' && tr.dataset.starttime != 'lunch'){\n\t\t\t//loop over all table cells to see if there is a cell with content\n\t\t\ttr.querySelectorAll('td').forEach(function(cell,index){\n\t\t\t\tif(index>0 && cell.textContent != 'Available' && cell.textContent != ' '){\n\t\t\t\t\temptyRow = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t//If non of the cells have content\n\t\t\tif(emptyRow ){\n\t\t\t\t//hide the row\n\t\t\t\ttr.classList.add('hidden');\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction add_selectable(){\n\t//Add selectable on non-mobile devices\n\t//if(!isMobileDevice()){\n\t\t//loop over all the schedule tables\n\t\tdocument.querySelectorAll('.sim-table.schedule').forEach(function(table){\n\t\t\t//Load selectable and attach it to the table\n\t\t\ttable._selectable = new Selectable({\n\t\t\t   filter:\t\t\".orientation.admin\",\n\t\t\t   appendTo:\ttable.querySelector(\"tbody\"),\n\t\t\t   lasso: {\n\t\t\t\t\tborder: \"none\",\n\t\t\t\t\tbackgroundColor: \"none\"\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\t//Run the function afterSelect when selection is final\n\t\t\ttable._selectable.on('end', afterSelect);\n\t\t});\n\t//}\n\n\thideRows();\n}\n\ndocument.addEventListener(\"DOMContentLoaded\",function() {\n\tconsole.log(\"Schedule.js loaded\");\n\t\n\tadd_selectable();\n});\n\ndocument.addEventListener('click',function(event){\n\ttarget = event.target;\n\t\n\tif(target.name == 'add_schedule'){\n\t\tevent.stopPropagation();\n\n\t\taddSchedule(target);\n\t}\n\n\tif(target.classList.contains('remove_schedule')){\n\t\tevent.stopPropagation();\n\n\t\tremoveSchedule(target);\n\t}\n\n\t//publish the schedule\n\tif(target.classList.contains('publish')){\n\t\tevent.stopPropagation();\n\n\t\tShowPublishScheduleModal(target);\n\t}\n\n\tif(target.name == 'publish_schedule'){\n\t\tevent.stopPropagation();\n\n\t\tpublishSchedule(target);\n\t}\n\t\n\tif(target.classList.contains('keyword')){\n\t\tshowRecipeModal(target);\n\t}\n\n\tif(target.name == 'add_recipe_keyword'){\n\t\tevent.stopPropagation();\n\n\t\tsubmitRecipe(target);\n\t}\n\n\tif(target.name == 'add_host' || target.name == 'add_timeslot'){\n\t\tevent.stopPropagation();\n\t\t\n\t\taddHost(target);\n\t}\n});\n\ndocument.addEventListener('change',function(event){\n\ttarget = event.target;\n\t//Direct table actions\n\tif(target.name=='target_name'){\n\t\tvar userid = target.list.querySelector(\"[value='\"+target.value+\"' i]\").dataset.value;\n\n\t\ttarget.closest('form').querySelector('[name=\"target_id\"]').value\t= userid;\n\t}\n});\n\nfunction checkIfValidSelection(target, selected, e){\n\t//we have selected something and there are no open modals\n\tvar openModals\t= document.querySelectorAll('.modal:not(.hidden)');\n\tif((selected.length > 0 || target.classList.contains('orientation')) && (openModals == null || openModals.length == 0) ){\t\n\t\t//check if selection is valid\n\t\tvar columnNr\t= selected[0].node.cellIndex;\n\t\tvar firstCell\t= selected[0].node;\n\n\t\tfor (const selection of selected){\n\t\t\tif(columnNr != selection.node.cellIndex){\n\t\t\t\tSwal.fire({\n\t\t\t\t\ticon: 'error',\n\t\t\t\t\ttitle: \"You can not select times on multiple days!\",\n\t\t\t\t\tconfirmButtonColor: \"#bd2919\",\n\t\t\t\t});\n\t\t\t\te.target.closest('.sim-table')._selectable.clear();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t//We are dealing with a cell with a value\n\t\tif(firstCell.classList.contains('selected')){\n\t\t\teditTimeSlot(selected);\n\t\t}else{\n\t\t\tshowTimeslotModal(selected);\n\t\t}\n\t}\n}\n\n//Do something with selected items\nfunction afterSelect(e, selected, _unselected){\n\ttarget = e.target;\n\n\t//remove a meal host\n\tif(target.matches('.meal.selected')){\n\t\tremoveHost(target);\n\t//Add a host\n\t}else if(target.matches('.meal.admin')){\n\t\tshowAddHostModal();\n\t//orientation slot\n\t}else if(target.matches('.meal:not(.admin)')){\n\t\taddCurrentUserAsHost(target);\n\t}else{\n\t\tcheckIfValidSelection(target, selected, e); \n\t}\n}"],"names":["addHostHtml","response","targetCell","document","querySelector","classList","remove","rowSpan","row","closest","index","cellIndex","i","nextElementSibling","cells","add","outerHTML","html","Main","hideModals","add_selectable","displayMessage","message","async","removeHost","target","text","formData","loadHostFormdata","table","scheduleOwner","dataset","cell","dateStr","rows","date","contains","checkConfirmation","showLoader","firstChild","FormSubmit","fetchRestApi","innerHTML","showTimeslotModal","selected","modal","firstCell","node","lastCell","length","querySelectorAll","endTime","endtime","first_cell","isodate","value","starttime","editTimeSlot","answer","Swal","fire","title","showDenyButton","showCancelButton","confirmButtonText","denyButtonText","isConfirmed","endRow","rowIndex","textContent","locationtText","userid","host","el","selectedOptions","defaultSelected","_niceselect","update","isDenied","scheduleId","heading","tHead","startTime","FormData","append","sim","userId","icon","confirmButtonColor","cancelButtonColor","forEach","_selectable","Selectable","filter","appendTo","lasso","border","backgroundColor","on","afterSelect","window","innerWidth","tr","emptyRow","hideRows","e","_unselected","matches","showAddHostModal","addCurrentUserAsHost","openModals","columnNr","selection","clear","checkIfValidSelection","addEventListener","console","log","event","name","stopPropagation","submitForm","addSchedule","removeSchedule","click","ShowPublishScheduleModal","publishSchedule","recipeModal","formReset","showRecipeModal","submitRecipe","addHost","list"],"sourceRoot":""}