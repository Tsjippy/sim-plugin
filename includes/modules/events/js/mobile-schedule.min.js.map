{"version":3,"file":"mobile-schedule.min.js","mappings":"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","sources":["webpack://events/./schedules/shared.js","webpack://events/./schedules/mobile.js"],"sourcesContent":["//shows the modal to select a user as host\r\nexport function showAddHostModal(target, date='', startTime=''){\r\n\ttarget.classList.add('active');\r\n\tlet modal\t\t\t\t\t\t\t\t\t\t\t= document.querySelector('[name=\"add_host\"]');\r\n\r\n\t// Clear\r\n\tmodal.querySelectorAll('input:not([type=\"hidden\"], [type=\"radio\"])').forEach(el=>el.value='');\r\n\r\n    modal.querySelector('[name=\"date\"]').value\t\t\t= date;\r\n    modal.querySelector('[name=\"starttime\"]').value\t\t= startTime;\r\n\r\n\t// Add new values\r\n\tmodal.querySelector('[name=\"schedule_id\"]').value\t= target.closest('.schedules_div').dataset.id;\r\n\r\n\tmodal.classList.remove('hidden');\r\n}\r\n\r\n// Add current user as host\r\nexport async function addCurrentUserAsHost(target, dateStr){\r\n    let scheduleOwner\t= target.closest('.schedules_div').dataset.target;   \r\n\tlet text \t\t\t= `Please confirm you want to be the host for ${scheduleOwner} on ${dateStr}`;\r\n\tlet confirmed\t\t= await checkConfirmation(text, target.firstChild);\r\n\r\n\tif(confirmed){\r\n\r\n\t\tlet formData\t\t= loadHostFormdata(target);\r\n\r\n\t\tif(target.closest('table') == null){\r\n\t\t\tMain.showLoader(target);\r\n\t\t}\r\n\r\n\t\tlet response\t= await FormSubmit.fetchRestApi('events/add_host', formData);\r\n\r\n\t\tif(response){\r\n\t\t\taddHostHtml(response);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// Show the new host in the schedule\r\nexport function addHostHtml(response){\r\n\tlet target\t\t\t= document.querySelector('.active');\r\n\r\n\tif(target != null){\r\n\t\ttarget.classList.remove('active');\r\n\t\ttarget.outerHTML\t= response.html;\r\n\t}\r\n\r\n\tMain.displayMessage(response.message);\r\n\r\n\tMain.hideModals();\r\n}\r\n\r\n// Remove a host\r\nexport async function removeHost(target, dateStr){\r\n\tlet text, confirmed;\r\n\r\n    let scheduleOwner\t= target.closest('.schedules_div').dataset.target;\r\n\r\n\tif(target.classList.contains('orientation')){\r\n\t\ttext \t= `Are you sure you want to remove this orientation session`;\r\n\t}else if(target.classList.contains('admin')){\r\n\t\ttext \t= `Please confirm host removal for ${scheduleOwner} on ${dateStr}`;\r\n\t}else{\r\n\t\ttext \t= `Please confirm you do not want to be the host for ${scheduleOwner} on ${dateStr} anymore`;\r\n\t}\r\n\r\n\tconfirmed\t= await checkConfirmation(text, target.firstChild);\r\n\r\n\tif(confirmed){\r\n\t\t\r\n\t\tlet formData\t\t= new FormData();\r\n\t\tformData.append('session_id', target.dataset.session_id);\r\n\t\tMain.showLoader(target.firstChild);\r\n\r\n\t\tvar response = await FormSubmit.fetchRestApi('events/remove_host', formData);\r\n\r\n\t\tMain.displayMessage(response);\r\n\t}\r\n\r\n    return confirmed;\r\n}\r\n\r\nexport function showTimeslotModal(target='', date='', startTime='', endTime=''){\r\n\tlet hostId, subject, location, hostName, sessionId;\r\n\tlet modal \t\t\t= document.querySelector('[name=\"add_session\"]');\r\n\r\n\t// Clear\r\n\tmodal.querySelectorAll('input:not([type=\"hidden\"], [type=\"checkbox\"], [type=\"radio\"])').forEach(el=>el.value='');\r\n\r\n\tmodal.querySelector('[name=\"schedule_id\"]').value\t\t= target.closest('.schedules_div').dataset.id;\r\n\r\n\thostId\t\t\t= target.dataset.host_id;\r\n\tsubject\t\t\t= target.dataset.subject;\r\n\tlocation\t\t= target.dataset.location;\r\n\thostName\t\t= target.dataset.host;\r\n\tsessionId\t\t= target.dataset.session_id;\r\n\r\n\t//Fill the modal values\r\n\tmodal.querySelector('[name=\"date\"]').value\t\t\t\t= date;\r\n\tmodal.querySelector('[name=\"starttime\"]').value\t\t\t= startTime;\r\n\tmodal.querySelector('[name=\"endtime\"]').value\t\t\t= endTime;\r\n\tmodal.querySelector('[name=\"add_timeslot\"]').classList.remove('add_schedule_row');\r\n\tmodal.querySelector('[name=\"add_timeslot\"]').classList.add('update_schedule');\r\n\r\n\tif( target.dataset.session_id != undefined){\r\n\t\tmodal.querySelector('[name=\"session-id\"]').value\t= sessionId;\r\n\t}\r\n\tif(hostId\t!= undefined){\r\n\t\tmodal.querySelector('[name=\"host_id\"]').value\t\t= hostId;\r\n\t}\r\n\tif(subject\t!= undefined){\r\n\t\tmodal.querySelector('[name=\"subject\"]').value\t\t= subject;\r\n\t}\r\n\tif(location\t!= undefined){\r\n\t\tmodal.querySelector('[name=\"location\"]').value\t\t= location;\r\n\t}\r\n\tif(hostName\t!= undefined){\r\n\t\tmodal.querySelector('[name=\"host\"]').value\t\t\t= hostName;\r\n\t}\r\n\t\r\n\tMain.showModal(modal);\r\n}\r\n\r\nexport async function editTimeSlot(target, date, dateStr){\r\n\tlet options\t= {\r\n\t\ttitle: 'What do you want to do?',\r\n\t\ttext: \"Do you want to edit or remove this timeslot?\",\r\n\t\tshowDenyButton: true,\r\n\t\tshowCancelButton: true,\r\n\t\tconfirmButtonText: 'Edit timeslot',\r\n\t\tdenyButtonText: 'Remove timeslot',\r\n\t}\r\n\r\n\tif(document.fullscreenElement != null){\r\n\t\toptions['target']\t= document.fullscreenElement;\r\n\t}\r\n\r\n\tvar answer = await Swal.fire(options);\r\n\r\n\t//swap and/or\r\n\tif (answer.isConfirmed) {\r\n\t\t// Show modal and prefill the default fields\r\n\t\tshowTimeslotModal(target, date, target.dataset.starttime, target.dataset.endtime);\r\n\t\t\r\n\t\t//change button text\r\n\t\tvar modal \t\t\t= document.querySelector('[name=\"add_session\"]');\r\n\t\tmodal.querySelector('[name=\"add_timeslot\"]').textContent\t= 'Update time slot';\r\n\t//add new rule after this one\r\n\t}else if (answer.isDenied) {\r\n\t\treturn answer.isDenied;\r\n\t}\r\n}\r\n\r\nfunction loadHostFormdata(target){\r\n    let scheduleId\t\t= target.closest('.schedules_div').dataset.id;\r\n\tlet table\t\t\t= target.closest('table');\r\n\r\n\tlet heading, cell, date, startTime, host;\r\n\r\n\tif(table == null){\r\n\t\tstartTime\t\t= target.dataset.starttime;\r\n\t\thost\t\t\t= target.dataset.host_id;\r\n\t\tdate\t\t\t= target.dataset.isodate\r\n\t}else{\r\n\t\theading\t\t\t= table.tHead.rows[0];\r\n\t\tcell\t\t\t= target.closest('td');\r\n\t\tstartTime\t\t= target.closest('tr').dataset.starttime;\r\n\t\thost\t\t\t= cell.dataset.host;\r\n\t\tdate\t\t\t= heading.cells[cell.cellIndex].dataset.isodate;\r\n\t}\r\n\r\n\tvar formData\t\t= new FormData();\r\n\tformData.append('date', date);\r\n\tif(host != null){\r\n\t\tformData.append('host_id', host);\r\n\t}else{\r\n\t\tformData.append('host_id', sim.userId);\r\n\t}\r\n\t\r\n\tformData.append('starttime', startTime);\r\n\tformData.append('schedule_id', scheduleId);\r\n\r\n\treturn formData;\r\n}\r\n\r\nexport async function checkConfirmation(text, target){\r\n\tlet options = {\r\n\t\ttitle: 'Are you sure?',\r\n\t\ttext: text+\"?\",\r\n\t\ticon: 'warning',\r\n\t\tshowCancelButton: true,\r\n\t\tconfirmButtonColor: \"#bd2919\",\r\n\t\tcancelButtonColor: '#d33',\r\n\t\tconfirmButtonText: 'Yes'\r\n\t};\r\n\r\n\tif(document.fullscreenElement != null){\r\n\t\toptions['target']\t= document.fullscreenElement;\r\n\t}\r\n\r\n\tvar result = await Swal.fire(options);\r\n\t\r\n\tif (result.isConfirmed) {\r\n\t\tdocument.querySelectorAll('.modal:not(.hidden)').forEach(modal=>modal.classList.add('hidden'));\r\n\t\t//display loading gif\r\n\t\tMain.showLoader(target.firstChild);\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\ndocument.addEventListener('click',function(event){\r\n\tlet target = event.target;\r\n\r\n\tif(target.name == 'add-session'){\r\n        console.log('click12')\r\n\t\tevent.stopPropagation();\r\n\t\tshowTimeslotModal(target);\r\n\t}else if(target.name == 'add-host'){\r\n        console.log('click13')\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tMain.showModal(target.closest('.schedules_div').querySelector('.add-host-mobile-wrapper'));\r\n\t}\t\r\n});","import { addCurrentUserAsHost, removeHost, editTimeSlot, addHostHtml } from './shared.js';\r\n\r\nconsole.log(\"Mobile-schedule.js loaded\");\r\n\r\n// Add a new host/ updates an existing entry when the host form is submitted\r\nasync function addHost(target){\r\n\tvar response \t= await FormSubmit.submitForm(target, 'events/add_host');\r\n\r\n\tif(response){\r\n\t\taddHostHtml(response);\r\n\t\tMain.displayMessage(response.message);\r\n\t}\r\n\r\n    Main.hideModals();\r\n}\r\n\r\ndocument.addEventListener('click', async function(event){\r\n    let target = event.target;\r\n\r\n    if(target.closest('.add-me-as-host') != null){\r\n        target  = target.closest('.add-me-as-host');\r\n        target.closest('.session-wrapper-mobile ').classList.add('active');\r\n\t\taddCurrentUserAsHost(target.closest('.add-me-as-host'), target.dataset.date);\r\n\t}else if(target.closest('.remove-host-mobile') != null){\r\n\t\tevent.stopPropagation();\r\n        target      = target.closest('.remove-host-mobile');\r\n        let wrapper\t= target.closest('.session-wrapper-mobile');\r\n\r\n\t\tlet result = await removeHost(target, target.dataset.date);\r\n\r\n        if(result){\r\n            wrapper.remove();\r\n        }\r\n\t}else if (target.name == 'add_host_mobile' || target.name == 'add_timeslot' ){\r\n\t\tevent.stopPropagation();\r\n\t\taddHost(target)\r\n\t}else if(target.closest('.edit-session-mobile') != null){\r\n        target  = target.closest('.edit-session-mobile');\r\n\r\n        target.closest('.day-wrapper-mobile').classList.add('active');\r\n\r\n\t\tlet result = await editTimeSlot(target, target.dataset.isodate, target.dataset.date);\r\n        if(result){\r\n            target.remove();\r\n        }\r\n\t}else if(target.name == 'add_host'){\r\n\t\tevent.stopPropagation();\r\n\t\t\r\n\t\taddHost(target);\r\n\t}\r\n});\r\n\r\ndocument.addEventListener('change', function(event){\r\n\r\n\tlet target = event.target;\r\n\r\n\t//Direct table actions\r\n\tif(target.name == 'starttime' && target.type == 'radio'){\r\n\t\tif(target.value == '12:00'){\r\n\t\t\ttarget.closest('form').querySelector('.lunch.select-wrapper').classList.remove('hidden');\r\n\t\t\ttarget.closest('form').querySelector('.diner.select-wrapper').classList.add('hidden');\r\n\t\t}else{\r\n\t\t\ttarget.closest('form').querySelector('.diner.select-wrapper').classList.remove('hidden');\r\n\t\t\ttarget.closest('form').querySelector('.lunch.select-wrapper').classList.add('hidden');\r\n\t\t}\r\n\t}\r\n});"],"names":["addHostHtml","response","target","document","querySelector","classList","remove","outerHTML","html","Main","displayMessage","message","hideModals","showTimeslotModal","date","startTime","endTime","hostId","subject","location","hostName","sessionId","modal","querySelectorAll","forEach","el","value","closest","dataset","id","host_id","host","session_id","add","undefined","showModal","async","checkConfirmation","text","options","title","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","fullscreenElement","Swal","fire","isConfirmed","showLoader","firstChild","addHost","FormSubmit","submitForm","addEventListener","event","name","console","log","stopPropagation","dateStr","formData","heading","cell","scheduleId","table","starttime","isodate","tHead","rows","cells","cellIndex","FormData","append","sim","userId","loadHostFormdata","fetchRestApi","addCurrentUserAsHost","wrapper","result","confirmed","scheduleOwner","contains","removeHost","showDenyButton","denyButtonText","answer","endtime","textContent","isDenied","editTimeSlot","type"],"sourceRoot":""}