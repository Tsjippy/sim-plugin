(()=>{"use strict";function e(e){let t=document.querySelector(".active");t.classList.remove("active"),t.outerHTML=e.html,Main.displayMessage(e.message),Main.hideModals()}function t(e="",t="",s="",a=""){let o,l,n,i,d,r,c=document.querySelector('[name="add_session"]');c.querySelectorAll('input:not([type="hidden"], [type="checkbox"], [type="radio"])').forEach((e=>e.value="")),c.querySelector('[name="schedule_id"]').value=e.closest(".schedules_div").dataset.id,o=e.dataset.host_id,l=e.dataset.old_time,n=e.dataset.subject,i=e.dataset.location,d=e.dataset.host,r=e.dataset.event_id,c.querySelector('[name="date"]').value=t,c.querySelector('[name="starttime"]').value=s,c.querySelector('[name="endtime"]').value=a,c.querySelector('[name="add_timeslot"]').classList.remove("add_schedule_row"),c.querySelector('[name="add_timeslot"]').classList.add("update_schedule"),null!=s&&(c.querySelector('[name="oldtime"]').value=s),null!=t&&(c.querySelector('[name="olddate"]').value=t),null!=r&&(c.querySelector('[name="event-id"]').value=r),null!=o&&(c.querySelector('[name="host_id"]').value=o),null!=n&&(c.querySelector('[name="subject"]').value=n),null!=i&&(c.querySelector('[name="location"]').value=i),null!=d&&(c.querySelector('[name="host"]').value=d),Main.showModal(c)}function s(e){let t,s,a,o,l,n=e.closest(".schedules_div").dataset.id,i=e.closest("table");null==i?(o=e.dataset.starttime,l=e.dataset.host_id,a=e.dataset.isodate):(t=i.tHead.rows[0],s=e.closest("td"),o=e.closest("tr").dataset.starttime,l=s.dataset.host,a=t.cells[s.cellIndex].dataset.isodate);var d=new FormData;return d.append("date",a),null!=l?d.append("host_id",l):d.append("host_id",sim.userId),d.append("starttime",o),d.append("schedule_id",n),d}async function a(e,t){let s={title:"Are you sure?",text:e+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#bd2919",cancelButtonColor:"#d33",confirmButtonText:"Yes"};return null!=document.fullscreenElement&&(s.target=document.fullscreenElement),!!(await Swal.fire(s)).isConfirmed&&(document.querySelectorAll(".modal:not(.hidden)").forEach((e=>e.classList.add("hidden"))),Main.showLoader(t.firstChild),!0)}document.addEventListener("click",(function(e){let s=e.target;"add-session"==s.name?(console.log("click12"),e.stopPropagation(),t(s)):"add-host"==s.name&&(console.log("click13"),e.stopPropagation(),Main.showModal(s.closest(".schedules_div").querySelector(".add-host-mobile-wrapper")))})),console.log("Mobile-schedule.js loaded"),document.addEventListener("click",(async function(o){let l=o.target;if(null!=l.closest(".add-me-as-host"))l=l.closest(".add-me-as-host"),l.closest(".session-wrapper-mobile ").classList.add("active"),async function(t,o){let l=`Please confirm you want to be the host for ${t.closest(".schedules_div").dataset.target} on ${o}`;if(await a(l,t.firstChild)){let a=s(t);null==t.closest("table")&&Main.showLoader(t);let o=await FormSubmit.fetchRestApi("events/add_host",a);o&&e(o)}}(l.closest(".add-me-as-host"),l.dataset.date);else if(null!=l.closest(".remove-host-mobile")){o.stopPropagation(),l=l.closest(".remove-host-mobile");let e=l.closest(".session-wrapper-mobile"),t=await async function(e,t){let o,l,n=e.closest(".schedules_div").dataset.target,i=s(e);if(o=e.classList.contains("orientation")?"Are you sure you want to remove this orientation session":e.classList.contains("admin")?`Please confirm host removal for ${n} on ${t}`:`Please confirm you do not want to be the host for ${n} on ${t} anymore`,l=await a(o,e.firstChild),l){Main.showLoader(e);var d=await FormSubmit.fetchRestApi("events/remove_host",i);Main.displayMessage(d)}return l}(l,l.dataset.date);t&&e.remove()}else if("add_host_mobile"==l.name||"add_timeslot"==l.name)o.stopPropagation(),async function(e){var t=await FormSubmit.submitForm(e,"events/add_host");console.log(t),t&&Main.displayMessage(t.message),Main.hideModals()}(l);else if(null!=l.closest(".edit-session-mobile")){l=l.closest(".edit-session-mobile"),l.closest(".day-wrapper-mobile").classList.add("active");let e=await async function(e,s,a){let o={title:"What do you want to do?",text:"Do you want to edit or remove this timeslot?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Edit timeslot",denyButtonText:"Remove timeslot"};null!=document.fullscreenElement&&(o.target=document.fullscreenElement);var l=await Swal.fire(o);if(l.isConfirmed)t(e,s,e.dataset.starttime,e.dataset.endtime),document.querySelector('[name="add_session"]').querySelector('[name="add_timeslot"]').textContent="Update time slot";else if(l.isDenied)return l.isDenied}(l,l.dataset.isodate,l.dataset.date);e&&l.remove()}else"add_host"==l.name&&(o.stopPropagation(),async function(t){var s=await FormSubmit.submitForm(t,"events/add_host");s&&e(s),Main.hideModals()}(l))})),document.addEventListener("change",(function(e){let t=e.target;"starttime"==t.name&&"radio"==t.type&&("12:00"==t.value?(t.closest("form").querySelector(".lunch.select-wrapper").classList.remove("hidden"),t.closest("form").querySelector(".diner.select-wrapper").classList.add("hidden")):(t.closest("form").querySelector(".diner.select-wrapper").classList.remove("hidden"),t.closest("form").querySelector(".lunch.select-wrapper").classList.add("hidden")))}))})();
//# sourceMappingURL=mobile-schedule.min.js.map