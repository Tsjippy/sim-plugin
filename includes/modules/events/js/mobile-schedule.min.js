(()=>{"use strict";function e(e){let t=document.querySelector(".active");null!=t&&(t.classList.remove("active"),t.outerHTML=e.html),Main.displayMessage(e.message),Main.hideModals()}async function t(e,t){let s,o,l=e.closest(".schedules_div").dataset.target;if(s=e.classList.contains("orientation")?"Are you sure you want to remove this orientation session":e.classList.contains("admin")?`Please confirm host removal for ${l} on ${t}`:`Please confirm you do not want to be the host for ${l} on ${t} anymore`,o=await a(s,e.firstChild),o){let t=new FormData;t.append("session_id",e.dataset.session_id),Main.showLoader(e.firstChild);var d=await FormSubmit.fetchRestApi("events/remove_host",t);return Main.displayMessage(d.message),d.html}return o}function s(e="",t="",s="",a=""){let o,l,d,i,n,r=document.querySelector('[name="add_session"]');r.querySelectorAll('input:not([type="hidden"], [type="checkbox"], [type="radio"])').forEach((e=>e.value="")),r.querySelector('[name="schedule_id"]').value=e.closest(".schedules_div").dataset.id,o=e.dataset.host_id,l=e.dataset.subject,d=e.dataset.location,i=e.dataset.host,n=e.dataset.session_id,r.querySelector('[name="date"]').value=t,r.querySelector('[name="starttime"]').value=s,r.querySelector('[name="endtime"]').value=a,r.querySelector('[name="add_timeslot"]').classList.remove("add_schedule_row"),r.querySelector('[name="add_timeslot"]').classList.add("update_schedule"),null!=e.dataset.session_id&&(r.querySelector('[name="session-id"]').value=n),null!=o&&(r.querySelector('[name="host_id"]').value=o),null!=l&&(r.querySelector('[name="subject"]').value=l),null!=d&&(r.querySelector('[name="location"]').value=d),null!=i&&(r.querySelector('[name="host"]').value=i),Main.showModal(r)}async function a(e,t){let s={title:"Are you sure?",text:e+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#bd2919",cancelButtonColor:"#d33",confirmButtonText:"Yes"};return null!=document.fullscreenElement&&(s.target=document.fullscreenElement),!!(await Swal.fire(s)).isConfirmed&&(document.querySelectorAll(".modal:not(.hidden)").forEach((e=>e.classList.add("hidden"))),Main.showLoader(t.firstChild),!0)}async function o(t,s=!1){var a=await FormSubmit.submitForm(t,"events/add_host");a&&(s?(document.querySelectorAll(".active").forEach((e=>{e.classList.remove("active"),e.outerHTML=a.html[e.dataset.isodate]})),Main.displayMessage(a.message),Main.hideModals()):e(a),Main.displayMessage(a.message)),Main.hideModals()}console.log("Mobile-schedule.js loaded"),document.addEventListener("click",(async function(l){let d=l.target;if(null!=d.closest(".add-me-as-host"))d=d.closest(".add-me-as-host"),d.closest(".day-wrapper-mobile").classList.add("active"),async function(t,s){let o=`Please confirm you want to be the host for ${t.closest(".schedules_div").dataset.target} on ${s}`;if(await a(o,t.firstChild)){let s=function(e){let t,s,a,o,l,d=e.closest(".schedules_div").dataset.id,i=e.closest("table");null==i?(o=e.dataset.starttime,l=e.dataset.host_id,a=e.dataset.isodate):(t=i.tHead.rows[0],s=e.closest("td"),o=e.closest("tr").dataset.starttime,l=s.dataset.host,a=t.cells[s.cellIndex].dataset.isodate);var n=new FormData;return n.append("date",a),null!=l?n.append("host_id",l):n.append("host_id",sim.userId),n.append("starttime",o),n.append("schedule_id",d),n}(t);null==t.closest("table")&&Main.showLoader(t);let a=await FormSubmit.fetchRestApi("events/add_host",s);a&&e(a)}}(d.closest(".add-me-as-host"),d.dataset.date);else if(null!=d.closest(".remove-host-mobile")){l.stopPropagation(),d=d.closest(".remove-host-mobile");let e=d.closest(".session-wrapper-mobile"),s=e.closest(".day-wrapper-mobile"),a=e.matches(".meal"),o=await t(d,d.dataset.date);o&&(a?s.outerHTML=o:e.remove())}else if("add_host_mobile"==d.name)l.stopPropagation(),o(d,!0);else if(null!=d.closest(".edit-session-mobile")){d=d.closest(".edit-session-mobile"),d.closest(".day-wrapper-mobile").classList.add("active");let e=d.closest(".session-wrapper-mobile"),a=await async function(e,t,a){let o={title:"What do you want to do?",text:"Do you want to edit or remove this timeslot?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Edit timeslot",denyButtonText:"Remove timeslot"};null!=document.fullscreenElement&&(o.target=document.fullscreenElement);var l=await Swal.fire(o);if(l.isConfirmed)s(e,t,e.dataset.starttime,e.dataset.endtime),document.querySelector('[name="add_session"]').querySelector('[name="add_timeslot"]').textContent="Update time slot";else if(l.isDenied)return l.isDenied}(d,d.dataset.isodate,d.dataset.date);a&&(t(e,d.dataset.date),e.remove())}else"add_host"==d.name||"add_timeslot"==d.name?(l.stopPropagation(),o(d)):"add-session"==d.name?(l.stopPropagation(),s(d)):"add-host"==d.name&&(l.stopPropagation(),Main.showModal(d.closest(".schedules_div").querySelector(".add-host-mobile-wrapper")))})),document.addEventListener("change",(function(e){let t=e.target;if("starttime"==t.name&&"radio"==t.type)"12:00"==t.value?(t.closest("form").querySelector(".lunch.select-wrapper").classList.remove("hidden"),t.closest("form").querySelector(".diner.select-wrapper").classList.add("hidden")):(t.closest("form").querySelector(".diner.select-wrapper").classList.remove("hidden"),t.closest("form").querySelector(".lunch.select-wrapper").classList.add("hidden"));else if(t.matches('.schedules_wrapper [name="add_session"] [name="date"]')){let e=t.closest("form"),s=e.querySelector('[name="schedule_id"').value;e.querySelectorAll(".active").forEach((e=>e.classList.remove("active")));let a=document.querySelector(`.schedules_div[data-id='${s}'] .day-wrapper-mobile[data-isodate='${t.value}']`);null!=a&&a.classList.add("active")}else if(t.matches('.add-host-mobile-wrapper [name="date[]"]')){let e=t.closest("form"),s=e.querySelector('[name="schedule_id"').value;e.querySelectorAll(".active").forEach((e=>e.classList.remove("active"))),e.querySelectorAll('[name="date[]"]:checked ').forEach((e=>{let t=document.querySelector(`.schedules_div[data-id='${s}'] .day-wrapper-mobile[data-isodate='${e.value}']`);null!=t&&t.classList.add("active")}))}}))})();
//# sourceMappingURL=mobile-schedule.min.js.map