(()=>{"use strict";function e(e){let t=document.querySelector(".active");null!=t&&(t.classList.remove("active"),t.outerHTML=e.html),Main.displayMessage(e.message),Main.hideModals()}function t(e="",t="",s="",a=""){let o,l,n,i,d,r=document.querySelector('[name="add_session"]');r.querySelectorAll('input:not([type="hidden"], [type="checkbox"], [type="radio"])').forEach((e=>e.value="")),r.querySelector('[name="schedule_id"]').value=e.closest(".schedules_div").dataset.id,o=e.dataset.host_id,l=e.dataset.subject,n=e.dataset.location,i=e.dataset.host,d=e.dataset.session_id,r.querySelector('[name="date"]').value=t,r.querySelector('[name="starttime"]').value=s,r.querySelector('[name="endtime"]').value=a,r.querySelector('[name="add_timeslot"]').classList.remove("add_schedule_row"),r.querySelector('[name="add_timeslot"]').classList.add("update_schedule"),null!=e.dataset.session_id&&(r.querySelector('[name="session-id"]').value=d),null!=o&&(r.querySelector('[name="host_id"]').value=o),null!=l&&(r.querySelector('[name="subject"]').value=l),null!=n&&(r.querySelector('[name="location"]').value=n),null!=i&&(r.querySelector('[name="host"]').value=i),Main.showModal(r)}async function s(e,t){let s={title:"Are you sure?",text:e+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#bd2919",cancelButtonColor:"#d33",confirmButtonText:"Yes"};return null!=document.fullscreenElement&&(s.target=document.fullscreenElement),!!(await Swal.fire(s)).isConfirmed&&(document.querySelectorAll(".modal:not(.hidden)").forEach((e=>e.classList.add("hidden"))),Main.showLoader(t.firstChild),!0)}async function a(t){var s=await FormSubmit.submitForm(t,"events/add_host");s&&(e(s),Main.displayMessage(s.message)),Main.hideModals()}document.addEventListener("click",(function(e){let s=e.target;"add-session"==s.name?(console.log("click12"),e.stopPropagation(),t(s)):"add-host"==s.name&&(console.log("click13"),e.stopPropagation(),Main.showModal(s.closest(".schedules_div").querySelector(".add-host-mobile-wrapper")))})),console.log("Mobile-schedule.js loaded"),document.addEventListener("click",(async function(o){let l=o.target;if(null!=l.closest(".add-me-as-host"))l=l.closest(".add-me-as-host"),l.closest(".session-wrapper-mobile ").classList.add("active"),async function(t,a){let o=`Please confirm you want to be the host for ${t.closest(".schedules_div").dataset.target} on ${a}`;if(await s(o,t.firstChild)){let s=function(e){let t,s,a,o,l,n=e.closest(".schedules_div").dataset.id,i=e.closest("table");null==i?(o=e.dataset.starttime,l=e.dataset.host_id,a=e.dataset.isodate):(t=i.tHead.rows[0],s=e.closest("td"),o=e.closest("tr").dataset.starttime,l=s.dataset.host,a=t.cells[s.cellIndex].dataset.isodate);var d=new FormData;return d.append("date",a),null!=l?d.append("host_id",l):d.append("host_id",sim.userId),d.append("starttime",o),d.append("schedule_id",n),d}(t);null==t.closest("table")&&Main.showLoader(t);let a=await FormSubmit.fetchRestApi("events/add_host",s);a&&e(a)}}(l.closest(".add-me-as-host"),l.dataset.date);else if(null!=l.closest(".remove-host-mobile")){o.stopPropagation(),l=l.closest(".remove-host-mobile");let e=l.closest(".session-wrapper-mobile"),t=await async function(e,t){let a,o,l=e.closest(".schedules_div").dataset.target;if(a=e.classList.contains("orientation")?"Are you sure you want to remove this orientation session":e.classList.contains("admin")?`Please confirm host removal for ${l} on ${t}`:`Please confirm you do not want to be the host for ${l} on ${t} anymore`,o=await s(a,e.firstChild),o){let t=new FormData;t.append("session_id",e.dataset.session_id),Main.showLoader(e.firstChild);var n=await FormSubmit.fetchRestApi("events/remove_host",t);Main.displayMessage(n)}return o}(l,l.dataset.date);t&&e.remove()}else if("add_host_mobile"==l.name||"add_timeslot"==l.name)o.stopPropagation(),a(l);else if(null!=l.closest(".edit-session-mobile")){l=l.closest(".edit-session-mobile"),l.closest(".day-wrapper-mobile").classList.add("active");let e=await async function(e,s,a){let o={title:"What do you want to do?",text:"Do you want to edit or remove this timeslot?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Edit timeslot",denyButtonText:"Remove timeslot"};null!=document.fullscreenElement&&(o.target=document.fullscreenElement);var l=await Swal.fire(o);if(l.isConfirmed)t(e,s,e.dataset.starttime,e.dataset.endtime),document.querySelector('[name="add_session"]').querySelector('[name="add_timeslot"]').textContent="Update time slot";else if(l.isDenied)return l.isDenied}(l,l.dataset.isodate,l.dataset.date);e&&l.remove()}else"add_host"==l.name&&(o.stopPropagation(),a(l))})),document.addEventListener("change",(function(e){let t=e.target;"starttime"==t.name&&"radio"==t.type&&("12:00"==t.value?(t.closest("form").querySelector(".lunch.select-wrapper").classList.remove("hidden"),t.closest("form").querySelector(".diner.select-wrapper").classList.add("hidden")):(t.closest("form").querySelector(".diner.select-wrapper").classList.remove("hidden"),t.closest("form").querySelector(".lunch.select-wrapper").classList.add("hidden")))}))})();
//# sourceMappingURL=mobile-schedule.min.js.map