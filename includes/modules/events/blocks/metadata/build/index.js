(()=>{"use strict";var e,t={211:()=>{const e=window.wp.blocks,t=window.wp.element,l=window.wp.i18n,a=(window.wp.apiFetch,window.wp.data),n=window.wp.coreData,r=window.wp.components,i=window.wp.blockEditor,o=JSON.parse('{"u2":"sim/eventmeta"}');(0,e.registerBlockType)(o.u2,{icon:"calendar",edit:e=>{let{setAttributes:o,attributes:s}=e;const c=(0,i.useBlockProps)(),u=(0,a.useSelect)((e=>e("core/editor").getCurrentPostType()),[]),[m,d]=(0,n.useEntityProp)("postType",u,"meta"),[p,_]=(0,t.useState)("");(0,t.useEffect)((()=>{if(""!=m.eventdetails&&null!=m.eventdetails){let e=JSON.parse(m.eventdetails);null==e.repeat&&(e.repeat={interval:1}),null==e.starttime&&(e.starttime="00:00"),_(e),e.organizer&&f(e.organizer),e.location&&f(e.location)}}),[m]);const E=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a={...p};if("startdate"==e)a.startdate=t.split("T")[0],(null==a.enddate||a.enddate<a.startdate)&&(a.enddate=t.split("T")[0]);else if("enddate"==e)a.enddate=t.split("T")[0];else if("starttime"==e){let e=t.split("T")[1];e=e.split(":"),a.starttime=e[0]+":"+e[1]}else if("endtime"==e){let e=t.split("T")[1];e=e.split(":"),a.endtime=e[0]+":"+e[1]}else if(e.startsWith("repeat")){null==a.repeat&&(a.repeat={});let n=e.split("-")[1];if("excludedates"==n||"includedates"==n){null==a.repeat[n]&&(a.repeat[n]=[]);let e=t.split("T")[0],l="added";a.repeat[n].includes(e)?(a.repeat[n]=a.repeat[n].filter((t=>t!=e)),l="removed"):a.repeat[n].push(e),wp.data.dispatch("core/notices").createNotice("success",`Succesfully ${l} the date`,{type:"snackbar",isDismissible:!0})}else"weeks"==n||"months"==n?(null==a.repeat[n]&&(a.repeat[n]=[]),a.repeat[n].includes(l)?a.repeat[n]=a.repeat[n].filter((e=>e!=l)):a.repeat[n].push(l)):a.repeat[n]=t}else a[e]=t;"organizer_id"==e?(v(l),a.organizer=l):"location_id"==e&&(f(l),a.location=l),a=JSON.stringify(a),d({...m,eventdetails:a})},[h,v]=(0,t.useState)(p.organizer),[g,f]=(0,t.useState)(p.location),{users:y,userResolved:b}=(0,a.useSelect)((e=>{if(!h)return{users:[],userResolved:!0};const t={search:h,per_page:100,context:"view"};return{users:e(n.store).getUsers(t),userResolved:e(n.store).hasFinishedResolution("getUsers",[t])}}),[h]),{locations:x,locationResolved:R}=(0,a.useSelect)((e=>{if(!g)return{locations:[],locationResolved:!0};const t=["postType","location",{search:g,per_page:100,context:"view",orderby:"relevance"}];return{locations:e(n.store).getEntityRecords(...t),locationResolved:e(n.store).hasFinishedResolution("getEntityRecords",t)}}),[g]),w=()=>null==p.repeat.excludedates?"":p.repeat.excludedates.map(((e,l)=>(0,t.createElement)(r.DatePicker,{currentDate:p.repeat.excludedates[l],value:e,onChange:e=>{E("repeat-excludedates",e,l)}}))),C=()=>"daily"!=p.repeat.type?"":(0,t.createElement)(t.Fragment,null,(0,l.__)("Repeat interval in days"),(0,t.createElement)(r.__experimentalNumberControl,{onChange:e=>E("repeat-interval",e),value:p.repeat.interval}),(0,t.createElement)("br",null)),k=()=>{if("weekly"!=p.repeat.type)return"";null==p.repeat.weeks&&(p.repeat.weeks=[]);let e=["First","Second","Third","Fourth","Fifth","All"].map((e=>(0,t.createElement)(r.CheckboxControl,{label:(0,l.__)(e),checked:p.repeat.weeks.includes(e),onChange:t=>E("repeat-weeks",t,e)})));return(0,t.createElement)(t.Fragment,null,(0,l.__)("Repeat interval in weeks"),(0,t.createElement)(r.__experimentalNumberControl,{onChange:e=>E("repeat-interval",e),value:p.repeat.interval}),(0,t.createElement)("br",null),(0,l.__)("Select weeks(s) of the month this event should be repeated on"),(0,t.createElement)("br",null),(0,t.createElement)("div",{class:"flex week-selector"},e),(0,t.createElement)("br",null))},S=()=>{if("monthly"!=p.repeat.type)return"";null==p.repeat.months&&(p.repeat.months=[]);let e=new Date(p.startdate),a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()],n=parseInt(e.getDate()/7);console.log(n);let i=["first","second","third","fourth","fifth"][n];return(0,t.createElement)(t.Fragment,null,(0,l.__)("Select repeat type"),(0,t.createElement)("br",null),(0,t.createElement)(r.__experimentalRadioGroup,{label:"Width",onChange:e=>E("repeat-datetype",e),checked:p.repeat.datetype},(0,t.createElement)(r.__experimentalRadio,{value:"samedate"},(0,l.__)("On the same day")),(0,t.createElement)(r.__experimentalRadio,{value:"patterned"},(0,l.__)(`On the ${i} ${a} of the month`)),(0,t.createElement)(r.__experimentalRadio,{value:"last"},(0,l.__)(`On the last ${a} of the month`)),(0,t.createElement)(r.__experimentalRadio,{value:"lastday"},(0,l.__)("On the last day of the month"))),(0,t.createElement)("br",null),(0,t.createElement)("br",null),(0,t.createElement)(F,null))},F=()=>{if(null==p.repeat.datetype)return"";if("samedate"==p.repeat.datetype)return(0,t.createElement)(t.Fragment,null,(0,l.__)("Repeat interval in months"),(0,t.createElement)(r.__experimentalNumberControl,{onChange:e=>E("repeat-interval",e),value:p.repeat.interval}),(0,t.createElement)("br",null));let e=["All","January","February","March","April","May","June","July","August","September","October","November","December"].map((e=>(0,t.createElement)(r.CheckboxControl,{label:(0,l.__)(e),checked:p.repeat.months.includes(e),onChange:t=>E("repeat-months",t,e)}))),a=e.splice(0,1),n=e.splice(0,6);return(0,t.createElement)(t.Fragment,null,(0,l.__)("Select month(s) this event should be repeated"),(0,t.createElement)("br",null),(0,t.createElement)("div",{class:"flex month-selector"},a),(0,t.createElement)("div",{class:"flex month-selector"},n),(0,t.createElement)("div",{class:"flex month-selector"},e),(0,t.createElement)("br",null))},D=()=>{if("custom_days"!=p.repeat.type)return"";let e=(0,t.createElement)(r.DatePicker,{currentDate:null,onChange:e=>{E("repeat-includedates",e)}});return null==p.repeat.includedates?e:(0,t.createElement)(t.Fragment,null,p.repeat.includedates.map(((e,l)=>(0,t.createElement)(r.DatePicker,{currentDate:p.repeat.includedates[l],value:e,onChange:e=>{E("repeat-includedates",e,l)}}))),e,";")};return(0,t.createElement)("div",c,(0,t.createElement)("h2",null,(0,l.__)("Event Details")),(0,t.createElement)("div",{class:"date-pickers flex"},(0,t.createElement)("div",null,(0,t.createElement)("span",{class:"center"},(0,l.__)("Start date","sim")),(0,t.createElement)(r.DatePicker,{currentDate:p.startdate?p.startdate:null,onChange:e=>E("startdate",e),__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0})),(0,t.createElement)("div",null,(0,t.createElement)("span",{class:"center"},(0,l.__)("End date","sim")),(0,t.createElement)(r.DatePicker,{currentDate:p.enddate?p.enddate:null,onChange:e=>E("enddate",e),__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0}))),(0,t.createElement)((()=>null==p.startdate?"":(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{class:"time-pickers flex"},(0,t.createElement)((()=>{if(p.allday)return"";let e=null==p.starttime?"00:00:00":p.starttime,a=null==p.endtime?"00:00:00":p.endtime;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",null,(0,t.createElement)("span",{class:"center"},(0,l.__)("Start time","sim")),(0,t.createElement)(r.TimePicker,{currentTime:"1986-10-18T"+e,onChange:e=>E("starttime",e),__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0})),(0,t.createElement)("div",null,(0,t.createElement)("span",{class:"center"},(0,l.__)("End time","sim")),(0,t.createElement)(r.TimePicker,{currentTime:"1986-10-18T"+a,onChange:e=>E("endtime",e),__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0})))}),null),(0,t.createElement)(r.CheckboxControl,{label:(0,l.__)("This is an all day event"),onChange:e=>E("allday",e),checked:p.allday})))),null),null==p.endtime&&(null==p.allday||!p.allday)||p.enddate==p.startdate&&p.endtime<=p.starttime&&(null==p.allday||!p.allday)?"":(0,t.createElement)(t.Fragment,null,(0,t.createElement)("i",null,(0,l.__)("Use searchbox below to search for a location","sim")),(0,t.createElement)(r.SearchControl,{onChange:f,value:g}),(0,t.createElement)((function(){if(!R)return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(r.Spinner,null),(0,t.createElement)("br",null));if(""==g||null==g)return"";if(null==x||!x.length)return(0,t.createElement)("div",null," ",(0,l.__)("No location found","sim"));let e=x.map((e=>({label:e.title.rendered,value:e.id})));return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(r.RadioControl,{selected:parseInt(p.location_id),options:e,onChange:t=>E("location_id",t,e.filter((e=>t==e.value))[0].label)}))}),null),(0,t.createElement)("br",null),(0,t.createElement)("i",null,(0,l.__)("Use searchbox below to search for an user to add as organizer","sim")),(0,t.createElement)(r.SearchControl,{onChange:v,value:h}),(0,t.createElement)((function(){if(!b)return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(r.Spinner,null),(0,t.createElement)("br",null));if(""==h||null==h)return"";if(null==y||!y.length)return(0,t.createElement)("div",null," ",(0,l.__)("No user found","sim"));let e=y.map((e=>({label:e.name,value:e.id})));return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(r.RadioControl,{selected:parseInt(p.organizer_id),options:e,onChange:t=>E("organizer_id",t,e.filter((e=>t==e.value))[0].label)}))}),null),(0,t.createElement)("br",null),(0,t.createElement)(r.Button,{variant:"primary",className:"repeat-button",onClick:e=>E("isrepeated",!p.isrepeated)},"Repeat this event"),(0,t.createElement)("br",null),null!=p.isrepeated&&p.isrepeated?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("br",null),(0,t.createElement)("div",{id:"event-repeat-details"},(0,l.__)("Select repetition type"),(0,t.createElement)("br",null),(0,t.createElement)(r.__experimentalRadioGroup,{label:"Width",onChange:e=>E("repeat-type",e),checked:p.repeat.type},(0,t.createElement)(r.__experimentalRadio,{value:"daily"},"Daily"),(0,t.createElement)(r.__experimentalRadio,{value:"weekly"},"Weekly"),(0,t.createElement)(r.__experimentalRadio,{value:"monthly"},"Monthly"),(0,t.createElement)(r.__experimentalRadio,{value:"yearly"},"Yearly"),(0,t.createElement)(r.__experimentalRadio,{value:"custom_days"},"Custom Days")),(0,t.createElement)("br",null),(0,t.createElement)("br",null),(0,t.createElement)(C,null),(0,t.createElement)(k,null),(0,t.createElement)(S,null),(0,t.createElement)(D,null),(0,l.__)("Stop repetition"),(0,t.createElement)(r.RadioControl,{selected:p.repeat.stop,options:[{label:"Never",value:"never"},{label:"On this date",value:"date"},{label:"After this amount of repeats",value:"after"}],onChange:e=>E("repeat-stop",e)}),null==p.repeat.stop||"never"==p.repeat.stop?"":"date"==p.repeat.stop?(0,t.createElement)(t.Fragment,null,(0,l.__)("Last date"),(0,t.createElement)(r.DatePicker,{currentDate:p.repeat.enddate,onChange:e=>E("repeat-enddate",e),__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0})):(0,t.createElement)(t.Fragment,null,(0,l.__)("Maximum occurences"),(0,t.createElement)(r.__experimentalNumberControl,{onChange:e=>E("repeat-amount",e),value:p.repeat.amount}),(0,t.createElement)("br",null)),(0,t.createElement)("br",null),(0,l.__)("Exclude dates, click to select or deselect"),(0,t.createElement)(w,null),(0,t.createElement)(r.DatePicker,{currentDate:null,onChange:e=>E("repeat-excludedates",e,0),__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0}))):""))},save:()=>null})}},l={};function a(e){var n=l[e];if(void 0!==n)return n.exports;var r=l[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,l,n,r)=>{if(!l){var i=1/0;for(u=0;u<e.length;u++){l=e[u][0],n=e[u][1],r=e[u][2];for(var o=!0,s=0;s<l.length;s++)(!1&r||i>=r)&&Object.keys(a.O).every((e=>a.O[e](l[s])))?l.splice(s--,1):(o=!1,r<i&&(i=r));if(o){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[l,n,r]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={826:0,431:0};a.O.j=t=>0===e[t];var t=(t,l)=>{var n,r,i=l[0],o=l[1],s=l[2],c=0;if(i.some((t=>0!==e[t]))){for(n in o)a.o(o,n)&&(a.m[n]=o[n]);if(s)var u=s(a)}for(t&&t(l);c<i.length;c++)r=i[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},l=self.webpackChunksim_pendingpages=self.webpackChunksim_pendingpages||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var n=a.O(void 0,[431],(()=>a(211)));n=a.O(n)})();