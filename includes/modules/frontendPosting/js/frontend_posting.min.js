(()=>{"use strict";let e,t=function(){tinymce.remove(),document.querySelectorAll(".entry-content .wp-editor-area").forEach((e=>{window.tinyMCE.execCommand("mceAddEditor",!1,e.id)})),window.document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!0,cancelable:!0})),document.querySelectorAll(".wp-switch-editor").forEach((e=>e.addEventListener("click",(t=>{let o=e.closest(".wp-editor-wrap").querySelector(".wp-editor-area"),a=e.closest(".wp-editor-wrap").querySelector(".mce-panel");o.style.visibility="unset",t.target.matches(".switch-tmce")?(a.style.display="block",o.style.display="none"):(a.style.display="none",o.style.display="block")})))),document.querySelectorAll("select:not(.nonice,.swal2-select)").forEach((function(e){null==e._niceselect&&(e._niceselect=NiceSelect.bind(e,{searchable:!0}))}))},o=function(){let a=e.shift();if(null==document.getElementById(a.id)&&"SCRIPT"==a.tagName){var n=document.createElement("script");""==a.type?n.type="text/javascript":n.type=a.type,""!=a.src?n.src=a.src:n.innerHTML=a.innerHTML,n.id=a.id,document.head.appendChild(n),e.length>0?""!=a.src?n.addEventListener("load",o):o():""!=a.src?n.addEventListener("load",t):t()}else e.length>0?o():t()};function a(){let e=!1;var t;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e}async function n(){var e=document.querySelector('[name="post_id"]');if(null!=e&&""!=e.value){var t=new FormData;t.append("postid",e.value),FormSubmit.fetchRestApi("frontend_posting/refresh_post_lock",t)}}function l(e){var t,o=document.getElementById("frontend_upload_form");t=null==e?location.search.replace("?type=",""):e.value,document.querySelector('#postform [name="post_type"]').value=t,o.querySelectorAll(".replaceposttype").forEach((function(e){e.textContent=t})),null!=tinymce.activeEditor&&""!=tinymce.activeEditor.getContent()||(o.querySelectorAll(".lite").forEach((function(e){e.classList.remove("hidden")})),o.querySelector("#showallfields").classList.add("hidden")),o.querySelectorAll("#wp-post_content-media-buttons, .advancedpublishoptions, #advancedpublishoptionsbutton").forEach((e=>e.classList.remove("hidden"))),o.querySelectorAll(`.property.${t}`).forEach((e=>e.classList.remove("hidden"))),o.querySelectorAll(`.property:not(.${t})`).forEach((e=>e.classList.add("hidden"))),"attachment"==t&&(o.querySelector('[name="signal_url"]').checked=!0)}async function r(t){let a=await FormSubmit.submitForm(t,"frontend_posting/submit_post");if(a){if(!a.html||!a.js)return Main.displayMessage(a.message),void(location.href=a.url);const t=new URL(a.url);window.history.pushState({},"",t);let n=document.getElementById("page-title-image");a.picture&&(null==n&&(n=document.createElement("div"),n.id="page-title-image"),n.style.backgroundImage=`url("${a.picture}")`),document.querySelector("main").innerHTML=a.html,function(t){let a=document.createElement("div");t.js&&(a.innerHTML=t.js,e=[...a.children],o()),t.css&&(a.innerHTML=t.css,[...a.children].forEach((e=>{document.head.appendChild(e)})))}(a),window.scrollTo(0,0),console.log("scrolling"),document.getElementById("page-edit").classList.remove("hidden"),Main.displayMessage(a.message)}}function i(){setTimeout((function(){null!=wp.media.frame?wp.media.frame.on("insert",(function(){let e=wp.media.frame.state().get("selection").first().toJSON();if([".txt",".doc",".rtf"].some((t=>e.url.includes(t)))){let t={title:"Question",text:"Do you want to insert the contents of this file into the post?",icon:"question",showCancelButton:!0,confirmButtonColor:"#bd2919",cancelButtonColor:"#d33",confirmButtonText:"Yes please",cancelButtonText:"No thanks",hideClass:{popup:""}};null!=document.fullscreenElement&&(t.target=document.fullscreenElement),Swal.fire(t).then((t=>{if(t.isConfirmed){let t={title:"Please wait...",html:"<IMG src='"+sim.loadingGif+"' width=100 height=100>",showConfirmButton:!1,showClass:{backdrop:"swal2-noanimation",popup:"",icon:""}};null!=document.fullscreenElement&&(t.target=document.fullscreenElement),Swal.fire(t),async function(e){let t=new FormData;t.append("attachment_id",e);let o=await FormSubmit.fetchRestApi("frontend_posting/get_attachment_contents",t);if(o){let e=tinyMCE.activeEditor.getContent();tinymce.activeEditor.setContent(e+o),Swal.close()}}(e.id)}}))}})):i()}),100)}console.log("Location.js loaded"),document.addEventListener("DOMContentLoaded",(function(){!function(){if(null==document.getElementById("googlemaps")&&"object"==typeof mapsApi){const e=document.createElement("script");e.id="googlemaps",e.src="//maps.googleapis.com/maps/api/js?key="+mapsApi.key,e.async=!0,document.body.append(e)}}();let e=document.querySelector(".latitude");void 0!==e&&null!=e&&e.addEventListener("keydown",o),e=document.querySelector(".longitude"),void 0!==e&&null!=e&&e.addEventListener("keydown",o);var t=null;function o(){clearTimeout(t),t=setTimeout(n,1e3)}function n(){var e=document.querySelector(".latitude").value,t=document.querySelector(".longitude").value,o=new google.maps.Geocoder;if(""!=e&&""!=t){var a={lat:parseFloat(e),lng:parseFloat(t)};o.geocode({location:a},(function(e,t){"OK"===t&&e[0]&&document.querySelectorAll(".address").forEach((function(t){""==t.value&&(t.value=e[0].formatted_address)}))}))}}function l(e){var t=new google.maps.Geocoder,o=e.target.value;t.geocode({address:o},(function(e,t){"OK"===t&&(document.querySelectorAll(".latitude").forEach((function(t){t.value=e[0].geometry.location.lat().toFixed(7)})),document.querySelectorAll(".longitude").forEach((function(t){t.value=e[0].geometry.location.lng().toFixed(7)})))}))}t=null,e=document.querySelector(".address"),void 0!==e&&null!=e&&e.addEventListener("keydown",(function(e){clearTimeout(t),t=setTimeout(l,1e3,e)}));let r=document.querySelector(".current-location");function i(e){var t=e.coords.latitude.toFixed(7),o=e.coords.longitude.toFixed(7);document.querySelectorAll(".latitude").forEach((function(e){e.value=t})),document.querySelectorAll(".longitude").forEach((function(e){e.value=o})),n()}null!=r&&(console.log(a()),a()&&navigator.geolocation?r.addEventListener("click",(e=>navigator.geolocation.getCurrentPosition(i))):r.classList.add("hide"))})),document.addEventListener("DOMContentLoaded",(function(){console.log("Frontendposting.js loaded");let e=document.getElementById("minutes");null!=e&&setInterval((function(){e.innerHTML=parseInt(e.innerHTML)+1}),6e4),n(),setInterval(n,6e4),window.onbeforeunload=function(){null==document.getElementById("post_lock_warning")&&async function(){var e=document.querySelector('[name="post_id"]');if(null!=e&&""!=e.value){var t=new FormData;t.append("postid",e.value),await FormSubmit.fetchRestApi("frontend_posting/delete_post_lock",t)}}()},(location.search.includes("?type")||location.search.includes("?post_id"))&&l(document.querySelector('#postform [name="post_type"]')),i()})),document.addEventListener("click",(e=>{let t=e.target;if("submit_post"==t.name||null!=t.parentNode&&"submit_post"==t.parentNode.name)r(t);else if("draft_post"==t.name||null!=t.parentNode&&"draft_post"==t.parentNode.name)t.closest("form").querySelector('[name="post_status"]').value="draft",r(t);else if("delete_post"==t.name)!async function(e){e.preventDefault(),parent=e.target.closest("#frontend_upload_form");let t={title:"Are you sure?",text:`Are you sure you want to remove this ${document.querySelector('[name="post_type"]').value}}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"};if(null!=document.fullscreenElement&&(t.target=document.fullscreenElement),(await Swal.fire(t)).isConfirmed){var o=parent.querySelector('[name="post_id"]').value;e.target.closest("form").querySelector(".loadergif").classList.remove("hidden");var a=new FormData;a.append("post_id",o);var n=await FormSubmit.fetchRestApi("frontend_posting/remove_post",a);n&&Main.displayMessage(n)}}(e);else if("change_post_type"==t.name)!async function(e){var t=await FormSubmit.submitForm(e,"frontend_posting/change_post_type");t&&Main.displayMessage(t)}(t);else if("add-featured-image"==t.name)!function(e){e.preventDefault();var t=e.target.closest("#frontend_upload_form");let o=wp.media.frames.file_frame=wp.media({title:"Select featured image",button:{text:"Save featured image"},multiple:!1});o.on("select",(function(){var e=o.state().get("selection").first().toJSON();t.querySelector('[name="post_image_id"]').value=e.id,document.getElementById("featured-image-div").classList.remove("hidden");var a=document.getElementById("featured_image_wrapper");null!=a.querySelector("img")&&a.querySelector("img").remove(),a.insertAdjacentHTML("beforeEnd",'<img width="150" height="150" src="'+e.url+'">'),t.querySelectorAll('[name="add-featured-image"]').forEach((function(e){e.innerHTML=e.innerHTML.replace("Add","Replace")}))})),o.open()}(e);else if("showallfields"==t.id)!function(e){var t=e.closest("#frontend_upload_form");t.querySelector("#showallfields").classList.contains("show")?(t.querySelectorAll(".lite").forEach((function(e){e.classList.remove("hidden")})),e.classList.remove("show"),e.classList.add("hide"),e.textContent="Only show required fields"):(t.querySelectorAll(".lite").forEach((function(e){e.classList.add("hidden")})),e.classList.add("show"),e.classList.remove("hide"),e.textContent="Show all fields")}(t);else if("advancedpublishoptionsbutton"==t.id){let e=t.closest("form").querySelector(".advancedpublishoptions");e.classList.contains("hidden")?(e.classList.remove("hidden"),t.querySelector("span").textContent="Hide"):(e.classList.add("hidden"),t.querySelector("span").textContent="Show")}else if("signal"==t.name){let e=t.closest("#signalmessage").querySelector(".signalmessagetype");t.checked?e.classList.remove("hidden"):e.classList.add("hidden")}else if("enable_event_repeat"==t.name){document.querySelector(".repeat_wrapper").classList.toggle("hidden");let e=t.parentNode.querySelector('[name="event[isrepeated]"]');"yes"==e.value?e.value="":e.value="yes"}else"event[repeat][repeat_type]"==t.name&&(t.closest(".event").querySelectorAll(".repeat_type_option").forEach((e=>{e.querySelector(".repeat_type_option_specifics").classList.add("hidden")})),t.closest(".repeat_type_option").querySelector(".repeat_type_option_specifics").classList.remove("hidden"));if(t.classList.contains("selectall")&&t.closest(".selector_wrapper").querySelectorAll('input[type="checkbox"]').forEach((e=>e.checked=t.checked)),t.matches(".remove_featured_image")){document.querySelector('[name="post_image_id"]').value=0;let e=document.getElementById("featured-image-div");e.classList.add("hidden"),e.querySelector("img").remove(),document.querySelector('[name="add-featured-image"]').textContent="Add featured image"}t.classList.contains("add_cat")&&document.getElementById("add_"+t.dataset.type+"_type").classList.remove("hidden"),null!=t.closest(".repeat_type_option")&&(document.querySelectorAll(".repeat_type_option_specifics:not(.hidden)").forEach((e=>e.classList.add("hidden"))),t.closest(".repeat_type_option").querySelector(".repeat_type_option_specifics").classList.remove("hidden")),t.matches(".add_category .form_submit")&&async function(e){let t,o,a=await FormSubmit.submitForm(e,"frontend_posting/add_category");if(a){let n=e.closest("form").querySelector('[name="cat_parent"]').value,l=e.closest("form").querySelector('[name="post_type"]').value,r=e.closest("form").querySelector('[name="cat_name"]').value;if(""==n)t=document.getElementById(l+"_parenttypes"),o="";else{t=document.getElementById(l+"_childtypes"),o=`data-parent="${n}"`;let e=document.querySelector(`.${l}type[value="${n}"]`);e.checked||e.click()}let i=`\n\t\t<div class="infobox" ${o}>\n\t\t\t<input type="checkbox" class="${l}type" id="${l}type[]" value="${a.id}" checked>\n\t\t\t<label class="option-label category-select">${r}</label>\n\t\t</div>\n\t\t`;t.insertAdjacentHTML("afterBegin",i),Main.hideModals(),Main.displayMessage(`Succesfully added the ${r} category`)}}(t),t.matches("button.show-diff")&&t.parentNode.querySelector(".post-diff-wrapper").classList.toggle("hidden")})),document.addEventListener("change",(e=>{let t=e.target;if("post_type_selector"==t.id?l(t):"event[allday]"==t.name?function(e){let t=e.closest(".event").querySelector('[name="event[starttime]"]'),o=e.closest(".event").querySelector('[name="event[endtime]"]'),a=e.closest(".event").querySelector('[name="enddate_label"]');e.checked?(t.classList.add("hidden"),o.classList.add("hidden"),a.classList.add("hidden"),t.value="00:00",o.value="23:59"):(t.classList.remove("hidden"),o.classList.remove("hidden"),a.classList.remove("hidden"),t.value="",o.value="")}(t):"event[startdate]"==t.name?function(e){let t=e.closest(".event").querySelector('[name="event[enddate]"]'),o=new Date(e.value),a=new Date(t.value);(""==t.value||o>a)&&(t.value=e.value);let n=new Date(o.getFullYear(),o.getMonth(),1).getDay(),l=o.getDate()+n-1,r=Math.floor(l/7);document.querySelectorAll('.weeks [name="event[repeat][weeks][]"]')[r].checked=!0}(t):"event[repeat][type]"==t.name&&function(e){let t=e.closest(".repeat_wrapper");t.querySelectorAll(".hide").forEach((e=>e.classList.replace("hide","hidden")));let o=new Date(document.querySelector('[name="event[startdate]"]').value),a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][o.getDay()],n=parseInt(o.getDate()/7);console.log(n);let l=["first","second","third","fourth","fifth"][n];switch(t.querySelectorAll(".dayname").forEach((e=>e.textContent=a)),t.querySelectorAll(".weekword").forEach((e=>e.textContent=l)),e.value){case"daily":t.querySelectorAll(".repeatinterval, .days, .days h4.checkbox, .pattern-wrapper, .days .selectall_wrapper, .daily").forEach((e=>e.classList.replace("hidden","hide"))),t.querySelector("#repeattype").textContent="days";break;case"weekly":t.querySelectorAll(".repeatinterval, .weeks, .weeks h4.checkbox, .weeks .selectall_wrapper, .pattern-wrapper, .weekly").forEach((e=>e.classList.replace("hidden","hide"))),t.querySelector("#repeattype").textContent="week(s)",t.querySelectorAll('.weeks input[type="radio"]').forEach((e=>e.type="checkbox"));break;case"monthly":t.querySelectorAll(".repeatdatetype, .pattern-wrapper, .monthly, .months").forEach((e=>e.classList.replace("hidden","hide"))),t.querySelector("#repeattype").textContent="month(s)";break;case"yearly":break;case"custom_days":t.querySelectorAll(".custom_dates_selector").forEach((e=>e.classList.replace("hidden","hide")))}}(t),null!=t.list){let e=t.list.querySelector(`[value='${t.value}' i]`);if(null!=e){let o=e.dataset.value,a=t.parentNode.querySelector(".datalistvalue");null!=a&&(a.value=o)}}t.classList.contains("parent_cat")&&function(e){var t=e.closest(".infobox").dataset.parent,o=e.closest(".categories");e.checked?o.querySelectorAll("[data-parent='"+e.value+"']").forEach((e=>{e.classList.remove("hidden"),o.querySelector("#subcategorylabel").classList.remove("hidden")})):null==t&&null==o.querySelector('.childtypes input[type="checkbox"]:checked')&&(o.querySelector("#subcategorylabel").classList.add("hidden"),o.querySelectorAll("[data-parent='"+e.value+"']").forEach((e=>{e.classList.add("hidden")})))}(t),"mailchimp_segment_id"==t.name&&(""==t.value?document.querySelectorAll(".mailchimp-wrapper").forEach((e=>e.classList.add("hidden"))):document.querySelectorAll(".mailchimp-wrapper").forEach((e=>e.classList.remove("hidden"))))}))})();
//# sourceMappingURL=frontend_posting.min.js.map