(()=>{var e={968:()=>{console.log("Location.js loaded"),document.addEventListener("DOMContentLoaded",(function(){!function(){if(null==document.getElementById("googlemaps")&&"object"==typeof mapsApi){const e=document.createElement("script");e.id="googlemaps",e.src=`//maps.googleapis.com/maps/api/js?key=${mapsApi.key}&callback=initMap`,e.async=!0,document.body.append(e)}}();let e=document.querySelector(".latitude");void 0!==e&&null!=e&&e.addEventListener("keydown",n),e=document.querySelector(".longitude"),void 0!==e&&null!=e&&e.addEventListener("keydown",n);var t=null;function n(){clearTimeout(t),t=setTimeout(o,1e3)}function o(){var e=document.querySelector(".latitude").value,t=document.querySelector(".longitude").value,n=new google.maps.Geocoder;if(""!=e&&""!=t){var o={lat:parseFloat(e),lng:parseFloat(t)};n.geocode({location:o},(function(e,t){"OK"===t&&e[0]&&document.querySelectorAll(".address").forEach((function(t){""==t.value&&(t.value=e[0].formatted_address)}))}))}}function l(e){var t=new google.maps.Geocoder,n=e.target.value;t.geocode({address:n},(function(e,t){"OK"===t&&(document.querySelectorAll(".latitude").forEach((function(t){t.value=e[0].geometry.location.lat().toFixed(7)})),document.querySelectorAll(".longitude").forEach((function(t){t.value=e[0].geometry.location.lng().toFixed(7)})))}))}t=null,e=document.querySelector(".address"),void 0!==e&&null!=e&&e.addEventListener("keydown",(function(e){clearTimeout(t),t=setTimeout(l,1e3,e)}));let a=document.querySelector(".current-location");function r(e){var t=e.coords.latitude.toFixed(7),n=e.coords.longitude.toFixed(7);document.querySelectorAll(".latitude").forEach((function(e){e.value=t})),document.querySelectorAll(".longitude").forEach((function(e){e.value=n})),o()}null!=a&&(Main.isMobileDevice()&&navigator.geolocation?a.addEventListener("click",(e=>navigator.geolocation.getCurrentPosition(r))):a.classList.add("hide"))}))}},t={};function n(o){var l=t[o];if(void 0!==l)return l.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}(()=>{"use strict";n(968);let e,t=function(e){"undefined"!=typeof tinymce&&tinymce.remove(),document.querySelectorAll(".entry-content .wp-editor-area").forEach((e=>{window.tinyMCE.execCommand("mceAddEditor",!1,e.id)})),window.document.dispatchEvent(new Event("DOMContentLoaded",{bubbles:!0,cancelable:!0})),document.querySelectorAll(".wp-switch-editor").forEach((e=>e.addEventListener("click",(t=>{let n=e.closest(".wp-editor-wrap").querySelector(".wp-editor-area"),o=e.closest(".wp-editor-wrap").querySelector(".mce-panel");n.style.visibility="unset",t.target.matches(".switch-tmce")?(o.style.display="block",n.style.display="none"):(o.style.display="none",n.style.display="block")})))),document.querySelectorAll("select:not(.nonice,.swal2-select)").forEach((function(e){null==e._niceselect&&(e._niceselect=NiceSelect.bind(e,{searchable:!0}))}));const t=new Event("scriptsloaded");e.dispatchEvent(t)},o=function(n){if(null==n)return;0==e.length&&t(n);let l=e.shift();if(null==document.getElementById(l.id)&&"SCRIPT"==l.tagName){var a=document.createElement("script");""==l.type?a.type="text/javascript":a.type=l.type,""!=l.src?a.src=l.src:a.innerHTML=l.innerHTML,a.id=l.id,document.head.appendChild(a),e.length>0?""!=l.src?a.addEventListener("load",o.bind(null,n)):o(n):""!=l.src?a.addEventListener("load",t.bind(null,n)):t(n)}else e.length>0?o(n):t(n)};async function l(e,t="delete"){let n,o=e.target;e.preventDefault(),parent=o.closest("#frontend_upload_form");let l={title:"Are you sure?",text:`Are you sure you want to ${t} this ${document.querySelector('[name="post_type"]').value}}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:`Yes, ${t} it!`};if(null!=document.fullscreenElement&&(l.target=document.fullscreenElement),(await Swal.fire(l)).isConfirmed){let e=o.dataset.post_id;o.closest("div").querySelector(".loadergif").classList.remove("hidden");var a=new FormData;a.append("post_id",e),n="delete"==t?"frontend_posting/remove_post":"frontend_posting/archive_post";var r=await FormSubmit.fetchRestApi(n,a);r&&Main.displayMessage(r)}}async function a(){var e=document.querySelector('[name="post_id"]');if(null!=e&&""!=e.value){var t=new FormData;t.append("postid",e.value),FormSubmit.fetchRestApi("frontend_posting/refresh_post_lock",t)}}function r(e){var t,n=document.getElementById("frontend_upload_form");t=null==e?location.search.replace("?type=",""):e.value,document.querySelector('#postform [name="post_type"]').value=t,n.querySelectorAll(".replaceposttype").forEach((function(e){e.textContent=t})),null!=tinymce.activeEditor&&""!=tinymce.activeEditor.getContent()||(n.querySelectorAll(".lite").forEach((function(e){e.classList.remove("hidden")})),n.querySelector("#showallfields").classList.add("hidden")),n.querySelectorAll("#wp-post_content-media-buttons, .advancedpublishoptions, #advancedpublishoptionsbutton").forEach((e=>e.classList.remove("hidden"))),n.querySelectorAll(`.property.${t}`).forEach((e=>e.classList.remove("hidden"))),n.querySelectorAll(`.property:not(.${t})`).forEach((e=>e.classList.add("hidden"))),"attachment"==t&&(n.querySelector('[name="signal_url"]').checked=!0)}async function s(t){let n=await FormSubmit.submitForm(t,"frontend_posting/submit_post");if(n){if(!n.html||!n.js)return Main.displayMessage(n.message),void(location.href=n.url);const t=new URL(n.url);window.history.pushState({},"",t);let l=document.getElementById("page-title-image");n.picture&&(null==l&&(l=document.createElement("div"),l.id="page-title-image"),l.style.backgroundImage=`url("${n.picture}")`),document.querySelector("main").innerHTML=n.html,function(t,n){let l=document.createElement("div");t.js&&(l.innerHTML=t.js,e=[...l.children],o(n)),t.css&&(l.innerHTML=t.css,[...l.children].forEach((e=>{document.head.appendChild(e)})))}(n,document),window.scrollTo(0,0),console.log("scrolling"),document.getElementById("page-edit").classList.remove("hidden"),Main.displayMessage(n.message)}}function c(){setTimeout((function(){null!=wp.media.frame?wp.media.frame.on("insert",(function(){let e=wp.media.frame.state().get("selection").first().toJSON();if([".txt",".doc",".rtf"].some((t=>e.url.includes(t)))){let t={title:"Question",text:"Do you want to insert the contents of this file into the post?",icon:"question",showCancelButton:!0,confirmButtonColor:"#bd2919",cancelButtonColor:"#d33",confirmButtonText:"Yes please",cancelButtonText:"No thanks",hideClass:{popup:""}};null!=document.fullscreenElement&&(t.target=document.fullscreenElement),Swal.fire(t).then((t=>{if(t.isConfirmed){let t={title:"Please wait...",html:"<IMG src='"+sim.loadingGif+"' width=100 height=100>",showConfirmButton:!1,showClass:{backdrop:"swal2-noanimation",popup:"",icon:""}};null!=document.fullscreenElement&&(t.target=document.fullscreenElement),Swal.fire(t),async function(e){let t=new FormData;t.append("attachment_id",e);let n=await FormSubmit.fetchRestApi("frontend_posting/get_attachment_contents",t);if(n){let e=tinyMCE.activeEditor.getContent();tinymce.activeEditor.setContent(e+n),Swal.close()}}(e.id)}}))}})):c()}),100)}document.addEventListener("DOMContentLoaded",(function(){console.log("Frontendposting.js loaded");let e=document.getElementById("minutes");null!=e&&setInterval((function(){e.innerHTML=parseInt(e.innerHTML)+1}),6e4),a(),setInterval(a,6e4),window.onbeforeunload=function(){null==document.getElementById("post_lock_warning")&&async function(){var e=document.querySelector('[name="post_id"]');if(null!=e&&""!=e.value){var t=new FormData;t.append("postid",e.value),await FormSubmit.fetchRestApi("frontend_posting/delete_post_lock",t)}}()},(location.search.includes("?type")||location.search.includes("?post_id"))&&r(document.querySelector('#postform [name="post_type"]')),c()})),document.addEventListener("click",(e=>{let t=e.target;if("submit_post"==t.name||null!=t.parentNode&&"submit_post"==t.parentNode.name)s(t);else if("draft_post"==t.name||null!=t.parentNode&&"draft_post"==t.parentNode.name)t.closest("form").querySelector('[name="post_status"]').value="draft",s(t);else if("publish_post"==t.name)t.closest("form").querySelector('[name="post_status"]').value="publish",s(t);else if("delete_post"==t.name)l(e,"delete");else if("archive_post"==t.name)l(e,"archive");else if("change_post_type"==t.name)!async function(e){var t=await FormSubmit.submitForm(e,"frontend_posting/change_post_type");t&&Main.displayMessage(t)}(t);else if("add-featured-image"==t.name)!function(e){e.preventDefault();var t=e.target.closest("#frontend_upload_form");let n=wp.media.frames.file_frame=wp.media({title:"Select featured image",button:{text:"Save featured image"},multiple:!1});n.on("select",(function(){var e=n.state().get("selection").first().toJSON();t.querySelector('[name="post_image_id"]').value=e.id,document.getElementById("featured-image-div").classList.remove("hidden");var o=document.getElementById("featured_image_wrapper");null!=o.querySelector("img")&&o.querySelector("img").remove(),o.insertAdjacentHTML("beforeEnd",'<img width="150" height="150" src="'+e.url+'">'),t.querySelectorAll('[name="add-featured-image"]').forEach((function(e){e.innerHTML=e.innerHTML.replace("Add","Replace")}))})),n.open()}(e);else if("showallfields"==t.id)!function(e){var t=e.closest("#frontend_upload_form");t.querySelector("#showallfields").classList.contains("show")?(t.querySelectorAll(".lite").forEach((function(e){e.classList.remove("hidden")})),e.classList.remove("show"),e.classList.add("hide"),e.textContent="Only show required fields"):(t.querySelectorAll(".lite").forEach((function(e){e.classList.add("hidden")})),e.classList.add("show"),e.classList.remove("hide"),e.textContent="Show all fields")}(t);else if("advancedpublishoptionsbutton"==t.id){let e=t.closest("form").querySelector(".advancedpublishoptions");e.classList.contains("hidden")?(e.classList.remove("hidden"),t.querySelector("span").textContent="Hide"):(e.classList.add("hidden"),t.querySelector("span").textContent="Show")}else if("signal"==t.name){let e=t.closest("#signalmessage").querySelector(".signalmessagetype");t.checked?e.classList.remove("hidden"):e.classList.add("hidden")}else if("enable_event_repeat"==t.name){document.querySelector(".repeat_wrapper").classList.toggle("hidden");let e=t.parentNode.querySelector('[name="event[isrepeated]"]');"yes"==e.value?e.value="":e.value="yes"}else"event[repeat][repeat_type]"==t.name&&(t.closest(".event").querySelectorAll(".repeat_type_option").forEach((e=>{e.querySelector(".repeat_type_option_specifics").classList.add("hidden")})),t.closest(".repeat_type_option").querySelector(".repeat_type_option_specifics").classList.remove("hidden"));if(t.classList.contains("selectall")&&t.closest(".selector_wrapper").querySelectorAll('input[type="checkbox"]').forEach((e=>e.checked=t.checked)),t.matches(".remove_featured_image")){document.querySelector('[name="post_image_id"]').value=0;let e=document.getElementById("featured-image-div");e.classList.add("hidden"),e.querySelector("img").remove(),document.querySelector('[name="add-featured-image"]').textContent="Add featured image"}t.classList.contains("add_cat")&&document.getElementById("add_"+t.dataset.type+"_type").classList.remove("hidden"),null!=t.closest(".repeat_type_option")&&(document.querySelectorAll(".repeat_type_option_specifics:not(.hidden)").forEach((e=>e.classList.add("hidden"))),t.closest(".repeat_type_option").querySelector(".repeat_type_option_specifics").classList.remove("hidden")),t.matches(".add_category .form_submit")&&async function(e){let t,n,o=await FormSubmit.submitForm(e,"frontend_posting/add_category");if(o){let l=e.closest("form").querySelector('[name="cat_parent"]').value,a=e.closest("form").querySelector('[name="post_type"]').value,r=e.closest("form").querySelector('[name="cat_name"]').value;if(""==l)t=document.getElementById(a+"_parenttypes"),n="";else{t=document.getElementById(a+"_childtypes"),n=`data-parent="${l}"`;let e=document.querySelector(`.${a}type[value="${l}"]`);e.checked||e.click()}let s=`\n\t\t<div class="infobox" ${n}>\n\t\t\t<input type="checkbox" class="${a}type" id="${a}type[]" value="${o.id}" checked>\n\t\t\t<label class="option-label category-select">${r}</label>\n\t\t</div>\n\t\t`;t.insertAdjacentHTML("afterBegin",s),Main.hideModals(),Main.displayMessage(`Succesfully added the ${r} category`)}}(t),t.matches("button.show-diff")&&t.parentNode.querySelector(".post-diff-wrapper").classList.toggle("hidden")})),document.addEventListener("change",(e=>{let t=e.target;if("post_type_selector"==t.id?r(t):"event[allday]"==t.name?function(e){let t=e.closest(".event").querySelector('[name="event[starttime]"]'),n=e.closest(".event").querySelector('[name="event[endtime]"]'),o=e.closest(".event").querySelector('[name="enddate_label"]');e.checked?(t.classList.add("hidden"),n.classList.add("hidden"),o.classList.add("hidden"),t.value="00:00",n.value="23:59"):(t.classList.remove("hidden"),n.classList.remove("hidden"),o.classList.remove("hidden"),t.value="",n.value="")}(t):"event[startdate]"==t.name?function(e){let t=e.closest(".event").querySelector('[name="event[enddate]"]'),n=new Date(e.value),o=new Date(t.value);(""==t.value||n>o)&&(t.value=e.value);let l=new Date(n.getFullYear(),n.getMonth(),1).getDay(),a=n.getDate()+l-1,r=Math.floor(a/7);document.querySelectorAll('.weeks [name="event[repeat][weeks][]"]')[r].checked=!0}(t):"event[repeat][type]"==t.name&&function(e){let t=e.closest(".repeat_wrapper");t.querySelectorAll(".hide").forEach((e=>e.classList.replace("hide","hidden")));let n=new Date(document.querySelector('[name="event[startdate]"]').value),o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][n.getDay()],l=parseInt(n.getDate()/7);console.log(l);let a=["first","second","third","fourth","fifth"][l];switch(t.querySelectorAll(".dayname").forEach((e=>e.textContent=o)),t.querySelectorAll(".weekword").forEach((e=>e.textContent=a)),e.value){case"daily":t.querySelectorAll(".repeatinterval, .days, .days h4.checkbox, .pattern-wrapper, .days .selectall_wrapper, .daily").forEach((e=>e.classList.replace("hidden","hide"))),t.querySelector("#repeattype").textContent="days";break;case"weekly":t.querySelectorAll(".repeatinterval, .weeks, .weeks h4.checkbox, .weeks .selectall_wrapper, .pattern-wrapper, .weekly").forEach((e=>e.classList.replace("hidden","hide"))),t.querySelector("#repeattype").textContent="week(s)",t.querySelectorAll('.weeks input[type="radio"]').forEach((e=>e.type="checkbox"));break;case"monthly":t.querySelectorAll(".repeatdatetype, .pattern-wrapper, .monthly, .months").forEach((e=>e.classList.replace("hidden","hide"))),t.querySelector("#repeattype").textContent="month(s)";break;case"yearly":break;case"custom_days":t.querySelectorAll(".custom_dates_selector").forEach((e=>e.classList.replace("hidden","hide")))}}(t),null!=t.list){let e=t.list.querySelector(`[value='${t.value}' i]`);if(null!=e){let n=e.dataset.value,o=t.parentNode.querySelector(".datalistvalue");null!=o&&(o.value=n)}}t.classList.contains("parent_cat")&&function(e){var t=e.closest(".infobox").dataset.parent,n=e.closest(".categories");e.checked?n.querySelectorAll("[data-parent='"+e.value+"']").forEach((e=>{e.classList.remove("hidden"),n.querySelector("#subcategorylabel").classList.remove("hidden")})):null==t&&null==n.querySelector('.childtypes input[type="checkbox"]:checked')&&(n.querySelector("#subcategorylabel").classList.add("hidden"),n.querySelectorAll("[data-parent='"+e.value+"']").forEach((e=>{e.classList.add("hidden")})))}(t),"mailchimp_segment_id"==t.name&&(""==t.value?document.querySelectorAll(".mailchimp-wrapper").forEach((e=>e.classList.add("hidden"))):document.querySelectorAll(".mailchimp-wrapper").forEach((e=>e.classList.remove("hidden"))))}))})()})();
//# sourceMappingURL=frontend_posting.min.js.map