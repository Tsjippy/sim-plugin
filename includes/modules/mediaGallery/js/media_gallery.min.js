(()=>{function e(e){document.querySelectorAll(".large-image:not(.hidden)").forEach((e=>e.classList.add("hidden"))),document.querySelector('.large-image[data-index="'+e+'"]').classList.remove("hidden")}async function t(t,a,n){var l=document.querySelector("#media-amount").value;if(l!=n){var o=[];document.querySelectorAll(".media-type-selector:checked").forEach((e=>o.push(e.value)));var d=new FormData;d.append("amount",l),d.append("page",document.querySelector("#paged").value),d.append("skipAmount",n),d.append("types",o),d.append("startIndex",t+1);var r=await FormSubmit.fetchRestApi("media_gallery/load_more_media",d);if(document.getElementById("medialoaderwrapper").classList.add("hidden"),document.querySelectorAll(".loaderwrapper").forEach((e=>e.outerHTML='<button id="loadmoremedia" type="button" class="button">Load more</button>')),r){document.querySelector(".mediawrapper").insertAdjacentHTML("beforeEnd",r),a&&e(document.querySelector('[data-index="'+t+'"]').nextElementSibling.nextElementSibling.dataset.index);var i=document.querySelectorAll(".large-image");null==i[i.length-1].querySelector(".nextbtn")&&document.getElementById("loadmoremedia").classList.add("hidden")}else Main.displayMessage("All media are loaded","info"),document.getElementById("loadmoremedia").classList.add("hidden")}}async function a(e){var t=document.querySelector("#media-amount").value,a=[];document.querySelectorAll(".media-type-selector:checked").forEach((e=>a.push(e.value)));var n=e.closest(".mediabuttons").querySelector(".searchtext").value,l=new FormData;l.append("amount",t),l.append("types",a),l.append("search",n);var o=await FormSubmit.fetchRestApi("media_gallery/media_search",l);o?document.querySelector(".mediawrapper").innerHTML=o:Main.displayMessage("Nothing found","warning")}console.log("Media galery js loaded"),document.querySelectorAll(".searchtext").forEach((e=>{e.addEventListener("keyup",(function(e){13===e.keyCode&&a(e.target)}))})),document.addEventListener("click",(async n=>{var l=n.target,o=l.closest(".large-image");if(l.matches(".media-item")&&(n.preventDefault(),n.stopPropagation(),e(l.closest(".cell").dataset.index)),l.matches(".closebtn")){o.classList.add("hidden");var d=o.querySelector("iframe");null!=d&&(d.src=d.src)}l.matches(".prevbtn")&&e(l.closest(".large-image").previousElementSibling.previousElementSibling.dataset.index),l.matches(".nextbtn")&&function(a){let n=a.closest(".large-image"),l=n.nextElementSibling;null!=l&&(l=l.nextElementSibling),null==l?(document.getElementById("medialoaderwrapper").classList.remove("hidden"),document.getElementById("paged").value=parseInt(document.getElementById("paged").value)+1,t(n.dataset.index,!0)):e(l.dataset.index)}(l),"loadmoremedia"==l.id&&(n.preventDefault(),n.stopPropagation(),function(e){let a=document.querySelectorAll(".cell");document.getElementById("paged").value=parseInt(document.getElementById("paged").value)+1,t(a[a.length-1].dataset.index,!1),Main.showLoader(e)}(l)),l.matches(".buttonwrapper .description")&&Main.displayMessage(l.dataset.description),l.matches(".media-type-selector")&&function(e){var a;if(e.checked){document.querySelectorAll(".cell."+e.value).forEach((e=>e.classList.remove("hidden"))),a=document.querySelectorAll(".cell:not(.hidden)");for(let e=document.querySelector("#media-amount").value;e<a.length;e++)a[e].remove()}else{document.querySelectorAll(".cell."+e.value).forEach((e=>e.classList.add("hidden")));var n=document.querySelectorAll(".cell");a=document.querySelectorAll(".cell:not(.hidden)"),t(n[n.length-1].dataset.index,!1,a.length)}}(l),l.matches(".mediabuttons .search")&&(n.preventDefault(),n.stopPropagation(),a(l)),l.matches(".download")&&(n.preventDefault(),async function(e){(await Swal.fire({title:"Warning",html:"Downloading of materials is only allowed for use in presentations. <br>You should not share this file with others as it may contain privacy sensitive information",showCancelButton:!0,confirmButtonText:"I promise not to share this file",confirmButtonColor:"#bd2919"})).isConfirmed&&e.querySelector("a").click()}(l))})),document.addEventListener("change",(e=>{var a=e.target;if("media-amount"==a.id){document.getElementById("paged").value=1;var n=document.querySelectorAll(".cell"),l=n.length;if(a.value>l)t(parseInt(n[n.length-1].dataset.index),!1,l);else if(a.value<l){var o=1;document.querySelectorAll(".cell, .large-image").forEach((e=>{o>a.value&&e.remove(),e.matches(".cell")&&o++}))}}}));var n=null,l=null;document.addEventListener("touchstart",(function(e){const t=e.touches[0];n=t.clientX,l=t.clientY})),document.addEventListener("touchmove",(function(t){if(n&&l){var a=t.touches[0].clientX,o=t.touches[0].clientY,d=n-a,r=l-o;if(Math.abs(d)>Math.abs(r)){var i=document.querySelector(".large-image:not(.hidden)");e((d>0?i.nextElementSibling.nextElementSibling:i.previousElementSibling.previousElementSibling).dataset.index)}n=null,l=null}}))})();
//# sourceMappingURL=media_gallery.min.js.map