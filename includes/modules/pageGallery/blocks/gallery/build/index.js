!function(){"use strict";var e,t={211:function(e,t,n){var l=window.wp.blocks,r=window.wp.element,a=window.wp.i18n,o=window.wp.blockEditor,s=window.wp.apiFetch,u=n.n(s),i=window.wp.components,c=window.wp.coreData,p=window.wp.data,m=JSON.parse('{"u2":"sim/simpagegallery"}');(0,l.registerBlockType)(m.u2,{icon:"format-gallery",edit:e=>{let{setAttributes:t,attributes:n,context:l}=e;const s=n.color;let m=n.postTypes,g=JSON.parse(n.categories);const f=l.postType,[h,d]=(0,r.useState)([]),[w,y]=(0,r.useState)({}),[_,E]=(0,r.useState)((0,r.createElement)(r.Fragment,null," Loading... ",(0,r.createElement)(i.Spinner,null)," ")),[b,v]=(0,r.useState)((0,r.createElement)(r.Fragment,null," ",(0,r.createElement)("br",null),(0,r.createElement)(i.Spinner,null)," ")),[O,k]=(0,r.useState)((0,r.createElement)(r.Fragment,null," ",(0,r.createElement)("br",null),(0,r.createElement)(i.Spinner,null)," ")),[C,S]=(0,r.useState)(!1),T=(0,p.useSelect)((e=>e(c.store).getTaxonomies({per_page:-1})),[]),P=(0,p.useSelect)((e=>e(c.store).getPostTypes({per_page:-1})),[]);return(0,r.useEffect)((()=>{if(null==P||null==T)return;let e=P.filter((e=>!["revision","nav_menu_item","custom_css","customize_changeset","oembed_cache","user_request","wp_block","wp_template","wp_template_part","wp_navigation"].includes(e.slug)));d(e);let t={...w};e.map((e=>{let n=T.filter((t=>t.types.includes(e.slug)));null==t[e.slug]&&(t[e.slug]={}),n.map((async n=>{t[e.slug][n.slug]=await u()({path:`/${n.rest_namespace}/${n.rest_base}/?per_page=100`})}))})),y(t)}),[P,T]),(0,r.useEffect)((()=>{!async function(){0!=h.length&&v(h.map((e=>(0,r.createElement)(i.CheckboxControl,{label:e.name,onChange:n=>{!function(e,n){let l=[...m];n?l.includes(e)||l.push(e):l=l.filter((t=>t!=e)),t({postTypes:l})}(e.slug,n)},checked:m.includes(e.slug),key:e.slug}))))}()}),[h,n.postTypes]),(0,r.useEffect)((()=>{let e=!0;if(0==Object.keys(w).length)return void k((0,r.createElement)(i.Spinner,null));let n=[];0==m.length&&null!=w[f]&&t({postTypes:[f]}),m.forEach((l=>{if(n.push((0,r.createElement)("h2",null,l.charAt(0).toUpperCase()+l.slice(1))),null==w[l]||0==Object.entries(w[l]).length)return k((0,r.createElement)(i.Spinner,null)),void setTimeout(S,1e3,!C);Object.keys(w[l]).forEach((a=>{n.push(a.charAt(0).toUpperCase()+a.slice(1)),Object.values(w[l][a]).map((o=>{e=!0;try{e=g[l][a].includes(o.slug)}catch(t){e=!1}n.push((0,r.createElement)(i.CheckboxControl,{label:o.name,onChange:e=>{!function(e,n,l,r){let a={...g};null==a[e]&&(a[e]={}),null==a[e][n]&&(a[e][n]=[]),r?a[e][n].includes(l)||a[e][n].push(l):a=a[e][n].filter((e=>e!=l)),t({categories:JSON.stringify(a)})}(l,a,o.slug,e)},checked:e,key:o.id}))}))}))})),k(n)}),[w,n.categories,n.postTypes,C]),(0,r.useEffect)((()=>{!async function(){E((0,r.createElement)(r.Fragment,null," Loading... ",(0,r.createElement)(i.Spinner,null)," "));const e=await u()({path:sim.restApiPrefix+"/pagegallery/show_page_gallery",method:"POST",data:{postTypes:m,amount:n.amount,categories:g,speed:n.speed,title:n.title}});E(wp.element.RawHTML({children:e}))}()}),[n]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(o.InspectorControls,null,(0,r.createElement)(i.Panel,null,(0,r.createElement)(i.PanelBody,{title:"Background color",initialOpen:!1},(0,r.createElement)(i.PanelRow,null,(0,r.createElement)(i.ColorPicker,{color:s,onChange:e=>t({color:e}),enableAlpha:!0,defaultValue:"#000"}))),(0,r.createElement)(i.PanelBody,{title:"Properties",initialOpen:!1},(0,r.createElement)(i.__experimentalInputControl,{label:(0,a.__)("Title","sim"),isPressEnterToChange:!0,value:n.title,onChange:e=>t({title:e})}),(0,a.__)("How many pages should be shown at once","sim"),(0,r.createElement)(i.__experimentalNumberControl,{label:(0,a.__)("Page count","sim"),value:n.amount,onChange:e=>t({amount:parseInt(e)}),min:1,max:12}),(0,r.createElement)("br",null),(0,a.__)("How often should we refresh in seconds","sim"),(0,r.createElement)(i.__experimentalNumberControl,{label:(0,a.__)("Refresh rate","sim"),value:n.speed,onChange:e=>t({speed:parseInt(e)}),min:30}),(0,r.createElement)("br",null),"Select the post types you want to include in the gallery:",b,(0,r.createElement)("br",null),"Select the categories you want from any post type. Leave empty for all",O))),(0,r.createElement)("div",(0,o.useBlockProps)(),_))},save:()=>null})}},n={};function l(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,l),a.exports}l.m=t,e=[],l.O=function(t,n,r,a){if(!n){var o=1/0;for(c=0;c<e.length;c++){n=e[c][0],r=e[c][1],a=e[c][2];for(var s=!0,u=0;u<n.length;u++)(!1&a||o>=a)&&Object.keys(l.O).every((function(e){return l.O[e](n[u])}))?n.splice(u--,1):(s=!1,a<o&&(o=a));if(s){e.splice(c--,1);var i=r();void 0!==i&&(t=i)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,{a:t}),t},l.d=function(e,t){for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};l.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,o=n[0],s=n[1],u=n[2],i=0;if(o.some((function(t){return 0!==e[t]}))){for(r in s)l.o(s,r)&&(l.m[r]=s[r]);if(u)var c=u(l)}for(t&&t(n);i<o.length;i++)a=o[i],l.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return l.O(c)},n=self.webpackChunksim_page_gallery=self.webpackChunksim_page_gallery||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=l.O(void 0,[431],(function(){return l(211)}));r=l.O(r)}();