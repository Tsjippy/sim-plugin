!function(){"use strict";var e,t={211:function(e,t,n){var l=window.wp.blocks,r=window.wp.element,a=window.wp.i18n,s=window.wp.blockEditor,o=window.wp.apiFetch,u=n.n(o),i=window.wp.components,c=window.wp.coreData,p=window.wp.data,m=JSON.parse('{"u2":"sim/simpagegallery"}');(0,l.registerBlockType)(m.u2,{icon:"page",edit:e=>{let{setAttributes:t,attributes:n,context:l}=e,o=n.postTypes,m=JSON.parse(n.categories);const f=l.postType,[g,h]=(0,r.useState)([]),[d,w]=(0,r.useState)({}),[_,b]=(0,r.useState)((0,r.createElement)(i.Spinner,null)),[y,E]=(0,r.useState)((0,r.createElement)(r.Fragment,null," ",(0,r.createElement)("br",null),(0,r.createElement)(i.Spinner,null)," ")),[v,S]=(0,r.useState)((0,r.createElement)(r.Fragment,null," ",(0,r.createElement)("br",null),(0,r.createElement)(i.Spinner,null)," ")),[O,C]=(0,r.useState)(!1),k=(0,p.useSelect)((e=>e(c.store).getTaxonomies({per_page:-1})),[]),T=(0,p.useSelect)((e=>e(c.store).getPostTypes({per_page:-1})),[]);return(0,r.useEffect)((()=>{if(null==T||null==k)return;let e=T.filter((e=>!["revision","nav_menu_item","custom_css","customize_changeset","oembed_cache","user_request","wp_block","wp_template","wp_template_part","wp_navigation"].includes(e.slug)));h(e);let t={...d};e.map((e=>{let n=k.filter((t=>t.types.includes(e.slug)));null==t[e.slug]&&(t[e.slug]={}),n.map((async n=>{t[e.slug][n.slug]=await u()({path:`/${n.rest_namespace}/${n.rest_base}`})}))})),w(t)}),[T,k]),(0,r.useEffect)((async()=>{0!=g.length&&E(g.map((e=>(0,r.createElement)(i.CheckboxControl,{label:e.name,onChange:n=>{!function(e,n){let l=[...o];n?l.includes(e)||l.push(e):l=l.filter((t=>t!=e)),console.log(l),t({postTypes:l})}(e.slug,n)},checked:o.includes(e.slug)}))))}),[g,n.postTypes]),(0,r.useEffect)((()=>{let e=!0;if(0==Object.keys(d).length)return void S((0,r.createElement)(i.Spinner,null));let n=[];0==o.length&&null!=d[f]&&t({postTypes:[f]}),o.forEach((l=>{if(n.push((0,r.createElement)("h2",null,l.charAt(0).toUpperCase()+l.slice(1))),null==d[l]||0==Object.entries(d[l]).length)return S((0,r.createElement)(i.Spinner,null)),void setTimeout(C,1e3,!O);Object.keys(d[l]).forEach((a=>{n.push(a.charAt(0).toUpperCase()+a.slice(1)),Object.values(d[l][a]).map((s=>{e=!0;try{e=m[l][a].includes(s.slug)}catch(t){e=!1}n.push((0,r.createElement)(i.CheckboxControl,{label:s.name,onChange:e=>{!function(e,n,l,r){let a={...m};null==a[e]&&(a[e]={}),null==a[e][n]&&(a[e][n]=[]),r?a[e][n].includes(l)||a[e][n].push(l):a=a[e][n].filter((e=>e!=l)),t({categories:JSON.stringify(a)})}(l,a,s.slug,e)},checked:e}))}))}))})),S(n)}),[d,n.categories,n.postTypes,O]),(0,r.useEffect)((async()=>{b((0,r.createElement)(i.Spinner,null));const e=await u()({path:sim.restApiPrefix+"/frontpage/show_page_gallery",method:"POST",data:{postTypes:o,amount:n.amount,categories:m,speed:n.speed,title:n.title}});b(wp.element.RawHTML({children:e}))}),[n]),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(s.InspectorControls,null,(0,r.createElement)(i.Panel,null,(0,r.createElement)(i.PanelBody,null,(0,r.createElement)(i.__experimentalInputControl,{label:(0,a.__)("Title","sim"),isPressEnterToChange:!0,value:n.title,onChange:e=>t({title:e})}),(0,a.__)("How many pages should be shown at once","sim"),(0,r.createElement)(i.__experimentalNumberControl,{label:(0,a.__)("Page count","sim"),value:n.amount,onChange:e=>t({amount:parseInt(e)}),min:1,max:12}),(0,r.createElement)("br",null),(0,a.__)("How often should we refresh in seconds","sim"),(0,r.createElement)(i.__experimentalNumberControl,{label:(0,a.__)("Refresh rate","sim"),value:n.speed,onChange:e=>t({speed:parseInt(e)}),min:30}),(0,r.createElement)("br",null),"Select the post types you want to include in the gallery:",y,(0,r.createElement)("br",null),"Select the categories you want from any post type. Leave empty for all",v))),(0,r.createElement)("div",(0,s.useBlockProps)(),_))},save:()=>null})}},n={};function l(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,l),a.exports}l.m=t,e=[],l.O=function(t,n,r,a){if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],r=e[c][1],a=e[c][2];for(var o=!0,u=0;u<n.length;u++)(!1&a||s>=a)&&Object.keys(l.O).every((function(e){return l.O[e](n[u])}))?n.splice(u--,1):(o=!1,a<s&&(s=a));if(o){e.splice(c--,1);var i=r();void 0!==i&&(t=i)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,r,a]},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,{a:t}),t},l.d=function(e,t){for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};l.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,s=n[0],o=n[1],u=n[2],i=0;if(s.some((function(t){return 0!==e[t]}))){for(r in o)l.o(o,r)&&(l.m[r]=o[r]);if(u)var c=u(l)}for(t&&t(n);i<s.length;i++)a=s[i],l.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return l.O(c)},n=self.webpackChunksim_page_gallery=self.webpackChunksim_page_gallery||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=l.O(void 0,[431],(function(){return l(211)}));r=l.O(r)}();