{"version":3,"file":"page_gallery.min.js","mappings":"MAAAA,SAASC,iBAAiB,oBAAoB,KAC1CC,QAAQC,IAAI,0BACZH,SAASI,iBAAiB,yBAAyBC,SAAQC,IACvDC,EAAkBD,GAAS,EAAK,GACnC,IAML,IAAIC,EAAsBC,eAAeF,EAASG,GAAM,GACpD,IAAIC,EAAUJ,EAAQK,QAAQD,MAE1BE,EAAcN,EAElB,IAAIG,EAAM,CACN,IAAII,EAAW,IAAIC,SACnBD,EAASE,OAAO,YAAaT,EAAQK,QAAQK,WAC7CH,EAASE,OAAO,SAAUT,EAAQF,iBAAiB,iBAAiBa,QACpEJ,EAASE,OAAO,aAAcT,EAAQK,QAAQO,YAC9CL,EAASE,OAAO,QAASL,GACzBG,EAASE,OAAO,QAAST,EAAQa,cAAc,uBAAuBC,aACtE,IAAIC,QAAiBC,WAAWC,aAAa,8BAA+BV,GAE5E,GAAGQ,EAAS,CAER,IAAIG,EAAMxB,SAASyB,cAAc,OACjCD,EAAIE,UAAcL,EAClBT,EAAkBY,EAAIL,cAAc,yBAEpC,IAAIQ,EAAUf,EAAWR,iBAAiB,OACtCwB,EAAUD,EAAKV,OACnBU,EAAKtB,SAAQwB,IACTA,EAAIC,gBAAgB,WACpBD,EAAI5B,iBAAiB,QAAQ,KACzB2B,IAIc,IAAXA,GAECtB,EAAQyB,YAAYnB,EACxB,IAEJiB,EAAIG,IAAIH,EAAIG,MAEpB,CACJ,CAEAC,WACI1B,EACM,IAANG,EACAE,EAER,C","sources":["webpack://home/./page_gallery.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', () => {   \r\n    console.log('Page gallery.js loaded');\r\n    document.querySelectorAll('.page-gallery-article').forEach(gallery => {\r\n        reloadPageGallery(gallery, true);\r\n    })\r\n\r\n    \r\n});\r\n\r\n\r\nlet reloadPageGallery   = async function(gallery, first=false){\r\n    let speed   = gallery.dataset.speed;\r\n\r\n    let newGallery  = gallery\r\n\r\n    if(!first){\r\n        var formData = new FormData();\r\n        formData.append('postTypes', gallery.dataset.posttypes);\r\n        formData.append('amount', gallery.querySelectorAll('.page-gallery').length);\r\n        formData.append('categories', gallery.dataset.categories);\r\n        formData.append('speed', speed);\r\n        formData.append('title', gallery.querySelector('.page-gallery-title').textContent);\r\n        var response = await FormSubmit.fetchRestApi('frontpage/show_page_gallery', formData);\r\n\r\n        if(response){\r\n            // convert the html to a node so we can pass it on to the next iteration\r\n            let div = document.createElement('div');\r\n            div.innerHTML   = response;\r\n            newGallery      = div.querySelector('.page-gallery-article');\r\n\r\n            let imgs    = newGallery.querySelectorAll('img');\r\n            let amount  = imgs.length;\r\n            imgs.forEach(img=>{\r\n                img.removeAttribute('loading');\r\n                img.addEventListener('load', () => {\r\n                    amount--;\r\n\r\n                    //console.log('Current amount is '+amount);\r\n\r\n                    if(amount === 0){\r\n                        //console.log('Updating ');\r\n                        gallery.replaceWith(newGallery);\r\n                    }\r\n                });\r\n                img.src=img.src\r\n            });\r\n        }\r\n    }\r\n\r\n    setTimeout(\r\n        reloadPageGallery,\r\n        speed*1000,\r\n        newGallery\r\n    );\r\n}"],"names":["document","addEventListener","console","log","querySelectorAll","forEach","gallery","reloadPageGallery","async","first","speed","dataset","newGallery","formData","FormData","append","posttypes","length","categories","querySelector","textContent","response","FormSubmit","fetchRestApi","div","createElement","innerHTML","imgs","amount","img","removeAttribute","replaceWith","src","setTimeout"],"sourceRoot":""}