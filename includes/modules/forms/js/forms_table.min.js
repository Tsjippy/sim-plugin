(()=>{function e(e){e.target.closest("td")!=target_cell&&(this.removeEventListener("click",arguments.callee),o(e,target_cell))}window.remove_form_table_row=function(e,t){if(e.status>=200&&e.status<400){var a='.form_data_table[data-id="'+t.formid+'"] .table-row[data-id="'+t.submissionid+'"]';-1!=t.subid?document.querySelectorAll(a+'[data-subid="'+t.subid+'"]').forEach((e=>{e.remove()})):document.querySelectorAll(a).forEach((e=>{e.remove()}))}},window.changearchivebutton=function(e,t){if(e.status>=200&&e.status<400){if(t.message.includes("unarchived"))var a="unarchive";else a="archive";if(-1!=t.subid)var i=document.querySelectorAll('.form_data_table[data-id="'+t.formid+'"] .table-row[data-id="'+t.submissionid+'"][data-subid="'+t.subid+'"] .'+a);else i=document.querySelectorAll('.form_data_table[data-id="'+t.formid+'"] .table-row[data-id="'+t.submissionid+'"] .'+a);var o=document.querySelector('.form_data_table[data-id="'+t.formid+'"] .loadergif'),s=o.outerHTML;t.message.includes("unarchived")?(o.parentNode.innerHTML=o.parentNode.innerHTML.replace(s,'<button class="archive button table_action" name="archive_action" value="">Archive</button>'),console.log(o.parentNode),i.forEach((e=>{e.textContent="Archive",e.classList.replace("unarchive","archive")}))):(o.parentNode.innerHTML=o.parentNode.innerHTML.replace(s,'<button class="unarchive button table_action" name="unarchive_action">Unarchive</button>'),i.forEach((e=>{e.textContent="Unarchive",e.classList.replace("archive","unarchive")})))}},window.showforminput=function(t,a){var i,s,n=a.html;if(isNaN(a.subid))var d="";else d='[data-subid="'+a.subid+'"]';target_cell=document.querySelector('table[data-id="'+a.formid+'"] tr[data-id="'+a.submissionid+'"]'+d+' td[data-id="'+a.cellid+'"]'),null!=target_cell&&(target_cell.innerHTML=n,i=target_cell,(s=i.querySelectorAll("input,select,textarea")).forEach((t=>{old_value.split(",").forEach((e=>{"checkbox"==t.type||"radio"==t.type?t.value==e.trim()&&(t.checked=!0):"select"==t.type?t.querySelector('option[value="'+e+'"]').selected=!0:t.value=old_value})),"select-one"==t.type&&(t._niceselect=NiceSelect.bind(t,{searchable:!0})),t.addEventListener("keyup",(function(e){13===e.keyCode&&o(e)})),document.addEventListener("click",e),"checkbox"==t.type&&1!=s.length||("date"==t.type?t.addEventListener("blur",(function(e){""!=e.target.value&&o(e)})):t.addEventListener("change",(function(e){""!=e.target.value&&o(e)})),t.focus())})),document.addEventListener("click",e))},window.changetablevalue=function(e,a){if(isNaN(a.subid))var i="";else i='[data-subid="'+a.subid+'"]';document.querySelectorAll('table[data-id="'+a.formid+'"] tr[data-id="'+a.submissionid+'"]'+i+' td[data-id="'+a.cellid+'"]').forEach((e=>{var t=a.newvalue;""==t&&(t="X"),e.innerHTML=t})),t=""};var t="";function a(e){if(t!=e){t=e;var a=e.closest("table"),i=a.dataset.id,o=a.dataset.nonce,s=e.closest("tr").dataset.id,n=e.closest("tr").dataset.subid,d=e.dataset.id;old_text=e.textContent,old_value=e.dataset.original,showLoader(e.firstChild),"Click to update"!=old_value&&"X"!=old_value||(old_value="");var r=new FormData;r.append("action","get_input_html"),r.append("formname",i),r.append("updateforminput",o),r.append("submission_id",s),r.append("sub_id",n),r.append("fieldname",d),r.append("old_value",old_value),sendAJAX(r)}}var i=!1;function o(t,a){if(void 0===a&&(a=t.target),form=a.closest("td"),i!=a){i=a,setTimeout((function(){i=!1}),500);var o=get_field_value(a,!1),s=a.closest("table"),n=a.closest("tr").dataset.id,d=a.closest("td").dataset.subid,r=a.closest("td").dataset.id;if(document.removeEventListener("click",e),o!=old_value){showLoader(a.closest("td").firstChild);var l=new FormData;l.append("action","forms_table_update"),l.append("table_id",s.dataset.id),l.append("shortcodeid",s.dataset.shortcodeid),l.append("submission_id",n),l.append("subid",d),l.append("fieldname",r),l.append("newvalue",o),l.append("formurl",location.href),sendAJAX(l)}else console.log(o),a.closest("td").innerHTML=old_text}}document.addEventListener("click",(e=>{var t=e.target;t.classList.contains("forms_table_action")&&function(e){var t=new FormData,a=e.closest("table"),i=e.closest("tr"),o=!0;e.classList.contains("delete")?(t.append("remove","true"),text="delete"):e.classList.contains("archive")?(t.append("archive",!0),text="archive",null!=i.dataset.subid&&(o=!1,Swal.fire({title:"What do you want to archive?",text:"Do you want to archive just this one or the whole request?",icon:"question",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Just this one",denyButtonText:"The whole request",confirmButtonColor:"#bd2919"}).then((o=>{o.isConfirmed&&t.append("subid",i.dataset.subid),0==o.isDismissed&&(showLoader(e),t.append("action","forms_table_update"),t.append("table_id",a.dataset.id),t.append("submission_id",i.dataset.id),t.append("shortcodeid",a.dataset.shortcodeid),sendAJAX(t))})))):e.classList.contains("unarchive")?(t.append("archive",!1),text="unarchive"):e.classList.contains("print")&&(window.location.href=window.location.href.split("?")[0]+"?print=true&table_id="+a.dataset.id+"&submission_id="+i.querySelector("[id='id' i]").textContent),1==o&&Swal.fire({title:"Are you sure?",text:"Are you sure you want to "+text+" this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#bd2919",cancelButtonColor:"#d33",confirmButtonText:"Yes, "+text+" it!"}).then((o=>{o.isConfirmed&&(showLoader(e),t.append("action","forms_table_update"),t.append("table_id",a.dataset.id),t.append("submission_id",i.dataset.id),t.append("shortcodeid",a.dataset.shortcodeid),sendAJAX(t))}))}(t),"form_settings[autoarchive]"==t.name&&(el=t.closest(".table_rights_wrapper").querySelector(".autoarchivelogic"),"true"==t.value?el.classList.remove("hidden"):el.classList.add("hidden")),t.classList.contains("edit_formshortcode_settings")&&t.parentNode.querySelector(".form_shortcode_settings").classList.remove("hidden");var i=t.closest("td");t.matches("td.edit_forms_table")?a(t):null!=i&&i.matches("td.edit_forms_table")&&"INPUT"!=t.tagName&&"A"!=t.tagName&&"TEXTAREA"!=t.tagName&&!t.closest(".nice-select")&&a(t.closest("td")),t.classList.contains("visibilityicon")&&("SPAN"==t.tagName&&(t=t.querySelector("img")),t.classList.contains("visible")?(t.classList.replace("visible","invisible"),t.src=t.src.replace("visible.png","invisible.png"),t.closest(".column_setting_wrapper").querySelector(".visibilitytype").value="hide"):(t.classList.replace("invisible","visible"),t.src=t.src.replace("invisible.png","visible.png"),t.closest(".column_setting_wrapper").querySelector(".visibilitytype").value="show"))})),document.addEventListener("DOMContentLoaded",(function(){if(console.log("Formstable.js loaded"),"undefined"!=typeof Sortable){var e={handle:".movecontrol",animation:150};document.querySelectorAll(".sortable_column_settings_rows").forEach((t=>{Sortable.create(t,e)}))}})),document.addEventListener("change",(e=>{var t=e.target;"sim-forms-selector"==t.id&&(document.querySelectorAll(".main_form_wrapper").forEach((e=>{e.classList.add("hidden")})),document.getElementById(t.value).classList.remove("hidden"),position_table())}))})();