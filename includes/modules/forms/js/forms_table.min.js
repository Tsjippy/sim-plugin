(()=>{function e(e){e.target.closest("td")!=target_cell&&(this.removeEventListener("click",arguments.callee),s(e,target_cell))}window.remove_form_table_row=function(e,t){if(e.status>=200&&e.status<400){var a='.form-data-table[data-id="'+t.formid+'"] .table-row[data-id="'+t.submissionid+'"]';-1!=t.subid?document.querySelectorAll(a+'[data-subid="'+t.subid+'"]').forEach((e=>{e.remove()})):document.querySelectorAll(a).forEach((e=>{e.remove()}))}},window.changearchivebutton=function(e,t){if(e.status>=200&&e.status<400){if(t.message.includes("unarchived"))var a="unarchive";else a="archive";if(-1!=t.subid)var i=document.querySelectorAll('.form-data-table[data-id="'+t.formid+'"] .table-row[data-id="'+t.submissionid+'"][data-subid="'+t.subid+'"] .'+a);else i=document.querySelectorAll('.form-data-table[data-id="'+t.formid+'"] .table-row[data-id="'+t.submissionid+'"] .'+a);var s=document.querySelector('.form-data-table[data-id="'+t.formid+'"] .loadergif'),o=s.outerHTML;t.message.includes("unarchived")?(s.parentNode.innerHTML=s.parentNode.innerHTML.replace(o,'<button class="archive button table_action" name="archive_action" value="">Archive</button>'),console.log(s.parentNode),i.forEach((e=>{e.textContent="Archive",e.classList.replace("unarchive","archive")}))):(s.parentNode.innerHTML=s.parentNode.innerHTML.replace(o,'<button class="unarchive button table_action" name="unarchive_action">Unarchive</button>'),i.forEach((e=>{e.textContent="Unarchive",e.classList.replace("archive","unarchive")})))}},window.showforminput=function(t,a){var i,o,n=a.html;if(isNaN(a.subid))var d="";else d='[data-subid="'+a.subid+'"]';target_cell=document.querySelector('table[data-id="'+a.formid+'"] tr[data-id="'+a.submissionid+'"]'+d+' td[data-id="'+a.cellid+'"]'),null!=target_cell&&(target_cell.innerHTML=n,i=target_cell,(o=i.querySelectorAll("input,select,textarea")).forEach((t=>{old_value.split(",").forEach((e=>{"checkbox"==t.type||"radio"==t.type?t.value==e.trim()&&(t.checked=!0):"select"==t.type?t.querySelector('option[value="'+e+'"]').selected=!0:t.value=old_value})),"select-one"==t.type&&(t._niceselect=NiceSelect.bind(t,{searchable:!0})),t.addEventListener("keyup",(function(e){13===e.keyCode&&s(e)})),document.addEventListener("click",e),"checkbox"==t.type&&1!=o.length||("date"==t.type?t.addEventListener("blur",(function(e){""!=e.target.value&&s(e)})):t.addEventListener("change",(function(e){""!=e.target.value&&s(e)})),t.focus())})),document.addEventListener("click",e))},window.changetablevalue=function(e,a){if(isNaN(a.subid))var i="";else i='[data-subid="'+a.subid+'"]';document.querySelectorAll('table[data-id="'+a.formid+'"] tr[data-id="'+a.submissionid+'"]'+i+' td[data-id="'+a.cellid+'"]').forEach((e=>{var t=a.newvalue;""==t&&(t="X"),e.innerHTML=t})),t=""};var t="";function a(e){if(t!=e){t=e;var a=e.closest("table"),i=a.dataset.id,s=a.dataset.nonce,o=e.closest("tr").dataset.id,n=e.closest("tr").dataset.subid,d=e.dataset.id;old_text=e.textContent,old_value=e.dataset.original,showLoader(e.firstChild),"Click to update"!=old_value&&"X"!=old_value||(old_value="");var r=new FormData;r.append("action","get_input_html"),r.append("formname",i),r.append("updateforminput",s),r.append("submission_id",o),r.append("sub_id",n),r.append("fieldname",d),r.append("old_value",old_value),sendAJAX(r)}}var i=!1;function s(t,a){if(void 0===a&&(a=t.target),form=a.closest("td"),i!=a){i=a,setTimeout((function(){i=!1}),500);var s=get_field_value(a,!1),o=a.closest("table"),n=a.closest("tr").dataset.id,d=a.closest("td").dataset.subid,r=a.closest("td").dataset.id;if(document.removeEventListener("click",e),s!=old_value){showLoader(a.closest("td").firstChild);var l=new FormData;l.append("action","forms_table_update"),l.append("table_id",o.dataset.id),l.append("shortcodeid",o.dataset.shortcodeid),l.append("submission_id",n),l.append("subid",d),l.append("fieldname",r),l.append("newvalue",s),l.append("formurl",location.href),sendAJAX(l)}else console.log(s),a.closest("td").innerHTML=old_text}}document.addEventListener("click",(e=>{var t=e.target;t.classList.contains("forms_table_action")&&function(e){var t=new FormData,a=e.closest("table"),i=e.closest("tr"),s=!0;e.classList.contains("delete")?(t.append("remove","true"),text="delete"):e.classList.contains("archive")?(t.append("archive",!0),text="archive",null!=i.dataset.subid&&(s=!1,Swal.fire({title:"What do you want to archive?",text:"Do you want to archive just this one or the whole request?",icon:"question",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Just this one",denyButtonText:"The whole request",confirmButtonColor:"#bd2919"}).then((s=>{s.isConfirmed&&t.append("subid",i.dataset.subid),0==s.isDismissed&&(showLoader(e),t.append("action","forms_table_update"),t.append("table_id",a.dataset.id),t.append("submission_id",i.dataset.id),t.append("shortcodeid",a.dataset.shortcodeid),sendAJAX(t))})))):e.classList.contains("unarchive")?(t.append("archive",!1),text="unarchive"):e.classList.contains("print")&&(window.location.href=window.location.href.split("?")[0]+"?print=true&table_id="+a.dataset.id+"&submission_id="+i.querySelector("[id='id' i]").textContent),1==s&&Swal.fire({title:"Are you sure?",text:"Are you sure you want to "+text+" this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#bd2919",cancelButtonColor:"#d33",confirmButtonText:"Yes, "+text+" it!"}).then((s=>{s.isConfirmed&&(showLoader(e),t.append("action","forms_table_update"),t.append("table_id",a.dataset.id),t.append("submission_id",i.dataset.id),t.append("shortcodeid",a.dataset.shortcodeid),sendAJAX(t))}))}(t),"form_settings[autoarchive]"==t.name&&(el=t.closest(".table_rights_wrapper").querySelector(".autoarchivelogic"),"true"==t.value?el.classList.remove("hidden"):el.classList.add("hidden")),t.classList.contains("edit_formshortcode_settings")&&t.parentNode.querySelector(".form_shortcode_settings").classList.remove("hidden");var i=t.closest("td");t.matches("td.edit_forms_table")?a(t):null!=i&&i.matches("td.edit_forms_table")&&"INPUT"!=t.tagName&&"A"!=t.tagName&&"TEXTAREA"!=t.tagName&&!t.closest(".nice-select")&&a(t.closest("td")),t.classList.contains("visibilityicon")&&("SPAN"==t.tagName&&(t=t.querySelector("img")),t.parentNode.matches("th")?function(e){var t=e.closest("table"),a=t.rows;for(let t=0;t<a.length;t++)a[t].cells[e.cellIndex].classList.add("hidden");e.closest(".form-table-wrapper").querySelector(".reset-col-vis").classList.remove("hidden");var i=new FormData;i.append("formname",t.dataset.id),i.append("column_name",e.id),i.append("_wpnonce",sim.restnonce),fetch(sim.base_url+"/wp-json/sim/v1/save_table_prefs",{method:"POST",credentials:"same-origin",body:i}).then((e=>e.json())).then((e=>console.log(e))).catch((e=>console.error(e)))}(t.parentNode):t.classList.contains("visible")?(t.classList.replace("visible","invisible"),t.src=t.src.replace("visible.png","invisible.png"),t.closest(".column_setting_wrapper").querySelector(".visibilitytype").value="hide"):(t.classList.replace("invisible","visible"),t.src=t.src.replace("invisible.png","visible.png"),t.closest(".column_setting_wrapper").querySelector(".visibilitytype").value="show")),t.matches(".reset-col-vis")&&function(e){e.closest(".form-table-wrapper").querySelector(".reset-col-vis").classList.add("hidden");var t=e.closest(".form-table-wrapper").querySelector("table");t.querySelectorAll("th.hidden, td.hidden").forEach((e=>e.classList.remove("hidden")));var a=new FormData;a.append("formname",t.dataset.id),a.append("_wpnonce",sim.restnonce),fetch(sim.base_url+"/wp-json/sim/v1/delete_table_prefs",{method:"POST",credentials:"same-origin",body:a}).then((e=>e.json())).then((e=>console.log(e))).catch((e=>console.error(e)))}(t)})),document.addEventListener("DOMContentLoaded",(function(){if(console.log("Formstable.js loaded"),"undefined"!=typeof Sortable){var e={handle:".movecontrol",animation:150};document.querySelectorAll(".sortable_column_settings_rows").forEach((t=>{Sortable.create(t,e)}))}})),document.addEventListener("change",(e=>{var t=e.target;"sim-forms-selector"==t.id&&(document.querySelectorAll(".main_form_wrapper").forEach((e=>{e.classList.add("hidden")})),document.getElementById(t.value).classList.remove("hidden"),position_table())}))})();
//# sourceMappingURL=forms_table.min.js.map