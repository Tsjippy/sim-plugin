!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.formFunctions=t():e.formFunctions=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,r)=>{for(var l in r)e.o(r,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:r[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e){Array.from(e.options).forEach((function(e){e.defaultSelected=!1}))}function l(e,t=!0){return e.querySelectorAll("select").forEach((e=>{-1!=e.selectedIndex&&0==e.options[e.selectedIndex].defaultSelected&&r(e),e.selectedOptions.length>0&&(e.selectedOptions[0].defaultSelected=!0),e._niceselect.destroy()})),"undefined"!=typeof tinymce&&(tinymce_settings=[],e.querySelectorAll(".wp-editor-area").forEach((e=>{var t=tinymce.get(e.id);null!=t&&(tinymce_settings[e.id]=t.settings,t.save(),t.remove())}))),newnode=e.cloneNode(!0),e.querySelectorAll("select").forEach((e=>{e._niceselect=NiceSelect.bind(e,{searchable:!0}),""==e.value&&e._niceselect.clear()})),e.querySelectorAll(".wp-editor-area").forEach((e=>{tinymce.init(tinymce_settings[e.id])})),1==t?newnode.querySelectorAll("input,select,textarea").forEach((e=>{"checkbox"==e.type||"radio"==e.type?e.checked=!1:"hidden"!=e.type&&(e.value=""),"select-one"==e.type&&(r(e),e._niceselect=NiceSelect.bind(e,{searchable:!0}),e._niceselect.clear())})):newnode.querySelectorAll("select").forEach((e=>{e._niceselect=NiceSelect.bind(e,{searchable:!0})})),newnode}function n(e){newnode=clone_node(e);var t=parseInt(e.dataset.divid)+1;if(null!=e.getAttribute("data-type")){var r=e.getAttribute("data-type").replace("[","\\[").replace("]","\\]");re=new RegExp("("+r+"?\\]?\\[).*[0-9](.*)","g")}else re=new RegExp("(.*)[0-9](.*)","g");newnode.querySelectorAll(".upload-files").forEach((function(e){e.dataset.index=t})),newnode.querySelectorAll(".documentpreview").forEach((function(e){e.innerHTML=""}));var l=0;if(newnode.querySelectorAll("select").forEach((t=>{previous_val=e.getElementsByTagName("select")[l].selectedIndex,t.options[previous_val].style.display="none",t._niceselect.update(),t.nextSibling.querySelector(".current").textContent="Select an option",l++})),null==e.querySelector(".remove")){var n=newnode.querySelector(".add"),o='<button type="button" class="'+n.className.replace("add","remove")+'" id="'+n.id.replace("add","remove")+'" style="flex: 1;">'+n.textContent.replace("Add","Remove this").replace("an","").replace("+","-")+"</button>";e.querySelector(".buttonwrapper").insertAdjacentHTML("beforeend",o),newnode.querySelector(".buttonwrapper").insertAdjacentHTML("beforeend",o)}return e.parentNode.insertBefore(newnode,e.nextSibling),newnode}function o(e){e.querySelectorAll(":scope > .clone_div").forEach(((e,t)=>{""!=e.id&&(e.id=e.id.replace(re,"$1"+t+"$2")),null!=e.dataset.divid&&(e.dataset.divid=t),e.querySelectorAll("h3").forEach((e=>{e.textContent=e.textContent.replace(/([0-9])/g,t+1)})),e.querySelectorAll("label, legend").forEach((e=>{e.innerHTML=e.innerHTML.replace(/ ([0-9])/g," "+(t+1))})),e.querySelectorAll("input,select,textarea").forEach((e=>{e.classList.contains("nice-select-search")||(""!=e.id&&null!=e.id&&(e.id=e.id.replace(re,"$1"+t+"$2")),""!=e.name&&null!=e.name&&(e.name=e.name.replace(re,"$1"+t+"$2")),"button"==e.type&&(e.value=e.value.replace(/[0-9]/g,t)))}))}))}function a(){document.querySelectorAll(".clone_divs_wrapper").forEach((function(e){var t=e.querySelectorAll(".clone_div");1==t.length&&t[0].querySelectorAll(".remove").forEach((e=>e.remove())),t.forEach((function(e,t,r){e.dataset.divid=t,t!=r.length-1&&e.querySelectorAll(".add").forEach((e=>e.remove()))}))}))}function c(e,t){if(void 0!==t){if(0==e){var r=t.querySelector(".formsteploader");null!=r&&(r.classList.add("hidden"),t.querySelector(".multistepcontrols").classList.remove("hidden"))}if(t.querySelectorAll(".formstep:not(.stephidden)").forEach((e=>e.classList.add("stephidden"))),0==(l=t.getElementsByClassName("formstep")).length)return;var l,n=l[e].offsetTop-document.querySelector("#masthead").offsetHeight;window.scrollTo({top:n,behavior:"auto"}),l[e].classList.remove("stephidden"),t.querySelectorAll(".step.active").forEach((e=>{e.classList.remove("active")})),(l=t.getElementsByClassName("step"))[e].classList.add("active"),0==e?t.querySelector('[name="prevBtn"]').classList.add("hidden"):t.querySelector('[name="prevBtn"]').classList.remove("hidden"),e==l.length-1?(t.querySelector('[name="nextBtn"]').classList.add("hidden"),t.querySelector(".form_submit").classList.remove("hidden")):(t.querySelector('[name="nextBtn"]').classList.remove("hidden"),t.querySelector(".form_submit").classList.add("hidden"))}else console.log("no form defined")}function i(e){var t=form.getElementsByClassName("formstep"),r=form.getElementsByClassName("step");if(form.querySelectorAll("[required]").forEach((e=>{e.required=!1})),e>0){if(t[currentTab].querySelectorAll(".required:not(.hidden) input, .required:not(.hidden) textarea, .required:not(.hidden) select").forEach((e=>{e.required=!0})),form.reportValidity(),0==form.checkValidity())return;r[currentTab].classList.add("finish")}else r[currentTab].classList.remove("finish");for(Array.from(t).forEach(((e,t)=>{e.classList.contains("hidden")&&r[t].classList.add("hidden")})),currentTab+=e;t[currentTab].classList.contains("hidden");)currentTab+=e;if(currentTab>=t.length)return!1;c(currentTab,form)}function d(e,t=!0,r=null,l=!1){if(e instanceof Element?(el=e,"INPUT"!=el.tagName&&"TEXTAREA"!=el.tagName&&"SELECT"!=el.tagName&&null==el.closest(".nice-select-dropdown")&&(el=el.querySelector("input, select, textarea")),null==el&&(el=e),name=el.name):(name=e,el=form.querySelector('[name="'+name+'" i]')),null!=el){var n="";if("radio"==el.type&&(el=form.querySelector('[name="'+name+'" i]:checked'),null==el))return"";if("checkbox"==el.type){if("checkbox"==e.type)return el.checked?el.value:"";null!=r?(els=form.querySelector('[name="'+name+'" i][value="'+r+'" i]:checked'),null!=els&&(n=r)):(els=form.querySelectorAll('[name="'+name+'" i]:checked'),els.forEach((e=>{""!=n&&(n+=", "),n+=e.value})))}else if(null!=el.closest(".nice-select-dropdown")&&null!=el.dataset.value)n=el.dataset.value;else if(null!=el.list&&t){var o=el.list.querySelector("[value='"+el.value+"' i]");(null==o||""==(n=o.dataset.value))&&(n=el.value)}else"checkbox"==el.type?n=el.checked?el.value:"":null!=el.value&&"undefined"!=el.value&&(n=el.value);return l?n.toLowerCase():n}console.trace(),console.log("cannot find element with name "+name)}function s(e,t,r){if(e instanceof Element)var l=e.name,n=e;else l=e,n=form.querySelector('[name="'+l+'" i]');if("radio"==n.type||"checkbox"==n.type){if(!(e instanceof Element)){targets=form.querySelectorAll('[name="'+l+'" i]');for(let e=0;e<targets.length;e++)if(targets[e].value.toLowerCase()==t.toLowerCase()){n=targets[e];break}}n.value.toLowerCase()==t.toLowerCase()&&(n.checked=!0)}else if(null!=n.list){var o=n.list.querySelector('[data-value="'+t+'" i]');n.value=null!=o?o.value:t}else n.value=t;prev_el="",evt=new Event("input"),n.dispatchEvent(evt),r(n)}function u(e,t,r,l){var n=form.querySelector('[name="'+e+'" i]');form.querySelector('[name="'+e+'"]')[t]=r,prev_el="",evt=new Event("input"),n.dispatchEvent(evt),l(n)}return e.r(t),e.d(t,{removeDefaultSelect:()=>r,cloneNode:()=>l,tidyMultiInputs:()=>a,showTab:()=>c,nextPrev:()=>i,getFieldValue:()=>d,changeFieldValue:()=>s,changeFieldProperty:()=>u}),document.addEventListener("DOMContentLoaded",(function(){console.log("Forms.js is loaded")})),window.addEventListener("online",(function(){document.querySelectorAll(".form_submit").forEach((e=>{e.disabled=!1,e.querySelectorAll(".offline").forEach((e=>e.remove()))}))})),window.addEventListener("offline",(function(){document.querySelectorAll(".form_submit").forEach((e=>{e.disabled=!0,null==e.querySelector(".online")&&(e.innerHTML='<div class="online">'+e.innerHTML+"</div>"),e.innerHTML+='<div class="offline">You are offline</div>'}))})),document.addEventListener("click",(function(e){var t=e.target;if(t.matches(".add")){var r=n(t.closest(".clone_div"));o(t.closest(".clone_divs_wrapper")),r.querySelectorAll(".wp-editor-area").forEach((e=>{window.tinyMCE.execCommand("mceAddEditor",!1,e.id)})),t.remove()}if(t.matches(".remove")){var l=t.closest(".clone_divs_wrapper");!function(e){var t=e.closest(".clone_div"),r=t.closest(".clone_divs_wrapper"),l=r.querySelectorAll(".clone_div");if(l[l.length-1]==t){var n=t.querySelector(".add");t.previousElementSibling.querySelector("div").appendChild(n)}if(null!=t.getAttribute("data-type")){var o=t.getAttribute("data-type").replace("[","\\[").replace("]","\\]");re=new RegExp("("+o+"?\\]?\\[).*[0-9](.*)","g")}else re=new RegExp("(.*)[0-9](.*)","g");t.remove(),1==(l=r.querySelectorAll(".clone_div")).length&&r.querySelector(".remove").remove(),nodenr=parseInt(l[0].dataset.divid),l.forEach((function(e){"understudies"==e.dataset.type&&e.querySelectorAll(".upload-files").forEach((function(e){e.dataset.index=nodenr})),""!=e.id&&(e.id=e.id.replace(re,"$1"+nodenr+"$2")),e.dataset.divid=nodenr,e.querySelectorAll("h3").forEach((e=>{e.textContent=e.textContent.replace(/[0-9]/g,nodenr)})),e.querySelectorAll("label").forEach((e=>{0==l[0].dataset.divid?labelnr=nodenr+1:labelnr=nodenr,e.innerHTML=e.innerHTML.replace(/ ([0-9])/g,(function(e){return" "+labelnr}))})),e.querySelectorAll("input,select,textarea").forEach((e=>{""!=e.id&&(e.id=e.id.replace(re,"$1"+nodenr+"$2")),e.name=e.name.replace(re,"$1"+nodenr+"$2")})),nodenr+=1}))}(t),o(l)}t.matches('.sim_form [name="submit_form"]')&&async function(e){var t=e.closest("form"),r=await submitForm(e,"forms/save_form_input");r&&(e.closest(".submit_wrapper").querySelector(".loadergif").classList.add("hidden"),display_message(r),"true"==t.dataset.reset&&formReset(t))}(t)})),t})()}));
//# sourceMappingURL=forms.min.js.map