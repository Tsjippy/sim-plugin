!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FormFunctions=t():e.FormFunctions=t()}(self,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){Array.from(e.options).forEach((function(e){e.defaultSelected=!1}))}e.r(t),e.d(t,{changeFieldProperty:()=>f,changeFieldValue:()=>m,cloneNode:()=>l,copyFormInput:()=>n,fixNumbering:()=>a,getFieldValue:()=>u,nextPrev:()=>d,removeDefaultSelect:()=>o,removeNode:()=>c,showTab:()=>s,tidyMultiInputs:()=>i});let r=[];function l(e,t=!0){!function(e){e.querySelectorAll("select").forEach((e=>{-1!=e.selectedIndex&&(e.options[e.selectedIndex].defaultSelected||o(e)),e.selectedOptions.length>0&&(e.selectedOptions[0].defaultSelected=!0),e._niceselect.destroy()})),"undefined"!=typeof tinymce&&e.querySelectorAll(".wp-editor-area").forEach((e=>{let t=tinymce.get(e.id);null!=t&&(r[e.id]=t.settings,t.save(),t.remove())}))}(e);let l=e.cloneNode(!0);return e.querySelectorAll("select").forEach((e=>{e._niceselect=NiceSelect.bind(e,{searchable:!0}),""==e.value&&e._niceselect.clear()})),e.querySelectorAll(".wp-editor-area").forEach((e=>{tinymce.init(r[e.id])})),t?l.querySelectorAll("input,select,textarea").forEach((e=>{"checkbox"==e.type||"radio"==e.type?e.checked=!1:"hidden"!=e.type&&(e.value=""),"select-one"==e.type&&(o(e),e._niceselect=NiceSelect.bind(e,{searchable:!0}),e._niceselect.clear())})):l.querySelectorAll("select").forEach((e=>{e._niceselect=NiceSelect.bind(e,{searchable:!0})})),l}function n(e){let t=l(e);t.querySelectorAll(".upload-files").forEach((function(e){e.dataset.index=nodeNr})),t.querySelectorAll(".documentpreview").forEach((function(e){e.innerHTML=""}));let o=0;if(t.querySelectorAll("select").forEach((t=>{let r=e.getElementsByTagName("select")[o].selectedIndex;t.options[r].style.display="none",t._niceselect.update(),t.nextSibling.querySelector(".current").textContent="Select an option",o++})),null==e.querySelector(".remove")){let o=t.querySelector(".add"),r=`<button type="button" class="${o.className.replace("add","remove")}" id="${o.id.replace("add","remove")}" style="flex: 1;">${o.textContent.replace("Add","Remove this").replace("an","").replace("+","-")}</button>`;e.querySelector(".buttonwrapper").insertAdjacentHTML("beforeend",r),t.querySelector(".buttonwrapper").insertAdjacentHTML("beforeend",r)}return e.parentNode.insertBefore(t,e.nextSibling),t}function a(e){e.querySelectorAll(":scope > .clone_div").forEach(((e,t)=>{""!=e.id&&(e.id=e.id.replace(/(\d)/g,t)),null!=e.dataset.divid&&(e.dataset.divid=t),e.querySelectorAll("h3, h4").forEach((e=>{e.textContent=e.textContent.replace(/(\d)/g,t+1)})),e.querySelectorAll("legend").forEach((e=>{e.innerHTML=e.innerHTML.replace(/ (\d)/g," "+(t+1))})),e.querySelectorAll("input,select,textarea").forEach((e=>{e.classList.contains("nice-select-search")||(""!=e.id&&null!=e.id&&(e.id=e.id.replace(/(\d)/g,t)),""!=e.name&&null!=e.name&&(e.name=e.name.replace(/(\d)/g,t)),"button"==e.type&&(e.value=e.value.replace(/\d/g,t)))}))}))}function c(e){let t=e.closest(".clone_div"),o=t.closest(".clone_divs_wrapper"),r=o.querySelectorAll(".clone_div");if(r[r.length-1]==t){let e=t.querySelector(".add");t.previousElementSibling.querySelector(".buttonwrapper").appendChild(e)}t.remove(),1==o.querySelectorAll(".clone_div").length&&o.querySelector(".remove").remove(),a(o)}function i(){document.querySelectorAll(".clone_divs_wrapper").forEach((function(e){let t=e.querySelectorAll(".clone_div");1==t.length&&t[0].querySelectorAll(".remove").forEach((e=>e.remove())),t.forEach((function(e,t,o){e.dataset.divid=t,t!=o.length-1&&e.querySelectorAll(".add").forEach((e=>e.remove()))}))}))}function s(e,t){if(void 0!==t){if(0==e){let e=t.querySelector(".formsteploader");null!=e&&(e.classList.add("hidden"),t.querySelector(".multistepcontrols").classList.remove("hidden"))}t.querySelectorAll(".formstep:not(.stephidden)").forEach((e=>e.classList.add("stephidden")));let o=t.getElementsByClassName("formstep");if(0==o.length)return;let r=o[e].offsetTop-document.querySelector("#masthead").offsetHeight;window.scrollTo({top:r,behavior:"auto"}),o[e].classList.remove("stephidden"),t.querySelectorAll(".step.active").forEach((e=>{e.classList.remove("active")})),o=t.getElementsByClassName("step"),o[e].classList.add("active"),0==e?t.querySelector('[name="prevBtn"]').classList.add("hidden"):t.querySelector('[name="prevBtn"]').classList.remove("hidden"),e==o.length-1?(t.querySelector('[name="nextBtn"]').classList.add("hidden"),t.querySelector(".form_submit").classList.remove("hidden")):(t.querySelector('[name="nextBtn"]').classList.remove("hidden"),t.querySelector(".form_submit").classList.add("hidden"))}else console.log("no form defined")}function d(e){let t,o=form.querySelectorAll(".formstep"),r=form.querySelectorAll(".step"),l=0;if(o.forEach(((e,t)=>{e.matches(".stephidden")||(l=t)})),e>0){let e=o[l].querySelectorAll(".required:not(.hidden) input, .required:not(.hidden) textarea, .required:not(.hidden) select");for(const o of e)if(o.required=!0,t=o.reportValidity(),!t)break;if(!t)return;r[l].classList.add("finish")}else r[l].classList.remove("finish");for(Array.from(o).forEach(((e,t)=>{e.classList.contains("hidden")&&r[t].classList.add("hidden")})),l+=e;o[l].classList.contains("hidden");)l+=e;if(l>=o.length)return!1;s(l,form)}function u(e,t,o=!0,r=null,l=!1){let n="",a="",c="";return e instanceof Element?(n=e,"INPUT"!=n.tagName&&"TEXTAREA"!=n.tagName&&"SELECT"!=n.tagName&&null==n.closest(".nice-select-dropdown")&&(n=n.querySelector("input, select, textarea")),null==n&&(n=e),a=n.name):(a=e,n=t.querySelector(`[name='${a}' i]`)),null==n?(console.trace(),console.log("cannot find element with name "+a),c):("radio"==n.type?c=function(e,t){let o=e.querySelector(`[name='${t}' i]:checked`);return null==o?"":o.value}(t,a):"checkbox"==n.type?c=function(e,t,o,r){let l="",n="";return"checkbox"==r.type?r.checked?r.value:"":(null!=o?(n=e.querySelector(`[name='${t}' i][value="${o}" i]:checked`),null!=n&&(l=o)):(n=e.querySelectorAll(`[name="${t}" i]:checked`),n.forEach((e=>{""!=l&&(l+=", "),l+=e.value}))),l)}(t,a,r,e):null!=n.closest(".nice-select-dropdown")&&null!=n.dataset.value?c=n.dataset.value:null!=n.list&&o?c=function(e){let t="",o=e.list.querySelector("[value='"+e.value+"' i]");return null==o?t=e.value:(t=o.dataset.value,""==t&&(t=e.value)),t}(n):null!=n.value&&"undefined"!=n.value&&(c=n.value),l?c.toLowerCase():c)}function m(e,t,o){let r="",l="";if(e instanceof Element?(r=e.name,l=e):(r=e,l=form.querySelector(`[name="${r}" i]`)),"radio"==l.type||"checkbox"==l.type)e instanceof Element||(l=function(e,t,o){let r=e.querySelectorAll(`[name="${t}" i]`);for(const e of r)if(e.value.toLowerCase()==o.toLowerCase())return e}(form,r,t)),l.value.toLowerCase()==t.toLowerCase()&&(l.checked=!0);else if(null!=l.list){let e=l.list.querySelector(`[data-value="${t}" i]`);l.value=null!=e?e.value:t}else l.value=t;let n=new Event("input");l.dispatchEvent(n),o(l)}function f(e,t,o,r){let l=form.querySelector(`[name="${e}" i]`);form.querySelector(`[name="${e}"]`)[t]=o;let n=new Event("input");l.dispatchEvent(n),r(l)}async function h(e){let t=e.closest(".form.table-wrapper"),o=e.outerHTML,r=new FormData,l=t.querySelector(".sim-table.form-data-table").dataset.formid,n=t.querySelector(".sim-table.form-data-table").dataset.shortcodeid;r.append("formid",l),r.append("id",n);const a=new URL(window.location);a.searchParams.get("onlyown")&&r.append("onlyown",!0),a.searchParams.get("archived")&&r.append("archived",!0);let c=Main.showLoader(e,!1,"Requesting form results...");t.innerHTML=c.outerHTML;let i=await FormSubmit.fetchRestApi("forms/show_form_results",r);i?t.innerHTML=i:c.outerHTML=o}return document.addEventListener("DOMContentLoaded",(function(){console.log("Forms.js is loaded")})),window.addEventListener("online",(function(){document.querySelectorAll(".form_submit").forEach((e=>{e.disabled=!1,e.querySelectorAll(".offline").forEach((e=>e.remove()))}))})),window.addEventListener("offline",(function(){document.querySelectorAll(".form_submit").forEach((e=>{e.disabled=!0,null==e.querySelector(".online")&&(e.innerHTML='<div class="online">'+e.innerHTML+"</div>"),e.innerHTML+='<div class="offline">You are offline</div>'}))})),document.addEventListener("click",(function(e){let t=e.target;if(t.matches(".add")){let e=n(t.closest(".clone_div"));a(t.closest(".clone_divs_wrapper")),e.querySelectorAll(".wp-editor-area").forEach((e=>{window.tinyMCE.execCommand("mceAddEditor",!1,e.id)})),t.remove()}t.matches(".remove")&&c(t),t.matches('.sim_form [name="submit_form"]')&&(e.stopPropagation(),async function(e){let t=e.closest("form"),o=await FormSubmit.submitForm(e,"forms/save_form_input");o&&(e.closest(".submit_wrapper").querySelector(".loadergif").classList.add("hidden"),Main.displayMessage(o),"true"==t.dataset.reset&&FormSubmit.formReset(t))}(t)),(t.matches(".formbuilder-switch")||t.matches(".formbuilder-switch-back"))&&async function(e){let t,o=e.closest(".sim_form.wrapper"),r=e.outerHTML,l=new FormData;const n=new URL(window.location);e.matches(".formbuilder-switch")?(l.append("formbuilder",!0),n.searchParams.set("formbuilder",!0),t=o.querySelector("form.sim_form").dataset.formid):(n.searchParams.delete("formbuilder"),t=o.querySelector('[name="formid"]').value),window.history.pushState({},"",n),l.append("formid",t);let a=Main.showLoader(e,!1,"Requesting form...");o.innerHTML=a.outerHTML;let c=await FormSubmit.fetchRestApi("forms/form_builder",l);c?o.innerHTML=c:a.outerHTML=r}(t),(t.matches(".archive-switch-hide")||t.matches(".archive-switch-show"))&&async function(e){const t=new URL(window.location);e.matches(".archive-switch-show")?t.searchParams.set("archived",!0):t.searchParams.delete("archived"),window.history.pushState({},"",t),h(e)}(t),(t.matches(".onlyown-switch-all")||t.matches(".onlyown-switch-on"))&&async function(e){const t=new URL(window.location);e.matches(".onlyown-switch-on")?t.searchParams.set("onlyown",!0):t.searchParams.delete("onlyown"),window.history.pushState({},"",t),h(e)}(t)})),t})()));
//# sourceMappingURL=forms.min.js.map