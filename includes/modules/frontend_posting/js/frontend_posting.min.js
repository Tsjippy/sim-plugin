(()=>{function e(e="refresh_post_lock"){var t=new XMLHttpRequest;t.open("POST",sim.ajax_url,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");var a=document.getElementById("post_id");null!=a&&t.send("action="+e+"&postid="+a.value)}function t(e){var t=e.closest("#frontend_upload_form"),a=t.querySelector('[name="submit_post"]'),o=e.value;switch(t.querySelector('[name="post_type"]').value=o,t.querySelectorAll(".replaceposttype").forEach((function(e){e.textContent=o})),null!=tinymce.activeEditor&&""!=tinymce.activeEditor.getContent()||(t.querySelectorAll(".lite").forEach((function(e){e.classList.remove("hidden")})),t.querySelector("#showallfields").classList.add("hidden")),t.querySelectorAll("#wp-post_content-media-buttons, .advancedpublishoptions, #advancedpublishoptionsbutton").forEach((e=>e.classList.remove("hidden"))),o){case"page":t.querySelectorAll(".page:not(.page-template-default)").forEach((e=>e.classList.remove("hidden"))),t.querySelectorAll(".post:not(.page), .recipe, .event, .location, .attachment").forEach((e=>e.classList.add("hidden")));break;case"post":t.querySelectorAll(".post").forEach((e=>e.classList.remove("hidden"))),t.querySelectorAll(".page:not(.post, .page-template-default), .recipe, .event, .location, .attachment").forEach((e=>e.classList.add("hidden")));break;case"location":t.querySelectorAll(".location").forEach((e=>e.classList.remove("hidden"))),t.querySelectorAll(".page, .post, .recipe, .event, .attachment").forEach((e=>e.classList.add("hidden"))),null!=tinymce.activeEditor&&""!=tinymce.activeEditor.getContent()||(t.querySelectorAll(".lite").forEach((function(e){e.classList.add("hidden")})),t.querySelector("#showallfields").classList.remove("hidden"));break;case"event":t.querySelectorAll(".event").forEach((e=>e.classList.remove("hidden"))),t.querySelectorAll(".post, .page, .recipe, .location, .attachment").forEach((e=>e.classList.add("hidden")));break;case"recipe":t.querySelectorAll(".recipe").forEach((e=>e.classList.remove("hidden"))),t.querySelectorAll(".post, .page, .event, .location, .attachment").forEach((e=>e.classList.add("hidden")));break;case"attachment":t.querySelectorAll(".attachment").forEach((e=>e.classList.remove("hidden"))),t.querySelectorAll(".post, .page, .event, .location, .recipe, #wp-post_content-media-buttons, .advancedpublishoptions, #advancedpublishoptionsbutton").forEach((e=>e.classList.add("hidden")));break;default:a.textContent=a.textContent.replace("page","post")}}document.addEventListener("DOMContentLoaded",(function(){console.log("Frontendposting.js loaded");var a=document.getElementById("minutes");null!=a&&setInterval((function(){a.innerHTML=parseInt(a.innerHTML)+1}),6e4),e(),setInterval(e,6e4),window.onbeforeunload=function(){null==document.getElementById("post_lock_warning")&&e("delete_post_lock")},document.querySelector("#insert-media-button").addEventListener("click",(function(){void 0===wp.media.frame&&setTimeout((function(){wp.media.frame.on("insert",(function(e){var t=wp.media.frame.state().get("selection").first().toJSON();[".txt",".doc",".rtf"].some((e=>t.url.includes(e)))&&Swal.fire({title:"Question",text:"Do you want to insert the contents of this file into the post?",icon:"question",showCancelButton:!0,confirmButtonColor:"#bd2919",cancelButtonColor:"#d33",confirmButtonText:"Yes please",cancelButtonText:"No thanks",hideClass:{popup:""}}).then((e=>{var a,o;Swal.fire({title:"Please wait...",html:"<IMG src='"+sim.loading_gif+"' width=100 height=100>",showConfirmButton:!1,showClass:{backdrop:"swal2-noanimation",popup:"",icon:""}}),e.isConfirmed&&(a=t.id,(o=new FormData).append("attachment_id",a),o.append("_wpnonce",sim.restnonce),fetch(sim.base_url+"/wp-json/sim/v1/frontendposting/get_attachment_contents",{method:"POST",credentials:"same-origin",body:o}).then((e=>e.json())).then((e=>{var t=tinyMCE.activeEditor.getContent();tinymce.activeEditor.setContent(t+e),Swal.close()})).catch((e=>console.error(e))))}))}))}),100)})),location.search.includes("?type")&&t(document.querySelector("#post_type_selector"))})),document.addEventListener("click",(e=>{var t=e.target;if(t.name,"add-featured-image"==t.name&&function(e){e.preventDefault();var t=e.target.closest("#frontend_upload_form");"object"!=typeof file_frame?(file_frame=wp.media.frames.file_frame=wp.media({title:"Select featured image",button:{text:"Save featured image"},multiple:!1}),file_frame.on("select",(function(){attachment=file_frame.state().get("selection").first().toJSON(),t.querySelector('[name="post_image_id"]').value=attachment.id;var e=t.querySelector("#featured-image-div");null!=e.querySelector("img")&&e.querySelector("img").remove(),e.insertAdjacentHTML("beforeEnd",'<img width="150" height="150" src="'+attachment.url+'">'),e.classList.remove("hidden"),t.querySelectorAll('[name="add-featured-image"]').forEach((function(e){e.innerHTML=e.innerHTML.replace("Add","Replace")}));var a=document.querySelector("#mec_fes_thumbnail");null!=a&&(a.value=attachment.url)})),file_frame.open()):file_frame.open()}(e),"showallfields"==t.id&&function(e){var t=e.closest("#frontend_upload_form");t.querySelector("#showallfields").classList.contains("show")?(t.querySelectorAll(".lite").forEach((function(e){e.classList.remove("hidden")})),e.classList.remove("show"),e.classList.add("hide"),e.textContent="Only show required fields"):(t.querySelectorAll(".lite").forEach((function(e){e.classList.add("hidden")})),e.classList.add("show"),e.classList.remove("hide"),e.textContent="Show all fields")}(t),"delete_post"==t.name&&function(e){e.preventDefault(),parent=e.target.closest("#frontend_upload_form"),Swal.fire({title:"Are you sure?",text:"Are you sure you want to remove this "+frontendpost.post_type+"?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((t=>{if(t.isConfirmed){var a=parent.querySelector('[name="post_id"]').value,o=parent.querySelector('[name="deletepost_nonce_'+a+'"]').value;e.target.closest("form").querySelector(".loadergif").classList.remove("hidden");var r=new FormData;r.append("action","remove_post"),r.append("post_id",a),r.append("deletepost_nonce_"+a,o),sendAJAX(r)}}))}(e),t.classList.contains("add_cat")&&document.getElementById("add_"+t.dataset.type+"_type").classList.remove("hidden"),t.classList.contains("savedraft")&&(t.closest("form").querySelector('[name="action"]').value="draft_post",submit_form(e)),"advancedpublishoptionsbutton"==t.id&&((a=t.closest("form").querySelector(".advancedpublishoptions")).classList.contains("hidden")?(a.classList.remove("hidden"),t.querySelector("span").textContent="Hide"):(a.classList.add("hidden"),t.querySelector("span").textContent="Show")),"signal"==t.name){var a=t.closest("#signalmessage").querySelector(".signalmessagetype");t.checked?a.classList.remove("hidden"):a.classList.add("hidden")}if("enable_event_repeat"==t.name){document.querySelector(".repeat_wrapper").classList.toggle("hidden");var o=t.parentNode.querySelector('[name="event[repeated]"]');"yes"==o.value?o.value="":o.value="yes"}t.classList.contains("selectall")&&t.closest(".selector_wrapper").querySelectorAll('input[type="checkbox"]').forEach((e=>e.checked=t.checked)),"event[repeat][repeat_type]"==t.name&&(t.closest(".event").querySelectorAll(".repeat_type_option").forEach((e=>{e.querySelector(".repeat_type_option_specifics").classList.add("hidden")})),t.closest(".repeat_type_option").querySelector(".repeat_type_option_specifics").classList.remove("hidden")),null!=t.closest(".repeat_type_option")&&(document.querySelectorAll(".repeat_type_option_specifics:not(.hidden)").forEach((e=>e.classList.add("hidden"))),t.closest(".repeat_type_option").querySelector(".repeat_type_option_specifics").classList.remove("hidden")),t.matches(".add_category .form_submit")&&async function(e){var t=await submitForm(e.closest("form"),"frontendposting/add_category");if(t){var a=e.closest("form").querySelector('[name="cat_parent"]').value,o=e.closest("form").querySelector('[name="post_type"]').value,r=e.closest("form").querySelector('[name="cat_name"]').value;if(""==a)var l=document.getElementById(o+"_parenttypes"),n="";else{l=document.getElementById(o+"_childtypes"),n='data-parent="'+a+'"';var c=document.querySelector("."+o+'type[value="'+a+'"]');0==c.checked&&c.click()}var s=`\n\t\t<div class="infobox" ${n}>\n\t\t\t<input type="checkbox" class="${o}type" id="${o}type[]" value="${t.id}" checked>\n\t\t\t<label class="option-label category-select">${r}</label>\n\t\t</div>\n\t\t`;l.insertAdjacentHTML("afterBegin",s),hide_modals(),display_message(`Succesfully added the ${r} category`)}}(t)})),document.addEventListener("change",(e=>{var a,o=e.target;if("post_type_selector"==o.id&&t(o),null!=o.list){var r=o.list.querySelector("[value='"+o.value+"' i]");if(null!=r)var l=r.dataset.value;var n=o.closest("label").querySelector(".datalistvalue");null!=n&&(n.value=l)}if(o.classList.contains("parent_cat")&&function(e){var t=e.closest(".infobox").dataset.parent,a=e.closest(".categories");1==e.checked?a.querySelectorAll("[data-parent='"+e.value+"']").forEach((e=>{e.classList.remove("hidden"),a.querySelector("#subcategorylabel").classList.remove("hidden")})):null==t&&null==a.querySelector('.childtypes input[type="checkbox"]:checked')&&(a.querySelector("#subcategorylabel").classList.add("hidden"),a.querySelectorAll("[data-parent='"+e.value+"']").forEach((e=>{e.classList.add("hidden")})))}(o),"event[allday]"==o.name){var c=o.closest(".event").querySelector('[name="event[starttime]"]'),s=o.closest(".event").querySelector('[name="event[endtime]"]'),i=o.closest(".event").querySelector('[name="enddate_label"]');o.checked?(c.classList.add("hidden"),s.classList.add("hidden"),i.classList.add("hidden"),c.value="00:00",s.value="23:59"):(c.classList.remove("hidden"),s.classList.remove("hidden"),i.classList.remove("hidden"),c.value="",s.value="")}if("event[startdate]"==o.name){i=o.closest(".event").querySelector('[name="event[enddate]"]');var d=new Date(o.value),u=new Date(i.value);(""==i.value||d>u)&&(i.value=o.value);var p=new Date(d.getFullYear(),d.getMonth(),1).getDay(),h=d.getDate()+p-1,y=Math.floor(h/7);document.querySelectorAll('.weeks [name="event[repeat][weeks][]"]')[y].checked=!0,document.querySelector(".repeatdatetype span.monthday").textContent=d.getUTCDate()}if("event[repeat][type]"==o.name)switch((a=o.closest(".repeat_wrapper")).querySelectorAll(".hide").forEach((e=>e.classList.replace("hide","hidden"))),o.value){case"daily":a.querySelectorAll(".repeatinterval, .day_selector, .day_selector h4.checkbox, .day_selector .selectall_wrapper").forEach((e=>e.classList.replace("hidden","hide"))),a.querySelector("#repeattype").textContent="days",a.querySelectorAll('.day_selector input[type="radio"]').forEach((e=>e.type="checkbox"));break;case"weekly":a.querySelectorAll(".repeatinterval, .weeks, .weeks h4.checkbox, .weeks .selectall_wrapper").forEach((e=>e.classList.replace("hidden","hide"))),a.querySelector("#repeattype").textContent="week(s)",a.querySelectorAll('.weeks input[type="radio"]').forEach((e=>e.type="checkbox"));break;case"monthly":a.querySelectorAll(".repeatdatetype").forEach((e=>e.classList.replace("hidden","hide"))),a.querySelector("#repeattype").textContent="month(s)",a.querySelector(".monthoryeartext").textContent="On a certain day and week of a month",a.querySelector(".monthoryear").textContent="a month";break;case"yearly":a.querySelectorAll(".repeatdatetype").forEach((e=>e.classList.replace("hidden","hide"))),a.querySelector("#repeattype").textContent="year(s)",a.querySelector(".monthoryeartext").textContent="On a certain day, week and month of a year",d=new Date(document.querySelector('[name="event[startdate]"]').value),a.querySelector(".monthoryear").textContent=d.toLocaleString("en",{month:"long"})+" every year";break;case"custom_days":a.querySelectorAll(".custom_dates_selector").forEach((e=>e.classList.replace("hidden","hide")))}"event[repeat][datetype]"==o.name&&((a=o.closest(".repeat_wrapper")).querySelectorAll(".repeatinterval, .day_selector, .weeks, .months").forEach((e=>e.classList.replace("hide","hidden"))),"samedate"==o.value?a.querySelectorAll(".repeatinterval").forEach((e=>e.classList.replace("hidden","hide"))):"monthly"==a.querySelector('[name="event[repeat][type]"]').value?(a.querySelectorAll(".day_selector, .weeks, .months, .months h4.checkbox, .day_selector h4.radio, .weeks h4.radio").forEach((e=>e.classList.replace("hidden","hide"))),a.querySelectorAll(".day_selector h4.checkbox, .weeks h4.checkbox").forEach((e=>e.classList.replace("hide","hidden"))),a.querySelectorAll('.months input[type="radio"]').forEach((e=>e.type="checkbox")),a.querySelectorAll('.day_selector input[type="checkbox"], .weeks input[type="checkbox"]').forEach((e=>e.type="radio"))):(a.querySelectorAll(".day_selector, .weeks, .months, .day_selector h4.radio, .weeks h4.radio, .months h4.radio").forEach((e=>e.classList.replace("hidden","hide"))),a.querySelectorAll(".day_selector h4.checkbox, .weeks h4.checkbox, .months h4.checkbox").forEach((e=>e.classList.replace("hide","hidden"))),a.querySelectorAll('.day_selector input[type="checkbox"], .weeks input[type="checkbox"], .months input[type="checkbox"]').forEach((e=>e.type="radio"))))}))})();
//# sourceMappingURL=frontend_posting.min.js.map