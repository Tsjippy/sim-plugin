(()=>{function e(e){document.querySelectorAll(".large-image:not(.hidden)").forEach((e=>e.classList.add("hidden"))),document.querySelector('.large-image[data-index="'+e+'"]').classList.remove("hidden")}async function t(t,a,l){var n=document.querySelector("#media-amount").value;if(n!=l){var d=[];document.querySelectorAll(".media-type-selector:checked").forEach((e=>d.push(e.value)));var o=new FormData;o.append("amount",n),o.append("page",document.querySelector("#paged").value),o.append("skipAmount",l),o.append("types",d),o.append("startIndex",t+1);var r=await fetchRestApi("media_gallery/load_more_media",o);if(document.querySelectorAll("#medialoaderwrapper:not(.hidden), .loaderwrapper:not(.hidden)").forEach((e=>e.classList.add("hidden"))),r){document.querySelector(".mediawrapper").insertAdjacentHTML("beforeEnd",r),a&&e(document.querySelector('[data-index="'+t+'"]').nextElementSibling.nextElementSibling.dataset.index);var i=document.querySelectorAll(".large-image");null==i[i.length-1].querySelector(".nextbtn")&&document.getElementById("loadmoremedia").classList.add("hidden")}else display_message("All media are loaded","info"),document.getElementById("loadmoremedia").classList.add("hidden")}}async function a(e){var t=document.querySelector("#media-amount").value,a=[];document.querySelectorAll(".media-type-selector:checked").forEach((e=>a.push(e.value)));var l=e.closest(".mediabuttons").querySelector(".searchtext").value,n=new FormData;n.append("amount",t),n.append("types",a),n.append("search",l);var d=await fetchRestApi("media_gallery/media_search",n);d?document.querySelector(".mediawrapper").innerHTML=d:display_message("Nothing found","warning")}console.log("Media galery js loaded"),document.querySelectorAll(".searchtext").forEach((e=>{e.addEventListener("keyup",(function(e){13===e.keyCode&&a(e.target)}))})),document.addEventListener("click",(async l=>{var n=l.target,d=n.closest(".large-image");if(n.matches(".media-item")&&(l.preventDefault(),l.stopPropagation(),e(n.closest(".cell").dataset.index)),n.matches(".closebtn")){d.classList.add("hidden");var o=d.querySelector("iframe");null!=o&&(o.src=o.src)}if(n.matches(".prevbtn")&&e((r=n.closest(".large-image")).previousElementSibling.previousElementSibling.dataset.index),n.matches(".nextbtn")){var r;if(null!=(i=(r=n.closest(".large-image")).nextElementSibling))var i=i.nextElementSibling;null==i?(document.getElementById("medialoaderwrapper").classList.remove("hidden"),document.getElementById("paged").value=parseInt(document.getElementById("paged").value)+1,t(r.dataset.index,!0)):e(i.dataset.index)}if("loadmoremedia"==n.id){l.preventDefault(),l.stopPropagation();var c=document.querySelectorAll(".cell");document.getElementById("paged").value=parseInt(document.getElementById("paged").value)+1,t(c[c.length-1].firstChild.dataset.index,!1),showLoader(n,!1)}if(n.matches(".buttonwrapper .description")&&display_message(n.dataset.description),n.matches(".media-type-selector"))if(n.checked){document.querySelectorAll(".cell."+n.value).forEach((e=>e.classList.remove("hidden")));var s=document.querySelectorAll(".cell:not(.hidden)");for(let e=document.querySelector("#media-amount").value;e<s.length;e++)s[e].remove()}else document.querySelectorAll(".cell."+n.value).forEach((e=>e.classList.add("hidden"))),c=document.querySelectorAll(".cell"),s=document.querySelectorAll(".cell:not(.hidden)"),t(c[c.length-1].dataset.index,!1,s.length);n.matches(".mediabuttons .search")&&(l.preventDefault(),l.stopPropagation(),a(n)),n.matches(".download")&&(l.preventDefault(),(await Swal.fire({title:"Warning",html:"Downloading of materials is only allowed for use in presentations. <br>You should not share this file with others as it may contain privacy sensitive information",showCancelButton:!0,confirmButtonText:"I promise not to share this file",confirmButtonColor:"#bd2919"})).isConfirmed&&(console.log(n.querySelector("a")),n.querySelector("a").click()))})),document.addEventListener("change",(e=>{var a=e.target;if("media-amount"==a.id){document.getElementById("paged").value=1;var l=document.querySelectorAll(".cell"),n=l.length;if(a.value>n)t(parseInt(l[l.length-1].dataset.index),!1,n);else if(a.value<n){var d=1;document.querySelectorAll(".cell, .large-image").forEach((e=>{d>a.value&&e.remove(),e.matches(".cell")&&d++}))}}}));var l=null,n=null;document.addEventListener("touchstart",(function(e){const t=e.touches[0];l=t.clientX,n=t.clientY})),document.addEventListener("touchmove",(function(t){if(l&&n){var a=t.touches[0].clientX,d=t.touches[0].clientY,o=l-a,r=n-d;if(Math.abs(o)>Math.abs(r)){var i=document.querySelector(".large-image:not(.hidden)");if(o>0)var c=i.nextElementSibling.nextElementSibling;else c=i.previousElementSibling.previousElementSibling;e(c.dataset.index)}l=null,n=null}}))})();
//# sourceMappingURL=media_gallery.min.js.map