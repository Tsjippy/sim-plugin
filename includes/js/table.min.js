!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SimTableFunctions=t():e.SimTableFunctions=t()}(self,(()=>(()=>{"use strict";var e={d:(t,l)=>{for(var n in l)e.o(l,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:l[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};let l;function n(e){null!=e.target.closest("td")&&e.target.closest("td").matches(".editing")||(e.stopPropagation(),document.removeEventListener("click",n),a(e,document.querySelector(".editing input, .editing select, .editing textarea")))}function o(e){e.closest("td").classList.add("editing"),l=e.textContent,"Click to update"!=l&&"X"!=l||(l=""),e.innerHTML=`<input type="text" value="${l}">`,function(e){let t=e.querySelectorAll("input,select,textarea");t.forEach((e=>{l.split(",").forEach((t=>{"checkbox"==e.type||"radio"==e.type?e.value==t.trim()&&(e.checked=!0):"select"==e.type?e.querySelector('option[value="'+t+'"]').selected=!0:e.value=l})),"select-one"==e.type&&(e._niceselect=NiceSelect.bind(e,{searchable:!0})),e.addEventListener("keyup",(function(e){13===e.keyCode&&a(e)})),document.addEventListener("click",n),"checkbox"==e.type&&1!=t.length||("date"==e.type?e.addEventListener("blur",(function(e){""!=e.target.value&&a(e)})):e.addEventListener("change",(function(e){""!=e.target.value&&a(e)})),e.focus())}))}(e)}async function a(e,t){void 0===t&&(t=e.target);let n=t.closest("td"),o=function(e,t,l=!0,n=null,o=!1){let a="",s="",c="";return e instanceof Element?(a=e,"INPUT"!=a.tagName&&"TEXTAREA"!=a.tagName&&"SELECT"!=a.tagName&&null==a.closest(".nice-select-dropdown")&&(a=a.querySelector("input, select, textarea")),null==a&&(a=e),s=a.name):(s=e,a=t.querySelector(`[name='${s}' i]`)),null==a?(console.trace(),console.log("cannot find element with name "+s),c):("radio"==a.type?c=function(e,t){let l=e.querySelector(`[name='${t}' i]:checked`);return null==l?"":l.value}(t,s):"checkbox"==a.type?c=function(e,t,l,n){let o="",a="";return"checkbox"==n.type?n.checked?n.value:"":(null!=l?(a=e.querySelector(`[name='${t}' i][value="${l}" i]:checked`),null!=a&&(o=l)):(a=e.querySelectorAll(`[name="${t}" i]:checked`),o=[],a.forEach((e=>{o.push(e.value)}))),o)}(t,s,n,e):null!=a.closest(".nice-select-dropdown")&&null!=a.dataset.value?c=a.dataset.value:null!=a.list&&l?c=function(e){let t="",l=e.list.querySelector("[value='"+e.value+"' i]");return null==l?t=e.value:(t=l.dataset.value,""==t&&(t=e.value)),t}(a):null!=a.value&&"undefined"!=a.value&&(c=a.value),o?c.toLowerCase():c)}(t,n,!1),a=t.closest("table");if(o!=l){let e=new FormData;e.append("value",JSON.stringify(o));for(let t in n.dataset)e.append(t,n.dataset[t]);for(let l in t.closest("tr").dataset)e.append(l,t.closest("tr").dataset[l]);Main.showLoader(n.firstChild),await FormSubmit.fetchRestApi(a.dataset.url,e)&&(n.innerHTML=o)}else console.log(o),t.closest("td").innerHTML=l;n.classList.remove("editing")}function s(){document.querySelectorAll(".sim-table").forEach((function(e){let t=[];e.querySelectorAll("thead th").forEach(((e,l)=>{null!=e.dataset.nicename?t[l]=e.dataset.nicename:t[l]=e.textContent})),e.querySelectorAll("tbody td").forEach((e=>{e.hasAttribute("label")||e.setAttribute("label",t[e.cellIndex]),"X"!=e.textContent&&""!=e.textContent||e.classList.add("mobile-hidden")}))}))}function c(e){e.textContent="Close full screen",e.classList.replace("show","close");let t=e.closest(".table-wrapper");window.lastY=window.pageYOffset,window.scrollTo(0,0),console.log("scrolling"),document.querySelector("body").style.overflow="hidden",document.querySelector("header").style.zIndex="unset",t.classList.add("fullscreen"),t.style.marginLeft="0px";let l=new URL(window.location);l.searchParams.set("fullscreen",t.querySelector("table").dataset.formid),window.history.pushState({},"",l),t.requestFullscreen()}function r(){document.querySelectorAll(".table-wrapper").forEach((e=>{let t="",l=0,n=e.querySelector("table");if(null==n)return;let o=n.scrollWidth;if(0!=o){if(window.innerWidth<570)t=e.getBoundingClientRect().x;else{let n=window.innerWidth-o;o/window.innerWidth<.7?null!=document.querySelector(".is-right-sidebar")&&(n=.7*window.innerWidth-o):(document.getElementById("primary").style.zIndex=1,document.querySelectorAll("#right-sidebar").forEach((e=>e.style.zIndex=0))),l=n<20?10:n/2,""!=e.style.marginLeft&&(e.style.marginLeft="-0px"),t=parseInt(e.getBoundingClientRect().x)-l}e.style.marginLeft=`-${t}px`}}))}return e.r(t),e.d(t,{positionTable:()=>r,setTableLabel:()=>s}),document.addEventListener("click",(e=>{let t=e.target;"TH"==t.tagName&&function(e){let t,l,n,o=e.closest("table"),a=!0;var s="asc";for(e.classList.contains("dsc")&&(s="dsc");a;){a=!1,n=o.rows;for(let o=1;o<n.length-1;o++){if(t=n[o].getElementsByTagName("TD")[e.cellIndex].innerHTML.toLowerCase(),l=n[o+1].getElementsByTagName("TD")[e.cellIndex].innerHTML.toLowerCase(),isNaN(t)||isNaN(l)){let e=new Date(t),n=new Date(l);"Invalid Date"===e||isNaN(e)||70==e.getYear()||"Invalid Date"===n||isNaN(n)||70==n.getYear()||(t=e.getTime(),l=n.getTime())}else t=parseFloat(t),l=parseFloat(l);("asc"==s&&t>l||"dsc"==s&&l>t)&&(n[o].parentNode.insertBefore(n[o+1],n[o]),a=!0)}}"asc"==s?e.classList.replace("asc","dsc"):e.classList.replace("dsc","asc")}(t);let l=t.closest("td");t.matches("td.edit")?(e.stopPropagation(),o(t)):null!=l&&l.matches("td.edit")&&"INPUT"!=t.tagName&&"A"!=t.tagName&&"TEXTAREA"!=t.tagName&&!t.closest(".nice-select")?(e.stopPropagation(),o(t.closest("td"))):t.matches(".show.fullscreenbutton")?c(t):t.matches(".close.fullscreenbutton")&&function(e){let t=100;e.textContent="Show full screen",e.classList.replace("close","show"),null!=window.lastY&&(t=window.lastY),window.scrollTo(0,t),console.log("scrolling"),document.querySelector("body").style.overflow="unset",document.querySelector("header").style.zIndex="99999",e.closest(".table-wrapper").classList.remove("fullscreen"),r();let l=new URL(window.location);l.searchParams.delete("fullscreen"),window.history.pushState({},"",l),document.exitFullscreen()}(t)})),document.addEventListener("DOMContentLoaded",(function(){console.log("Table.js loaded"),r(),window.addEventListener("resize",r),s();let e=new URLSearchParams(window.location.search).get("fullscreen");if(null!=e)try{c(document.querySelector(`table[data-formid="${e}"]`).closest(".table-wrapper").querySelector(".fullscreenbutton"))}catch{console.error(`table[data-formid="${e}"]`)}})),t})()));
//# sourceMappingURL=table.min.js.map