!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SimTableFunctions=t():e.SimTableFunctions=t()}(self,(function(){return(()=>{"use strict";var e,t={d:(e,n)=>{for(var a in n)t.o(n,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};function a(e){null!=e.target.closest("td")&&e.target.closest("td").matches(".editing")||(e.stopPropagation(),document.removeEventListener("click",a),r(e,document.querySelector(".editing input, .editing select, .editing textarea")))}function o(t){var n;t.closest("td").classList.add("editing"),"Click to update"!=(e=t.textContent)&&"X"!=e||(e=""),t.innerHTML=`<input type="text" value="${e}">`,(n=t.querySelectorAll("input,select,textarea")).forEach((t=>{e.split(",").forEach((n=>{"checkbox"==t.type||"radio"==t.type?t.value==n.trim()&&(t.checked=!0):"select"==t.type?t.querySelector('option[value="'+n+'"]').selected=!0:t.value=e})),"select-one"==t.type&&(t._niceselect=NiceSelect.bind(t,{searchable:!0})),t.addEventListener("keyup",(function(e){13===e.keyCode&&r(e)})),document.addEventListener("click",a),"checkbox"==t.type&&1!=n.length||("date"==t.type?t.addEventListener("blur",(function(e){""!=e.target.value&&r(e)})):t.addEventListener("change",(function(e){""!=e.target.value&&r(e)})),t.focus())}))}async function r(t,n){void 0===n&&(n=t.target);var a=n.closest("td"),o=FormFunctions.getFieldValue(n,a,!1),r=n.closest("table");if(o!=e){var l=new FormData;for(var s in l.append("value",o),a.dataset)l.append(s,a.dataset[s]);for(var s in n.closest("tr").dataset)l.append(s,n.closest("tr").dataset[s]);Main.showLoader(a.firstChild),response=await FormSubmit.fetchRestApi(r.dataset.url,l),response&&(a.innerHTML=o,editedel="")}else console.log(o),n.closest("td").innerHTML=e;a.classList.remove("editing")}function l(){document.querySelectorAll(".sim-table").forEach((function(e){var t=[];e.querySelectorAll("thead th").forEach(((e,n)=>{null!=e.dataset.nicename?t[n]=e.dataset.nicename:t[n]=e.textContent})),e.querySelectorAll("tbody tr").forEach((e=>{Array.from(e.children).forEach((function(e,n){e.setAttribute("label",t[n]),"X"!=e.textContent&&""!=e.textContent||e.classList.add("mobile-hidden")}))}))}))}function s(e){e.textContent="Close full screen",e.classList.replace("show","close");var t=e.closest(".table-wrapper");window.lastY=window.pageYOffset,window.scrollTo(0,0),document.querySelector("body").style.overflow="hidden",document.querySelector("header").style.zIndex="unset",t.classList.add("fullscreen"),t.style.marginLeft="0px";var n=new URL(window.location);n.searchParams.set("fullscreen",t.querySelector("table").dataset.formid),window.history.pushState({},"",n)}function c(){document.querySelectorAll(".table-wrapper").forEach((e=>{var t="",n=0,a=e.querySelector("table");if(null!=a){var o=a.scrollWidth;if(0!=o){if(window.innerWidth<570)t=e.getBoundingClientRect().x;else{var r=window.innerWidth-o;o/window.innerWidth<.7?null!=document.querySelector(".is-right-sidebar")&&(r=.7*window.innerWidth-o):(document.getElementById("primary").style.zIndex=1,document.querySelectorAll("#right-sidebar").forEach((e=>e.style.zIndex=0))),n=r<20?10:r/2,""!=e.style.marginLeft&&(e.style.marginLeft="-0px"),t=parseInt(e.getBoundingClientRect().x)-n}e.style.marginLeft=`-${t}px`}}}))}return t.r(n),t.d(n,{positionTable:()=>c,setTableLabel:()=>l}),document.addEventListener("click",(e=>{var t=e.target;"TH"==t.tagName&&function(e){var t,n,a,o=e.closest("table"),r=!0,l=!1;if(e.classList.contains("dsc"))var s="dsc";else s="asc";for(;r;){r=!1,a=o.rows;for(var c=1;c<a.length-1;c++){if(l=!1,t=a[c].getElementsByTagName("TD")[e.cellIndex].innerHTML.toLowerCase(),n=a[c+1].getElementsByTagName("TD")[e.cellIndex].innerHTML.toLowerCase(),isNaN(t)||isNaN(n)){var i=new Date(t),d=new Date(n);"Invalid Date"===i||isNaN(i)||70==i.getYear()||"Invalid Date"===d||isNaN(d)||70==d.getYear()||(t=i.getTime(),n=d.getTime())}else t=parseFloat(t),n=parseFloat(n);if("asc"==s&&t>n){l=!0;break}if("dsc"==s&&n>t){l=!0;break}}l&&(a[c].parentNode.insertBefore(a[c+1],a[c]),r=!0)}"asc"==s?(e.classList.remove("asc"),e.classList.add("dsc")):(e.classList.remove("dsc"),e.classList.add("asc"))}(t);var n=t.closest("td");t.matches("td.edit")?(e.stopPropagation(),o(t)):null!=n&&n.matches("td.edit")&&"INPUT"!=t.tagName&&"A"!=t.tagName&&"TEXTAREA"!=t.tagName&&!t.closest(".nice-select")?(e.stopPropagation(),o(t.closest("td"))):t.matches(".show.fullscreenbutton")?s(t):t.matches(".close.fullscreenbutton")&&function(e){var t=100;e.textContent="Show full screen",e.classList.replace("close","show"),null!=window.lastY&&(t=window.lastY),window.scrollTo(0,t),document.querySelector("body").style.overflow="unset",document.querySelector("header").style.zIndex="99999",e.closest(".table-wrapper").classList.remove("fullscreen"),c();var n=new URL(window.location);n.searchParams.delete("fullscreen"),window.history.pushState({},"",n)}(t)})),document.addEventListener("DOMContentLoaded",(function(){console.log("Table.js loaded"),c(),window.addEventListener("resize",c),l();var e=new URLSearchParams(window.location.search).get("fullscreen");if(null!=e)try{s(document.querySelector(`table[data-formid="${e}"]`).closest(".table-wrapper").querySelector(".fullscreenbutton"))}catch{console.error(`table[data-formid="${e}"]`)}})),n})()}));
//# sourceMappingURL=table.min.js.map