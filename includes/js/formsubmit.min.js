!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.FormSubmit=r():e.FormSubmit=r()}(self,(()=>(()=>{"use strict";var e={d:(r,o)=>{for(var t in o)e.o(o,t)&&!e.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:o[t]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};function o(e){e.reset(),e.querySelectorAll(".loadergif").forEach((e=>e.classList.add("hidden"))),e.querySelectorAll(".multistepcontrols .form_submit").forEach((e=>e.classList.add("hidden"))),e.querySelectorAll("[required]").forEach((e=>{e.required=!1})),e.querySelectorAll(".file_upload").forEach((e=>e.value="")),e.querySelectorAll(".upload_div.hidden").forEach((e=>e.classList.remove("hidden"))),e.querySelectorAll("select").forEach((e=>e._niceselect.update())),document.querySelectorAll(".documentpreview .document").forEach((e=>e.remove())),null!=e.querySelector(".formstep")&&(e.querySelectorAll(".multistepcontrols .step.finish").forEach((e=>e.classList.remove("finish"))),FormFunctions.showTab(0,e))}async function t(e,r){let o=e.closest("form"),t=!0;if(o.querySelectorAll(".hidden [required], select[required]").forEach((e=>{e.required=!1})),o.querySelectorAll("select[required]").forEach((e=>e.style.display="block")),o.querySelectorAll("[disabled][required]").forEach((e=>{e.disabled=!1,e.classList.add("was-disabled")})),t=o.reportValidity(),o.querySelectorAll("select[required]").forEach((e=>e.style.display="none")),t){e.closest(".submit_wrapper").querySelectorAll(".loadergif").forEach((e=>e.classList.remove("hidden"))),"undefined"!=typeof tinymce&&tinymce.get().forEach((e=>e.save()));let t=new FormData(o);o.querySelectorAll(".was-disabled").forEach((e=>{e.disabled=!0,e.classList.remove("was-disabled")})),"true"==o.dataset.addempty&&o.querySelectorAll('input[type="checkbox"]:not(:checked)').forEach((e=>{t.has(e.name)||t.append(e.name,"")}));let s=await l(r,t);return o.querySelectorAll(".submit_wrapper .loadergif").forEach((e=>e.classList.add("hidden"))),s}return!1}async function l(e,r,o=!0){let t;r.append("_wpnonce",sim.restNonce);try{t=await fetch(`${sim.baseUrl}/wp-json/sim/v2/${e}`,{method:"POST",credentials:"same-origin",body:r})}catch(e){console.error(e)}let l=await t.text();try{let e=JSON.parse(l);return t.ok?e:"rest_cookie_invalid_nonce"==e.code?(Main.displayMessage("Please refresh the page and try again!","error"),!1):(console.error(e),Main.displayMessage(e.message,"error"),!1)}catch(r){return console.error(r),console.error(t),t.ok?(o&&Main.displayMessage("Problem parsing the json, refresh the page or try again.","error"),console.error(`${sim.baseUrl}/wp-json${sim.restApiPrefix}/${e}`),console.error(l)):Main.displayMessage(`Url ${sim.baseUrl}/wp-json${sim.restApiPrefix}/${e} not found`,"error"),!1}}return e.r(r),e.d(r,{fetchRestApi:()=>l,formReset:()=>o,submitForm:()=>t}),console.log("formsubmit loaded"),r})()));
//# sourceMappingURL=FormSubmit.min.js.map